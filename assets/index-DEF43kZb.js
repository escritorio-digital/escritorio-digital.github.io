const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AttendanceWidget-BoabGPM7.js","assets/react-vendor-WCYW3yxo.js","assets/vendor-DCW5Txpp.js","assets/dnd-kit-ZKKYBs6g.js","assets/AttendanceWidget-BRBVD50_.css","assets/BoardLiveWidget-CHNkKUB_.js","assets/ExternalAppWidget-B4WJQI2e.js","assets/CalendarWidget-C4E0osU4.js","assets/ChatgptIaEduWidget-Bz_XLA_8.js","assets/LinkPortalWidget-BYp67LlY.js","assets/LinkPortalWidget-CanpM5sk.css","assets/DiceWidget-6WuF4_o0.js","assets/DiceWidget-DKhUyOlY.css","assets/DirectoEscalaWidget-c9vwXaKc.js","assets/DirectoIdeasWidget-BDiVFd6M.js","assets/DirectoMuroWidget-Cf1SHOhU.js","assets/DirectoNubeWidget-CbIVjo6V.js","assets/DirectoViewerWidget-BDbt-Xyt.js","assets/DirectoVotaWidget-BIVor0HM.js","assets/DrawingPadWidget-PfYK1Ufu.js","assets/EdiMarkWebWidget-mop-QbU8.js","assets/EdiMarkWebWidget-BxtMZy4w.css","assets/EduMediaIAGWidget-CMZj_ZNt.js","assets/EduMediaIAGWidget-55EvG_hs.css","assets/FileOpenerWidget-Btwe89Wq.js","assets/markdown-Cp29AwN3.js","assets/katex-2TduxwG8.js","assets/katex-CIur2ABi.css","assets/FileOpenerWidget-BbKTlflL.css","assets/GlobalClocksWidget-D-z2m3m2.js","assets/GlobalClocksWidget-Ca_QpoyH.css","assets/GroupGeneratorWidget-CCYhyiB-.js","assets/GroupGeneratorWidget-kkYbKX9i.css","assets/HtmlSandboxWidget-CvNG3wjG.js","assets/HtmlSandboxWidget-Cg7SWthN.css","assets/IframeWidget-DEWMOg2H.js","assets/IframeWidget-DB5Y2nTd.css","assets/ImageCarouselWidget-BNEsFaJk.js","assets/ImageCarouselWidget-NO2dK4ma.css","assets/LatexMarkdownWidget-BjnlHlpl.js","assets/LatexMarkdownWidget-1p3U7SuV.css","assets/LocalWebWidget-D25SAQVw.js","assets/LocalWebWidget-DBzpeu8b.css","assets/MemoryGameWidget-CBA2Cyfu.js","assets/MemoryGameWidget-jVyKEXp9.css","assets/MetronomeWidget-rFLxusz4.js","assets/MetronomeWidget-B6d6WkN_.css","assets/NotepadWidget-BWLWTSEe.js","assets/tiptap-DhPrbXr2.js","assets/NotepadWidget-DO-NzTz2.css","assets/ProgramGuideWidget-DSBvMPOG.js","assets/ProgramGuideWidget-BgYH5Siw.css","assets/QPlayWidget-BbJtSKG7.js","assets/QrCodeGeneratorWidget-RjiIdeCJ.js","assets/QrCodeGeneratorWidget-C9sVw1mn.css","assets/RandomSpinnerWidget-CaCI9GQ9.js","assets/RandomSpinnerWidget-BAOoHIXm.css","assets/ScientificCalculatorWidget-CcnKyeow.js","assets/ScientificCalculatorWidget-BbkYalVJ.css","assets/ScoreboardWidget-Bf4hI6By.js","assets/ScoreboardWidget-Cosun4xH.css","assets/SlidingPuzzleWidget--GNPZK9x.js","assets/SlidingPuzzleWidget-Bn7_1foX.css","assets/SoundMeterWidget-DMkTXuBR.js","assets/SoundMeterWidget-CZKF7qrT.css","assets/StopwatchWidget-B0t68SBY.js","assets/StopwatchWidget-HJzaRRM_.css","assets/TicTacToeWidget-CE-9lfdP.js","assets/TicTacToeWidget-9JQ82k6G.css","assets/TimerWidget-CQ_jonvk.js","assets/TrafficLightWidget-B6dfyLV5.js","assets/TrafficLightWidget-BUEVZBE_.css","assets/UnitConverterWidget-CH19Loiv.js","assets/UnitConverterWidget-Cyc2wYQh.css","assets/VceCommunityWidget-CPUBve7Q.js","assets/VceCommunityWidget-Ct8Sp28Q.css","assets/WikipediaSearchWidget-BRFsB3xU.js","assets/WikipediaSearchWidget-CcDY2TYh.css","assets/WorkGesturesWidget-Cc4ijlWC.js","assets/WorkGesturesWidget-5Yav63Mk.css","assets/WorkListWidget-CudApiXn.js"])))=>i.map(i=>d[i]);
import{j as e,u as T,B as Yt,r,R as bt,h as js,P as ft,i as pt,M as vs,k as ks,l as Cs,X as $e,L as Xt,A as Ns,m as Ss,C as Is,F as zs,T as Es,S as Ws,n as Ms,E as gt,o as Mt,p as xt,q as Os,s as Ds,t as Ts,G as Ls,H as Fs,v as Ps,w as $s,U as ct,x as As,y as Rs,z as Bs,D as Vs,I as Hs,J as Ks,K as Qt,N as qs,O as Gs,Q as Us,V as Ot,W as Ys,Y as Xs,Z as Qs,_ as nt,$ as Dt,a0 as Js,a1 as Zs,a2 as en}from"./react-vendor-WCYW3yxo.js";import{aa as F,ab as Tt,ac as tn,ad as sn,ae as Lt,af as nn,ag as on,ah as Ft,ai as it,aj as rn,ak as an}from"./vendor-DCW5Txpp.js";import{u as Jt,a as rt,D as Zt,c as es,S as ts,h as ln,b as ss,s as ns,K as is,P as os,d as rs,C as as,v as cn}from"./dnd-kit-ZKKYBs6g.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))c(x);new MutationObserver(x=>{for(const w of x)if(w.type==="childList")for(const l of w.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function i(x){const w={};return x.integrity&&(w.integrity=x.integrity),x.referrerPolicy&&(w.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?w.credentials="include":x.crossOrigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function c(x){if(x.ep)return;x.ep=!0;const w=i(x);fetch(x.href,w)}})();const Pt="/",$=t=>{if(!t)return Pt;const s=t.startsWith("/")?t.slice(1):t;return`${Pt}${s}`},dn={id:"attendance",title:"widgets.attendance.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/Attendance.png"),alt:s("widgets.attendance.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:450,height:600}},gn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:dn},Symbol.toStringTag,{value:"Module"})),un={id:"boardlive",title:"widgets.boardlive.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/BoardLive.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},mn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:un},Symbol.toStringTag,{value:"Module"})),hn={id:"calendar",title:"widgets.calendar.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/Calendar.png"),alt:s("widgets.calendar.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:320,height:350}},bn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:hn},Symbol.toStringTag,{value:"Module"})),fn={id:"comunidad-chatgpt-ia-edu",title:"widgets.chatgpt_ia_edu.title",searchKeywords:["widgets.chatgpt_ia_edu.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/ComunidadChatGPT-IA-edu.png"),alt:s("widgets.chatgpt_ia_edu.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:900,height:620}},pn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:fn},Symbol.toStringTag,{value:"Module"})),xn={id:"dice",title:"widgets.dice.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/Dice.png"),alt:s("widgets.dice.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:400,height:300}},wn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:xn},Symbol.toStringTag,{value:"Module"})),_n={id:"directo-escala",title:"widgets.directo_escala.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoEscala.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},yn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:_n},Symbol.toStringTag,{value:"Module"})),jn={id:"directo-ideas",title:"widgets.directo_ideas.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoIdeas.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},vn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:jn},Symbol.toStringTag,{value:"Module"})),kn={id:"directo-muro",title:"widgets.directo_muro.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoMuro.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},Cn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:kn},Symbol.toStringTag,{value:"Module"})),Nn={id:"directo-nube",title:"widgets.directo_nube.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoNube.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},Sn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Nn},Symbol.toStringTag,{value:"Module"})),In=()=>{const{t}=T();return e.jsx("img",{src:$("icons/Directo.png"),alt:t("widgets.directo_viewer.title"),width:52,height:52})},zn={id:"directo-viewer",title:"widgets.directo_viewer.title",icon:e.jsx(In,{}),defaultSize:{width:800,height:600}},En=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:zn},Symbol.toStringTag,{value:"Module"})),Wn={id:"directo-vota",title:"widgets.directo_vota.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/DirectoVota.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},Mn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Wn},Symbol.toStringTag,{value:"Module"})),On={id:"drawing-pad",title:"widgets.drawing_pad.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/paleta.png"),alt:s("widgets.drawing_pad.title"),className:"w-8 h-8"})};return e.jsx(t,{})})(),defaultSize:{width:600,height:450}},Dn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:On},Symbol.toStringTag,{value:"Module"})),Tn=()=>{const{t}=T();return e.jsx("img",{src:$("icons/EdiMarkWeb.png"),alt:t("widgets.edimarkweb.title"),width:52,height:52})},Ln={id:"edimarkweb",title:"widgets.edimarkweb.title",startTooltip:"widgets.edimarkweb.tooltip",icon:e.jsx(Tn,{}),defaultSize:{width:1100,height:720}},Fn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ln},Symbol.toStringTag,{value:"Module"})),Pn={id:"edumedia-iag",title:"widgets.edumedia_iag.title",searchKeywords:["widgets.edumedia_iag.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/EduMedia-IAG.png"),alt:s("widgets.edumedia_iag.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:940,height:640}},$n=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Pn},Symbol.toStringTag,{value:"Module"})),An={id:"file-opener",title:"widgets.file_opener.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/FileExplorer.png"),alt:s("widgets.file_opener.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:720,height:520}},Rn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:An},Symbol.toStringTag,{value:"Module"})),Bn={id:"global-clocks",title:"widgets.global_clocks.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/GlobalClocks.png"),alt:s("widgets.global_clocks.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:350,height:400}},Vn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Bn},Symbol.toStringTag,{value:"Module"})),Hn={id:"group-generator",title:"widgets.group_generator.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/GroupGenerator.png"),alt:s("widgets.group_generator.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:700,height:550}},Kn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Hn},Symbol.toStringTag,{value:"Module"})),qn=()=>{const{t}=T();return e.jsx("img",{src:$("icons/HtmlSandbox.png"),alt:t("widgets.html_sandbox.title"),width:52,height:52})},Gn={id:"html-sandbox",title:"widgets.html_sandbox.title",icon:e.jsx(qn,{}),defaultSize:{width:600,height:450}},Un=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Gn},Symbol.toStringTag,{value:"Module"})),Yn=()=>{const{t}=T();return e.jsx("img",{src:$("icons/Iframe.png"),alt:t("widgets.iframe.title"),width:52,height:52})},Xn={id:"iframe",title:"widgets.iframe.title",icon:e.jsx(Yn,{}),defaultSize:{width:600,height:500}},Qn=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Xn},Symbol.toStringTag,{value:"Module"})),Jn=()=>{const{t}=T();return e.jsx("img",{src:$("icons/ImageCarousel.png"),alt:t("widgets.image_carousel.title"),width:52,height:52})},Zn={id:"image-carousel",title:"widgets.image_carousel.title",icon:e.jsx(Jn,{}),defaultSize:{width:500,height:400}},ei=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Zn},Symbol.toStringTag,{value:"Module"})),ti={id:"latex-markdown",title:"widgets.latex_markdown.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/LatexMarkdown.png"),alt:s("widgets.latex_markdown.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:900,height:550}},si=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:ti},Symbol.toStringTag,{value:"Module"})),ni={id:"local-web",title:"widgets.local_web.title",searchKeywords:["widgets.local_web.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/LocalWeb.png"),alt:s("widgets.local_web.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},ii=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:ni},Symbol.toStringTag,{value:"Module"})),oi=()=>{const{t}=T();return e.jsx("img",{src:$("icons/MemoryGame.png"),alt:t("widgets.memory_game.icon_alt"),width:"52",height:"52"})},ri={id:"memory-game",title:"widgets.memory_game.title",icon:e.jsx(oi,{}),defaultSize:{width:500,height:550}},ai=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:ri},Symbol.toStringTag,{value:"Module"})),li={id:"metronome",title:"widgets.metronome.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/Metronome.png"),alt:s("widgets.metronome.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:300,height:400}},ci=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:li},Symbol.toStringTag,{value:"Module"})),di=()=>{const{t}=T();return e.jsx("img",{src:$("icons/Notepad.png"),alt:t("widgets.notepad.icon_alt"),width:"52",height:"52"})},gi={id:"notepad",title:"widgets.notepad.title",icon:e.jsx(di,{}),defaultSize:{width:500,height:450}},ui=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:gi},Symbol.toStringTag,{value:"Module"})),mi={id:"program-guide",title:"widgets.program_guide.title",icon:e.jsx(Yt,{size:44}),defaultSize:{width:800,height:600}},hi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:mi},Symbol.toStringTag,{value:"Module"})),bi={id:"qplay",title:"widgets.qplay.title",icon:(()=>{const t=()=>e.jsx("img",{src:$("icons/QPlay.png"),alt:"",width:52,height:52});return e.jsx(t,{})})(),defaultSize:{width:900,height:600}},fi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:bi},Symbol.toStringTag,{value:"Module"})),pi=()=>{const{t}=T();return e.jsx("img",{src:$("icons/QrCodeGenerator.png"),alt:t("widgets.qr_code_generator.icon_alt"),width:"52",height:"52"})},xi={id:"qr-code-generator",title:"widgets.qr_code_generator.title",icon:e.jsx(pi,{}),defaultSize:{width:350,height:500}},wi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:xi},Symbol.toStringTag,{value:"Module"})),_i=()=>{const{t}=T();return e.jsx("img",{src:$("icons/RandomSpinner.png"),alt:t("widgets.random_spinner.icon_alt"),width:"52",height:"52"})},yi={id:"random-spinner",title:"widgets.random_spinner.title",icon:e.jsx(_i,{}),defaultSize:{width:720,height:420}},ji=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:yi},Symbol.toStringTag,{value:"Module"})),vi={id:"scientific-calculator",title:"widgets.scientific_calculator.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/ScientificCalculator.png"),alt:s("widgets.scientific_calculator.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:400,height:600}},ki=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:vi},Symbol.toStringTag,{value:"Module"})),Ci=()=>{const{t}=T();return e.jsx("img",{src:$("icons/Scoreboard.png"),alt:t("widgets.scoreboard.icon_alt"),width:"52",height:"52"})},Ni={id:"scoreboard",title:"widgets.scoreboard.title",icon:e.jsx(Ci,{}),defaultSize:{width:400,height:450}},Si=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ni},Symbol.toStringTag,{value:"Module"})),Ii=()=>{const{t}=T();return e.jsx("img",{src:$("icons/SlidePuzzle.png"),alt:t("widgets.sliding_puzzle.icon_alt"),width:"52",height:"52"})},zi={id:"sliding-puzzle",title:"widgets.sliding_puzzle.title",icon:e.jsx(Ii,{}),defaultSize:{width:450,height:550}},Ei=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:zi},Symbol.toStringTag,{value:"Module"})),Wi={id:"sound-meter",title:"widgets.sound_meter.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/SoundMeter.png"),alt:s("widgets.sound_meter.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:300,height:300}},Mi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Wi},Symbol.toStringTag,{value:"Module"})),Oi=()=>{const{t}=T();return e.jsx("img",{src:$("icons/Stopwatch.png"),alt:t("widgets.stopwatch.title"),width:52,height:52})},Di={id:"stopwatch",title:"widgets.stopwatch.title",icon:e.jsx(Oi,{}),defaultSize:{width:320,height:450}},Ti=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Di},Symbol.toStringTag,{value:"Module"})),Li={id:"tic-tac-toe",title:"widgets.tic_tac_toe.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/TicTacToe.png"),alt:s("widgets.tic_tac_toe.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:380,height:520}},Fi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Li},Symbol.toStringTag,{value:"Module"})),Pi={id:"timer",title:"widgets.timer.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/Timer.png"),alt:s("widgets.timer.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:300,height:300}},$i=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Pi},Symbol.toStringTag,{value:"Module"})),Ai=()=>{const{t}=T();return e.jsx("img",{src:$("icons/TrafficLight.png"),alt:t("widgets.traffic_light.icon_alt"),width:"52",height:"52"})},Ri={id:"traffic-light",title:"widgets.traffic_light.title",icon:e.jsx(Ai,{}),defaultSize:{width:150,height:350}},Bi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ri},Symbol.toStringTag,{value:"Module"})),Vi=()=>{const{t}=T();return e.jsx("img",{src:$("icons/UnitConverter.png"),alt:t("widgets.unit_converter.icon_alt"),width:"52",height:"52"})},Hi={id:"unit-converter",title:"widgets.unit_converter.title",icon:e.jsx(Vi,{}),defaultSize:{width:450,height:200}},Ki=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Hi},Symbol.toStringTag,{value:"Module"})),qi={id:"vce-community",title:"widgets.vce.title",startTooltip:"widgets.vce.start_tooltip",searchKeywords:["widgets.vce.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/vibe_coding_educativo.png"),alt:s("widgets.vce.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:980,height:620}},Gi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:qi},Symbol.toStringTag,{value:"Module"})),Ui={id:"wikipedia-search",title:"widgets.wikipedia.title",searchKeywords:["widgets.wikipedia.search_keywords"],icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/Wikipedia.png"),alt:s("widgets.wikipedia.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:960,height:640}},Yi=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Ui},Symbol.toStringTag,{value:"Module"})),Xi=()=>{const{t}=T();return e.jsx("img",{src:$("icons/WorkGestures.png"),alt:t("widgets.work_gestures.icon_alt"),width:"52",height:"52"})},Qi={id:"work-gestures",title:"widgets.work_gestures.title",icon:e.jsx(Xi,{}),defaultSize:{width:450,height:450}},Ji=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Qi},Symbol.toStringTag,{value:"Module"})),Zi={id:"work-list",title:"widgets.work_list.title",icon:(()=>{const t=()=>{const{t:s}=T();return e.jsx("img",{src:$("icons/WorkList.png"),alt:s("widgets.work_list.title"),width:52,height:52})};return e.jsx(t,{})})(),defaultSize:{width:380,height:400}},eo=Object.freeze(Object.defineProperty({__proto__:null,widgetConfig:Zi},Symbol.toStringTag,{value:"Module"})),$t=Object.assign({"./Attendance/widgetConfig.tsx":gn,"./BoardLive/widgetConfig.tsx":mn,"./Calendar/widgetConfig.tsx":bn,"./ChatgptIaEdu/widgetConfig.tsx":pn,"./Dice/widgetConfig.tsx":wn,"./DirectoEscala/widgetConfig.tsx":yn,"./DirectoIdeas/widgetConfig.tsx":vn,"./DirectoMuro/widgetConfig.tsx":Cn,"./DirectoNube/widgetConfig.tsx":Sn,"./DirectoViewer/widgetConfig.tsx":En,"./DirectoVota/widgetConfig.tsx":Mn,"./DrawingPad/widgetConfig.tsx":Dn,"./EdiMarkWeb/widgetConfig.tsx":Fn,"./EduMediaIAG/widgetConfig.tsx":$n,"./FileOpener/widgetConfig.tsx":Rn,"./GlobalClocks/widgetConfig.tsx":Vn,"./GroupGenerator/widgetConfig.tsx":Kn,"./HtmlSandbox/widgetConfig.tsx":Un,"./Iframe/widgetConfig.tsx":Qn,"./ImageCarousel/widgetConfig.tsx":ei,"./LatexMarkdown/widgetConfig.tsx":si,"./LocalWeb/widgetConfig.tsx":ii,"./MemoryGame/widgetConfig.tsx":ai,"./Metronome/widgetConfig.tsx":ci,"./Notepad/widgetConfig.tsx":ui,"./ProgramGuide/widgetConfig.tsx":hi,"./QPlay/widgetConfig.tsx":fi,"./QrCodeGenerator/widgetConfig.tsx":wi,"./RandomSpinner/widgetConfig.tsx":ji,"./ScientificCalculator/widgetConfig.tsx":ki,"./Scoreboard/widgetConfig.tsx":Si,"./SlidingPuzzle/widgetConfig.tsx":Ei,"./SoundMeter/widgetConfig.tsx":Mi,"./Stopwatch/widgetConfig.tsx":Ti,"./TicTacToe/widgetConfig.tsx":Fi,"./Timer/widgetConfig.tsx":$i,"./TrafficLight/widgetConfig.tsx":Bi,"./UnitConverter/widgetConfig.tsx":Ki,"./VceCommunity/widgetConfig.tsx":Gi,"./WikipediaSearch/widgetConfig.tsx":Yi,"./WorkGestures/widgetConfig.tsx":Ji,"./WorkList/widgetConfig.tsx":eo}),At=Object.assign({"./Attendance/AttendanceWidget.tsx":()=>F(()=>import("./AttendanceWidget-BoabGPM7.js"),__vite__mapDeps([0,1,2,3,4])),"./BoardLive/BoardLiveWidget.tsx":()=>F(()=>import("./BoardLiveWidget-CHNkKUB_.js"),__vite__mapDeps([5,1,2,6,3])),"./Calendar/CalendarWidget.tsx":()=>F(()=>import("./CalendarWidget-C4E0osU4.js"),__vite__mapDeps([7,1,2,3])),"./ChatgptIaEdu/ChatgptIaEduWidget.tsx":()=>F(()=>import("./ChatgptIaEduWidget-Bz_XLA_8.js"),__vite__mapDeps([8,1,2,9,10,3])),"./Dice/DiceWidget.tsx":()=>F(()=>import("./DiceWidget-6WuF4_o0.js"),__vite__mapDeps([11,1,2,3,12])),"./DirectoEscala/DirectoEscalaWidget.tsx":()=>F(()=>import("./DirectoEscalaWidget-c9vwXaKc.js"),__vite__mapDeps([13,1,2,6,3])),"./DirectoIdeas/DirectoIdeasWidget.tsx":()=>F(()=>import("./DirectoIdeasWidget-BDiVFd6M.js"),__vite__mapDeps([14,1,2,6,3])),"./DirectoMuro/DirectoMuroWidget.tsx":()=>F(()=>import("./DirectoMuroWidget-Cf1SHOhU.js"),__vite__mapDeps([15,1,2,6,3])),"./DirectoNube/DirectoNubeWidget.tsx":()=>F(()=>import("./DirectoNubeWidget-CbIVjo6V.js"),__vite__mapDeps([16,1,2,6,3])),"./DirectoViewer/DirectoViewerWidget.tsx":()=>F(()=>import("./DirectoViewerWidget-BDbt-Xyt.js"),__vite__mapDeps([17,1,2,3])),"./DirectoVota/DirectoVotaWidget.tsx":()=>F(()=>import("./DirectoVotaWidget-BIVor0HM.js"),__vite__mapDeps([18,1,2,6,3])),"./DrawingPad/DrawingPadWidget.tsx":()=>F(()=>import("./DrawingPadWidget-PfYK1Ufu.js"),__vite__mapDeps([19,1,2,3])),"./EdiMarkWeb/EdiMarkWebWidget.tsx":()=>F(()=>import("./EdiMarkWebWidget-mop-QbU8.js"),__vite__mapDeps([20,1,2,3,21])),"./EduMediaIAG/EduMediaIAGWidget.tsx":()=>F(()=>import("./EduMediaIAGWidget-CMZj_ZNt.js"),__vite__mapDeps([22,1,2,3,23])),"./FileOpener/FileOpenerWidget.tsx":()=>F(()=>import("./FileOpenerWidget-Btwe89Wq.js"),__vite__mapDeps([24,1,2,25,26,27,3,28])),"./GlobalClocks/GlobalClocksWidget.tsx":()=>F(()=>import("./GlobalClocksWidget-D-z2m3m2.js"),__vite__mapDeps([29,1,2,3,30])),"./GroupGenerator/GroupGeneratorWidget.tsx":()=>F(()=>import("./GroupGeneratorWidget-CCYhyiB-.js"),__vite__mapDeps([31,1,2,3,32])),"./HtmlSandbox/HtmlSandboxWidget.tsx":()=>F(()=>import("./HtmlSandboxWidget-CvNG3wjG.js"),__vite__mapDeps([33,1,2,3,34])),"./Iframe/IframeWidget.tsx":()=>F(()=>import("./IframeWidget-DEWMOg2H.js"),__vite__mapDeps([35,1,2,3,36])),"./ImageCarousel/ImageCarouselWidget.tsx":()=>F(()=>import("./ImageCarouselWidget-BNEsFaJk.js"),__vite__mapDeps([37,1,2,3,38])),"./LatexMarkdown/LatexMarkdownWidget.tsx":()=>F(()=>import("./LatexMarkdownWidget-BjnlHlpl.js"),__vite__mapDeps([39,1,2,25,26,27,3,40])),"./LocalWeb/LocalWebWidget.tsx":()=>F(()=>import("./LocalWebWidget-D25SAQVw.js"),__vite__mapDeps([41,1,2,3,42])),"./MemoryGame/MemoryGameWidget.tsx":()=>F(()=>import("./MemoryGameWidget-CBA2Cyfu.js"),__vite__mapDeps([43,1,2,3,44])),"./Metronome/MetronomeWidget.tsx":()=>F(()=>import("./MetronomeWidget-rFLxusz4.js"),__vite__mapDeps([45,1,2,3,46])),"./Notepad/NotepadWidget.tsx":()=>F(()=>import("./NotepadWidget-BWLWTSEe.js"),__vite__mapDeps([47,1,2,48,25,3,49])),"./ProgramGuide/ProgramGuideWidget.tsx":()=>F(()=>import("./ProgramGuideWidget-DSBvMPOG.js"),__vite__mapDeps([50,1,2,25,3,51])),"./QPlay/QPlayWidget.tsx":()=>F(()=>import("./QPlayWidget-BbJtSKG7.js"),__vite__mapDeps([52,1,2,6,3])),"./QrCodeGenerator/QrCodeGeneratorWidget.tsx":()=>F(()=>import("./QrCodeGeneratorWidget-RjiIdeCJ.js"),__vite__mapDeps([53,1,2,3,54])),"./RandomSpinner/RandomSpinnerWidget.tsx":()=>F(()=>import("./RandomSpinnerWidget-CaCI9GQ9.js"),__vite__mapDeps([55,1,2,3,56])),"./ScientificCalculator/ScientificCalculatorWidget.tsx":()=>F(()=>import("./ScientificCalculatorWidget-CcnKyeow.js"),__vite__mapDeps([57,1,2,3,58])),"./Scoreboard/ScoreboardWidget.tsx":()=>F(()=>import("./ScoreboardWidget-Bf4hI6By.js"),__vite__mapDeps([59,1,2,3,60])),"./SlidingPuzzle/SlidingPuzzleWidget.tsx":()=>F(()=>import("./SlidingPuzzleWidget--GNPZK9x.js"),__vite__mapDeps([61,1,2,3,62])),"./SoundMeter/SoundMeterWidget.tsx":()=>F(()=>import("./SoundMeterWidget-DMkTXuBR.js"),__vite__mapDeps([63,1,2,3,64])),"./Stopwatch/StopwatchWidget.tsx":()=>F(()=>import("./StopwatchWidget-B0t68SBY.js"),__vite__mapDeps([65,1,2,3,66])),"./TicTacToe/TicTacToeWidget.tsx":()=>F(()=>import("./TicTacToeWidget-CE-9lfdP.js"),__vite__mapDeps([67,1,2,3,68])),"./Timer/TimerWidget.tsx":()=>F(()=>import("./TimerWidget-CQ_jonvk.js"),__vite__mapDeps([69,1,2,3])),"./TrafficLight/TrafficLightWidget.tsx":()=>F(()=>import("./TrafficLightWidget-B6dfyLV5.js"),__vite__mapDeps([70,1,2,3,71])),"./UnitConverter/UnitConverterWidget.tsx":()=>F(()=>import("./UnitConverterWidget-CH19Loiv.js"),__vite__mapDeps([72,1,2,3,73])),"./VceCommunity/VceCommunityWidget.tsx":()=>F(()=>import("./VceCommunityWidget-CPUBve7Q.js"),__vite__mapDeps([74,1,2,3,75])),"./WikipediaSearch/WikipediaSearchWidget.tsx":()=>F(()=>import("./WikipediaSearchWidget-BRFsB3xU.js"),__vite__mapDeps([76,1,2,3,77])),"./WorkGestures/WorkGesturesWidget.tsx":()=>F(()=>import("./WorkGesturesWidget-Cc4ijlWC.js"),__vite__mapDeps([78,1,2,3,79])),"./WorkList/WorkListWidget.tsx":()=>F(()=>import("./WorkListWidget-CudApiXn.js"),__vite__mapDeps([80,1,2,3])),"./shared/ExternalAppWidget.tsx":()=>F(()=>import("./ExternalAppWidget-B4WJQI2e.js"),__vite__mapDeps([6,1,2])),"./shared/LinkPortalWidget.tsx":()=>F(()=>import("./LinkPortalWidget-BYp67LlY.js"),__vite__mapDeps([9,1,2,10]))}),ls={};for(const t in $t){const s=$t[t];if(!s||!s.widgetConfig){console.warn(`[Widget Registry] El módulo en "${t}" no parece ser un widget válido porque le falta la exportación 'widgetConfig'.`);continue}const i=s.widgetConfig,c=t.slice(0,t.lastIndexOf("/")),x=Object.keys(At).find(u=>u.startsWith(`${c}/`)&&u.endsWith("Widget.tsx"));if(!x){console.warn(`[Widget Registry] No se encontró un componente para la carpeta "${c}".`);continue}const w=At[x],l=r.lazy(async()=>{const u=await w(),g=Object.keys(u).find(_=>_.endsWith("Widget")),E=g?u[g]:u.default;if(!E)throw new Error(`[Widget Registry] El módulo "${x}" no exporta un componente válido.`);return{default:E}});ls[i.id]={...i,component:l}}const Se=ls;function et(t,s){const[i,c]=r.useState(()=>{try{const w=window.localStorage.getItem(t);return w?JSON.parse(w):s}catch(w){return console.error(w),s}});return[i,w=>{try{const l=w instanceof Function?w(i):w;c(l),window.localStorage.setItem(t,JSON.stringify(l))}catch(l){console.error(l)}}]}const to=({title:t,icon:s,children:i,position:c,size:x,zIndex:w,onDragStop:l,onResizeStop:u,onClose:g,onFocus:E,isMinimized:_,isMaximized:h,onToggleMinimize:o,onToggleMaximize:I,onOpenContextMenu:a,isPinned:N,onTogglePin:P,pinLabel:O,unpinLabel:K,isActive:Y})=>{const[ce,X]=bt.useState(!1),de=_?{...x,height:40}:x,Q={zIndex:w,opacity:_?0:!_&&!Y?.97:1,pointerEvents:_?"none":"auto",transform:_?"scale(0.98)":"scale(1)",transition:_?"width 220ms ease, height 220ms ease, opacity 220ms ease, transform 220ms ease":"opacity 120ms ease"},M=typeof s=="string"?e.jsx("img",{src:s,alt:"","aria-hidden":"true"}):s;return e.jsxs(js,{size:de,position:c,onDragStop:l,onResizeStop:u,minWidth:200,minHeight:_?40:150,disableDragging:h,enableResizing:!h&&!_,style:Q,onMouseDown:E,onMouseDownCapture:E,onDragStart:()=>E(),className:`widget-window bg-widget-bg rounded-lg border-2 border-widget-header relative ${Y?"ring-2 ring-accent/70 shadow-2xl":"shadow-xl"}`,dragHandleClassName:"widget-header-drag-handle",bounds:"parent",children:[e.jsxs("div",{className:"widget-header flex items-center justify-between h-10 bg-widget-header text-text-light font-bold px-3 absolute top-0 left-0 right-0",onContextMenu:a,onDoubleClick:ie=>{ie.stopPropagation(),I()},onMouseEnter:()=>X(!0),onMouseLeave:()=>X(!1),children:[e.jsxs("span",{className:"widget-header-drag-handle flex-grow h-full cursor-move flex items-center gap-2",children:[M&&e.jsx("span",{className:"widget-header-icon",children:M}),e.jsx("span",{children:t})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[P&&ce&&e.jsx("button",{onClick:P,onContextMenu:a,className:"hover:bg-black/20 rounded-full p-1",title:N?K:O,"aria-label":N?K:O,children:N?e.jsx(ft,{size:18}):e.jsx(pt,{size:18})}),e.jsx("button",{onClick:o,onContextMenu:a,className:"hover:bg-black/20 rounded-full p-1",children:e.jsx(vs,{size:18})}),e.jsx("button",{onClick:I,onContextMenu:a,className:"hover:bg-black/20 rounded-full p-1",children:h?e.jsx(ks,{size:18}):e.jsx(Cs,{size:18})}),e.jsx("button",{onClick:g,onContextMenu:a,className:"hover:bg-black/20 rounded-full p-1",children:e.jsx($e,{size:18})})]})]}),!_&&e.jsx("div",{className:"absolute top-10 left-0 right-0 bottom-0 min-h-0 overflow-auto",children:i})]})},so=({pinnedWidgets:t,onWidgetClick:s,onWidgetsClick:i,onOpenContextMenu:c,onReorderPinned:x,openWidgets:w,onTaskClick:l,onTaskContextMenu:u,isHidden:g=!1,isPeeking:E=!1,onMouseLeave:_,startButtonRef:h})=>{const{t:o}=T(),I=r.useRef(null),[a,N]=r.useState(null),[P,O]=r.useState(null),K=j=>j?.startTooltip?o(j.startTooltip):o(j.title),Y=w.reduce((j,S)=>Math.max(j,S.zIndex),0),ce=Jt(rt(os,{activationConstraint:{distance:8}}),rt(is,{coordinateGetter:ns})),X=t.filter(j=>Se[j]),de=w.map(j=>{const S=Se[j.widgetId];if(!S)return null;const W=K(S);return{...j,title:o(S.title),icon:S.icon,label:W}}).filter(j=>!!j).sort((j,S)=>j.title.localeCompare(S.title)),Q=j=>{const{active:S,over:W}=j;if(!W||S.id===W.id)return;const B=X.indexOf(String(S.id)),U=X.indexOf(String(W.id));if(B===-1||U===-1)return;const J=ss(X,B,U),Z=t.filter(ee=>!Se[ee]);x([...J,...Z])},M=({widgetId:j})=>{const S=Se[j],{attributes:W,listeners:B,setNodeRef:U,transform:J,transition:Z,isDragging:ee}=rs({id:j});if(!S)return null;const oe={transform:ee?as.Transform.toString(J):void 0,transition:ee?Z:void 0},Ie=K(S);return e.jsx("div",{ref:U,style:oe,className:"flex-shrink-0",children:e.jsx("button",{onClick:()=>s(j),onContextMenu:Ce=>{Ce.stopPropagation(),c(Ce,j)},"data-widget-button":"true",className:"group w-14 h-14 bg-accent text-2xl rounded-lg flex items-center justify-center hover:brightness-110 hover:scale-105",title:Ie,...W,...B,children:e.jsx("span",{className:"transform-gpu group-hover:scale-110",children:S.icon})})})},ie=j=>{const S=j.target;S?.closest('[data-widget-button="true"]')||S?.closest('[data-task-button="true"]')||c(j,void 0,!0)};r.useLayoutEffect(()=>{const j=()=>{const S=I.current,W=h?.current;if(!S||!W){N(null),O(null);return}const B=8,U=S.getBoundingClientRect(),J=W.getBoundingClientRect(),Z=window.innerWidth/2-U.width/2,ee=J.right+B;if(Z<ee){const oe=Math.max(240,window.innerWidth-ee-B);N(ee),O(oe)}else N(null),O(null)};return j(),window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[t,w,g,E,h]);const k=g&&!E?"0.75rem":"0rem";return e.jsxs("div",{ref:I,className:`fixed bottom-5 left-1/2 bg-widget-bg p-2 rounded-2xl flex items-center gap-3 shadow-lg z-[10000] border border-custom-border max-w-[calc(100vw-1rem)] transition-all duration-200 max-[700px]:hidden ${g&&!E?"opacity-0 pointer-events-none":"opacity-100"}`,style:{transform:`${a===null?"translate(-50%, ":"translate(0, "}${k})`,left:a===null?void 0:`${a}px`,maxWidth:P===null?void 0:`${P}px`},"data-toolbar":"true",onContextMenu:ie,onMouseLeave:_,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zt,{sensors:ce,collisionDetection:es,onDragEnd:Q,children:e.jsx(ts,{items:X,strategy:ln,children:e.jsx("div",{className:"flex items-center gap-2",children:X.map(j=>e.jsx(M,{widgetId:j},j))})})}),e.jsx("button",{onClick:i,onContextMenu:j=>c(j,void 0,!0),className:"w-10 h-10 rounded-full text-text-light bg-black/20 hover:bg-black/30 transition-all duration-200 flex items-center justify-center flex-shrink-0",title:o("toolbar.widgetLibrary"),"aria-label":o("toolbar.widgetLibrary"),children:e.jsx(Xt,{size:18})})]}),de.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-10 w-px bg-white/30"}),e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pr-1 min-w-0 flex-1",children:de.map(j=>e.jsx("button",{type:"button",onClick:()=>l(j.instanceId),onContextMenu:S=>{S.stopPropagation(),u(S,j.instanceId)},"data-task-button":"true",className:`min-w-[120px] max-w-[180px] truncate px-3 py-2 rounded-lg border text-xs font-semibold transition ${j.isMinimized?"bg-white/60 border-gray-200 text-gray-500":j.zIndex===Y?"bg-amber-100 border-amber-300 text-amber-800":"bg-white/90 border-gray-200 text-text-dark hover:bg-amber-50"}`,title:j.label,"aria-label":j.label,children:e.jsxs("span",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"text-sm leading-none",children:j.icon}),e.jsx("span",{className:"truncate",children:j.title})]})},j.instanceId))})]})]})},Rt=[{id:"organization",titleKey:"settings.widgets.categories.organization",widgetIds:["work-list","attendance","group-generator","calendar","program-guide"]},{id:"time",titleKey:"settings.widgets.categories.time",widgetIds:["timer","stopwatch","metronome","global-clocks"]},{id:"math_science",titleKey:"settings.widgets.categories.math_science",widgetIds:["scientific-calculator","unit-converter","latex-markdown"]},{id:"community",titleKey:"settings.widgets.categories.community",widgetIds:["vce-community","comunidad-chatgpt-ia-edu","edumedia-iag"]},{id:"board_writing",titleKey:"settings.widgets.categories.board_writing",widgetIds:["notepad","drawing-pad","image-carousel","edimarkweb","html-sandbox","boardlive"]},{id:"resources",titleKey:"settings.widgets.categories.resources",widgetIds:["iframe","local-web","pdf-viewer","file-opener","directo-viewer","wikipedia-search"]},{id:"interaction",titleKey:"settings.widgets.categories.interaction",widgetIds:["dice","random-spinner","qr-code-generator","traffic-light","sound-meter","scoreboard"]},{id:"participation",titleKey:"settings.widgets.categories.participation",widgetIds:["directo-vota","directo-escala","directo-nube","directo-ideas","directo-muro","qplay","boardlive"]},{id:"logic_games",titleKey:"settings.widgets.categories.logic_games",widgetIds:["tic-tac-toe","memory-game","sliding-puzzle"]},{id:"gestures",titleKey:"settings.widgets.categories.gestures",widgetIds:["work-gestures"]}],cs=(t,s)=>{const i=new Map(t.map(l=>[l.id,l])),c=Rt.map(l=>({...l,widgets:l.widgetIds.map(u=>i.get(u)).filter(u=>!!u).sort((u,g)=>s(u.title).localeCompare(s(g.title)))})),x=new Set(Rt.flatMap(l=>l.widgetIds)),w=t.filter(l=>!x.has(l.id)).sort((l,u)=>s(l.title).localeCompare(s(u.title)));return w.length>0&&c.push({id:"other",titleKey:"settings.widgets.categories.other",widgetIds:w.map(l=>l.id),widgets:w}),c},no="/assets/fondo01-1920-DQ9YqYXb.webp",io="/assets/fondo01-2560-BhYwScvF.webp",oo="/assets/fondo02-1920-CkNjKDZL.webp",ro="/assets/fondo02-2560-BHdQH5Tz.webp",ao="/assets/fondo03-1920-6uaXYCMy.webp",lo="/assets/fondo03-2560-D54ZlzdJ.webp",co="/assets/fondo04-1920-lLv979Fv.webp",go="/assets/fondo04-2560-CLLBOnYy.webp",uo="/assets/fondo05-1920-CHlhzsPi.webp",mo="/assets/fondo05-2560-hgpnzGY3.webp",ho="/assets/fondo06-1920-CQZ3V-je.webp",bo="/assets/fondo06-2560-bB_z6UE8.webp",fo="/assets/fondo07-1920-C8UIaOrN.webp",po="/assets/fondo07-2560-BYU5aKLI.webp",xo="/assets/fondo08-1920-AdGMGon5.webp",wo="/assets/fondo08-2560-CqfJPhF-.webp",_o="/assets/fondo09-1920-B06QmLnf.webp",yo="/assets/fondo09-2560-RakF4Xnz.webp",jo="/assets/fondo10-1920-Pkarw0Pa.webp",vo="/assets/fondo10-2560-CYpZFt1-.webp",ko="/assets/fondo11-1920-DMUk-tk5.webp",Co="/assets/fondo11-2560-BPq20Wq-.webp",No="/assets/fondo12-1920-D-tqmJlT.webp",So="/assets/fondo12-2560-CB3zOAPz.webp",Io="/assets/fondo13-1920-DOpAlvqG.webp",zo="/assets/fondo13-2560-CmSJaBRt.webp",Eo="/assets/fondo14-1920-CJl22m7O.webp",Wo="/assets/fondo14-2560-D4bfWxAE.webp",Mo="/assets/fondo15-1920-BKFORNdS.webp",Oo="/assets/fondo15-2560-BO3wyQno.webp",Do="/assets/fondo16-1920-DtfASKuP.webp",To="/assets/fondo16-2560-D2epzX5q.webp",Lo="/assets/gemini-16uf0k16uf0k16uf-1920-Bkw3X8It.webp",Fo="/assets/gemini-16uf0k16uf0k16uf-2560-BfXj68w3.webp",Po="/assets/gemini-2ap5fj2ap5fj2ap5-1920-a44PJlMO.webp",$o="/assets/gemini-2ap5fj2ap5fj2ap5-2560-6XLIb1DZ.webp",Ao="/assets/gemini-9lvikq9lvikq9lvi-1920-DedAlMh6.webp",Ro="/assets/gemini-9lvikq9lvikq9lvi-2560-Cl62r3ny.webp",Bo="/assets/gemini-louvkrlouvkrlouv-1920-DBK9_T9Y.webp",Vo="/assets/gemini-louvkrlouvkrlouv-2560-CKhcAHXA.webp",Ho="/assets/gemini-xiejfxiejfxiejfx-1920-CJodUFDt.webp",Ko="/assets/gemini-xiejfxiejfxiejfx-2560-rYumsXvf.webp",qo="/assets/gemini-yntaleyntaleynta-1920-BGyMXLie.webp",Go="/assets/gemini-yntaleyntaleynta-2560-KPkUYpwP.webp",Uo=Object.assign({"../assets/backgrounds/fondo01-1920.webp":no,"../assets/backgrounds/fondo01-2560.webp":io,"../assets/backgrounds/fondo02-1920.webp":oo,"../assets/backgrounds/fondo02-2560.webp":ro,"../assets/backgrounds/fondo03-1920.webp":ao,"../assets/backgrounds/fondo03-2560.webp":lo,"../assets/backgrounds/fondo04-1920.webp":co,"../assets/backgrounds/fondo04-2560.webp":go,"../assets/backgrounds/fondo05-1920.webp":uo,"../assets/backgrounds/fondo05-2560.webp":mo,"../assets/backgrounds/fondo06-1920.webp":ho,"../assets/backgrounds/fondo06-2560.webp":bo,"../assets/backgrounds/fondo07-1920.webp":fo,"../assets/backgrounds/fondo07-2560.webp":po,"../assets/backgrounds/fondo08-1920.webp":xo,"../assets/backgrounds/fondo08-2560.webp":wo,"../assets/backgrounds/fondo09-1920.webp":_o,"../assets/backgrounds/fondo09-2560.webp":yo,"../assets/backgrounds/fondo10-1920.webp":jo,"../assets/backgrounds/fondo10-2560.webp":vo,"../assets/backgrounds/fondo11-1920.webp":ko,"../assets/backgrounds/fondo11-2560.webp":Co,"../assets/backgrounds/fondo12-1920.webp":No,"../assets/backgrounds/fondo12-2560.webp":So,"../assets/backgrounds/fondo13-1920.webp":Io,"../assets/backgrounds/fondo13-2560.webp":zo,"../assets/backgrounds/fondo14-1920.webp":Eo,"../assets/backgrounds/fondo14-2560.webp":Wo,"../assets/backgrounds/fondo15-1920.webp":Mo,"../assets/backgrounds/fondo15-2560.webp":Oo,"../assets/backgrounds/fondo16-1920.webp":Do,"../assets/backgrounds/fondo16-2560.webp":To,"../assets/backgrounds/gemini-16uf0k16uf0k16uf-1920.webp":Lo,"../assets/backgrounds/gemini-16uf0k16uf0k16uf-2560.webp":Fo,"../assets/backgrounds/gemini-2ap5fj2ap5fj2ap5-1920.webp":Po,"../assets/backgrounds/gemini-2ap5fj2ap5fj2ap5-2560.webp":$o,"../assets/backgrounds/gemini-9lvikq9lvikq9lvi-1920.webp":Ao,"../assets/backgrounds/gemini-9lvikq9lvikq9lvi-2560.webp":Ro,"../assets/backgrounds/gemini-louvkrlouvkrlouv-1920.webp":Bo,"../assets/backgrounds/gemini-louvkrlouvkrlouv-2560.webp":Vo,"../assets/backgrounds/gemini-xiejfxiejfxiejfx-1920.webp":Ho,"../assets/backgrounds/gemini-xiejfxiejfxiejfx-2560.webp":Ko,"../assets/backgrounds/gemini-yntaleyntaleynta-1920.webp":qo,"../assets/backgrounds/gemini-yntaleyntaleynta-2560.webp":Go}),ot={},Yo=/\/([^/]+?)(?:-(\d+))?\.webp$/;Object.entries(Uo).forEach(([t,s])=>{const i=t.match(Yo);if(!i)return;const c=i[1],x=i[2]?Number(i[2]):0;ot[c]||(ot[c]={}),ot[c][x]=s});const Xo=["gemini-9lvikq9lvikq9lvi","gemini-16uf0k16uf0k16uf","gemini-louvkrlouvkrlouv","gemini-xiejfxiejfxiejfx","gemini-2ap5fj2ap5fj2ap5","gemini-yntaleyntaleynta"],Bt=new Map(Xo.map((t,s)=>[t,s])),at=Object.entries(ot).map(([t,s])=>{const i=Object.keys(s).map(Number).sort((x,w)=>x-w),c=i[0];return{id:t,sizes:i,urlsBySize:s,previewUrl:s[c],urls:i.map(x=>s[x])}}).sort((t,s)=>{const i=Bt.get(t.id),c=Bt.get(s.id);return i!=null&&c!=null?i-c:i!=null?-1:c!=null?1:t.id.localeCompare(s.id)}),Qo=()=>typeof window>"u"?1920:Math.floor(window.innerWidth*(window.devicePixelRatio||1)),Jo=t=>{const s=Qo(),c=t.sizes.find(x=>x>=s)??t.sizes[t.sizes.length-1];return t.urlsBySize[c]},ds=t=>`url(${Jo(t)})`,Zo=new Set(at.flatMap(t=>t.urls.map(s=>`url(${s})`))),er=t=>Zo.has(t),tr="gemini-9lvikq9lvikq9lvi",Vt=at.find(t=>t.id===tr)??at[0],gs=Vt?ds(Vt):"none",Ze={"--color-bg":"#FFFFFF","--color-widget-bg":"#00809D","--color-widget-header":"#D3AF37","--color-accent":"#FFD700","--color-text-light":"#FCF8DD","--color-text-dark":"#1a202c","--color-border":"#FFFFFF","--wallpaper":gs,"--font-scale":"1",showDateTime:!0,showSystemStats:!1,highContrast:!1},us=r.createContext(void 0),sr=({children:t,value:s})=>e.jsx(us.Provider,{value:s,children:t}),_t=()=>{const t=r.useContext(us);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},nr=()=>{const{t}=T(),{theme:s,setTheme:i,defaultTheme:c}=_t(),x=h=>{const{name:o,value:I}=h.target;i({...s,[o]:I})},w=h=>{const{checked:o}=h.target;i(I=>({...I,highContrast:o}))},l=h=>{const{value:o}=h.target;i(I=>({...I,"--font-scale":o}))},u=[{id:"classic",labelKey:"settings.theme.presets.classic",colors:{"--color-bg":c["--color-bg"],"--color-widget-bg":c["--color-widget-bg"],"--color-widget-header":c["--color-widget-header"],"--color-accent":c["--color-accent"],"--color-text-light":c["--color-text-light"],"--color-text-dark":c["--color-text-dark"],"--color-border":c["--color-border"]}},{id:"chalkboard",labelKey:"settings.theme.presets.chalkboard",colors:{"--color-bg":"#122B39","--color-widget-bg":"#1F4E5F","--color-widget-header":"#F4B860","--color-accent":"#F7D07A","--color-text-light":"#F7F4EA","--color-text-dark":"#0B1B21","--color-border":"#122B39"}},{id:"slate",labelKey:"settings.theme.presets.slate",colors:{"--color-bg":"#232136","--color-widget-bg":"#3A355A","--color-widget-header":"#9E7FB2","--color-accent":"#F6C177","--color-text-light":"#F5F2FF","--color-text-dark":"#14111F","--color-border":"#232136"}},{id:"sand",labelKey:"settings.theme.presets.sand",colors:{"--color-bg":"#FFF3D9","--color-widget-bg":"#FF7A5C","--color-widget-header":"#2B7A78","--color-accent":"#F5D547","--color-text-light":"#FFF8EA","--color-text-dark":"#2B1D0E","--color-border":"#F3E2BF"}},{id:"ocean",labelKey:"settings.theme.presets.ocean",colors:{"--color-bg":"#E9F4FF","--color-widget-bg":"#2F80ED","--color-widget-header":"#1B3A57","--color-accent":"#FFB703","--color-text-light":"#F8F9FB","--color-text-dark":"#0E1A24","--color-border":"#D7E8FF"}},{id:"confetti",labelKey:"settings.theme.presets.confetti",colors:{"--color-bg":"#FFF6F9","--color-widget-bg":"#FF6B6B","--color-widget-header":"#6BCB77","--color-accent":"#4D96FF","--color-text-light":"#FFFFFF","--color-text-dark":"#2B2D42","--color-border":"#FDE3EC"}},{id:"sunrise",labelKey:"settings.theme.presets.sunrise",colors:{"--color-bg":"#FFE8D6","--color-widget-bg":"#FF7F50","--color-widget-header":"#6C5B7B","--color-accent":"#F9C74F","--color-text-light":"#FFF7EA","--color-text-dark":"#2D1E1E","--color-border":"#F6D3C1"}},{id:"berry",labelKey:"settings.theme.presets.berry",colors:{"--color-bg":"#F6ECFF","--color-widget-bg":"#7B2CBF","--color-widget-header":"#FAD643","--color-accent":"#FF70A6","--color-text-light":"#FDF7FF","--color-text-dark":"#221133","--color-border":"#EAD9FF"}},{id:"mint",labelKey:"settings.theme.presets.mint",colors:{"--color-bg":"#E8FFF7","--color-widget-bg":"#2A9D8F","--color-widget-header":"#264653","--color-accent":"#E9C46A","--color-text-light":"#F7FFFB","--color-text-dark":"#0E1F20","--color-border":"#D2F3E7"}}],g=h=>{i(o=>({...o,...h.colors}))},E=h=>Object.entries(h.colors).every(([o,I])=>s[o]===I),_=[{id:"--color-bg",labelKey:"desktop_bg"},{id:"--color-widget-bg",labelKey:"widget_bg"},{id:"--color-widget-header",labelKey:"widget_header"},{id:"--color-accent",labelKey:"accent"},{id:"--color-text-light",labelKey:"text_light"},{id:"--color-text-dark",labelKey:"text_dark"}];return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t("settings.theme.accessibility_title")}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:t("settings.theme.accessibility_help")}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("label",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:t("settings.theme.high_contrast")}),e.jsx("input",{type:"checkbox",checked:!!s.highContrast,onChange:w,className:"h-4 w-4 rounded border-gray-300 accent-accent"})]}),e.jsxs("label",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:t("settings.theme.font_scale")}),e.jsxs("select",{value:s["--font-scale"],onChange:l,className:"p-2 border rounded-lg bg-white/80 focus:ring-2 focus:ring-accent focus:outline-none",children:[e.jsx("option",{value:"0.9",children:t("settings.theme.font_scale_90")}),e.jsx("option",{value:"1",children:t("settings.theme.font_scale_100")}),e.jsx("option",{value:"1.1",children:t("settings.theme.font_scale_110")}),e.jsx("option",{value:"1.25",children:t("settings.theme.font_scale_125")}),e.jsx("option",{value:"1.5",children:t("settings.theme.font_scale_150")})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t("settings.theme.presets_title")}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:t("settings.theme.presets_help")}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:u.map(h=>{const o=E(h);return e.jsxs("button",{type:"button",onClick:()=>g(h),className:`text-left p-3 rounded-lg border transition-all ${o?"border-accent ring-2 ring-accent":"border-gray-200 hover:border-gray-400"}`,"aria-pressed":o,children:[e.jsxs("div",{className:"h-14 rounded-md overflow-hidden border border-black/10 mb-2",style:{backgroundColor:h.colors["--color-bg"]},children:[e.jsx("div",{style:{backgroundColor:h.colors["--color-widget-header"]},className:"h-4"}),e.jsxs("div",{className:"flex h-10",children:[e.jsx("div",{style:{backgroundColor:h.colors["--color-widget-bg"]},className:"flex-1"}),e.jsx("div",{style:{backgroundColor:h.colors["--color-accent"]},className:"w-6"})]})]}),e.jsx("span",{className:"text-sm font-semibold",children:t(h.labelKey)})]},h.id)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:t("settings.theme.theme_colors_title")}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:_.map(({id:h,labelKey:o})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:h,className:"text-sm",children:t(`settings.theme.colors.${o}`)}),e.jsx("input",{type:"color",id:h,name:h,value:s[h],onChange:x,className:"theme-color-input"})]},h))})]})]})},ir=({isOpen:t,onClose:s})=>{const{t:i}=T();return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[10002] flex items-center justify-center",onClick:c=>{c.stopPropagation(),s()},children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-xl text-text-dark rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:i("settings.theme.modal_title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-black/10",children:e.jsx($e,{size:20})})]}),e.jsx("div",{className:"overflow-y-auto",children:e.jsx(nr,{})})]})}):null},or="escritorio-digital",lt="kv",rr=1;let ut=null;const ar=()=>(ut||(ut=new Promise((t,s)=>{const i=window.indexedDB.open(or,rr);i.onupgradeneeded=()=>{const c=i.result;c.objectStoreNames.contains(lt)||c.createObjectStore(lt)},i.onsuccess=()=>t(i.result),i.onerror=()=>s(i.error)})),ut),yt=async(t,s)=>{const i=await ar();return new Promise((c,x)=>{const l=i.transaction(lt,t).objectStore(lt),u=s(l);u.onsuccess=()=>c(u.result),u.onerror=()=>x(u.error)})},ms=async t=>await yt("readonly",i=>i.get(t))??null,Ht=async(t,s)=>{await yt("readwrite",i=>i.put(s,t))},hs=async t=>{await yt("readwrite",s=>s.delete(t))},wt="__indexed_db__",lr=2e5,cr=1,tt=["work-list-tasks","spinner-options","notepad-content-html","image-carousel-images","tictactoe-players","tictactoe-score","global-clocks-selection","attendance-records","traffic-light-state","scoreboard-players","toolbar-hidden","i18nextLng","profile-order","widgets-view-mode"],dr="escritorio-digital-sites",gr=1,fe="sites",pe="files";let mt=null;const Ge=()=>(mt||(mt=new Promise((t,s)=>{const i=window.indexedDB.open(dr,gr);i.onupgradeneeded=()=>{const c=i.result;c.objectStoreNames.contains(fe)||c.createObjectStore(fe,{keyPath:"id"}),c.objectStoreNames.contains(pe)||c.createObjectStore(pe,{keyPath:"key"}).createIndex("siteId","siteId",{unique:!1})},i.onsuccess=()=>t(i.result),i.onerror=()=>s(i.error)})),mt),ur=t=>{const s=atob(t),i=new Uint8Array(s.length);for(let c=0;c<s.length;c+=1)i[c]=s.charCodeAt(c);return i.buffer},mr=async t=>{const s={};for(const i of t){const c=window.localStorage.getItem(i);if(c)if(c===wt){const x=await ms(i);if(x==null)continue;s[i]={storage:"indexedDb",value:x}}else s[i]={storage:"localStorage",value:c}}return s},hr=async t=>{for(const[s,i]of Object.entries(t)){if(i.storage==="indexedDb"){await Ht(s,i.value),window.localStorage.setItem(s,wt);continue}if(i.value.length>lr){await Ht(s,i.value),window.localStorage.setItem(s,wt);continue}window.localStorage.setItem(s,i.value),await hs(s)}},br=async(t,s)=>{const i=await Ge();return new Promise((c,x)=>{const w=i.transaction([fe,pe],"readonly"),l=w.objectStore(fe).getAll(),u=w.objectStore(pe).getAll();w.oncomplete=()=>{const g=l.result??[],E=u.result??[],h=(t&&t.length>0?g.filter(a=>!a.profileName||t.includes(a.profileName)):g).map(a=>({...a,profileName:a.profileName??s})),o=new Set(h.map(a=>a.id)),I=E.filter(a=>o.has(a.siteId)).map(a=>({...a,profileName:a.profileName??s}));c({sites:h,files:I})},w.onerror=()=>x(w.error)})},ht=async(t,s)=>{const i=await Ge();return new Promise((c,x)=>{const w=i.transaction([fe,pe],"readonly"),l=w.objectStore(fe).getAll(),u=w.objectStore(pe).getAll();w.oncomplete=()=>{const g=l.result??[],E=u.result??[],_=t&&t.length>0?g.filter(a=>!a.profileName||t.includes(a.profileName)):g,h=new Set(_.map(a=>a.id)),o=_.reduce((a,N)=>a+(N.totalBytes||0),0),I=E.filter(a=>h.has(a.siteId)).reduce((a,N)=>a+(N.size||0),0);c({siteCount:_.length,totalBytes:I>0?I:o})},w.onerror=()=>x(w.error)})},bs=async()=>{const t=await Ge();await new Promise((s,i)=>{const c=t.transaction([fe,pe],"readwrite");c.objectStore(fe).clear(),c.objectStore(pe).clear(),c.oncomplete=()=>s(),c.onerror=()=>i(c.error)})},fr=async(t,s)=>{const i=await Ge();await new Promise((c,x)=>{const w=i.transaction([fe,pe],"readwrite"),l=w.objectStore(fe),u=w.objectStore(pe);t.sites.forEach(g=>{const _=(g.profileName&&s?.profileNameMap?.get(g.profileName))??g.profileName??s?.fallbackProfileName;l.put({...g,profileName:_})}),t.files.forEach(g=>{const _=(g.profileName&&s?.profileNameMap?.get(g.profileName))??g.profileName??s?.fallbackProfileName,h=ur(g.dataBase64),o=new Blob([h],{type:g.type});u.put({key:g.key,siteId:g.siteId,path:g.path,blob:o,size:g.size,type:g.type,profileName:_})}),w.oncomplete=()=>c(),w.onerror=()=>x(w.error)})},pr=async(t,s)=>{const i=await Ge();if(s?.signal?.aborted)throw new Error("abort");await new Promise((l,u)=>{const g=i.transaction(fe,"readwrite"),E=g.objectStore(fe);t.sites.forEach(_=>{const o=(_.profileName&&s?.profileNameMap?.get(_.profileName))??_.profileName??s?.fallbackProfileName;E.put({..._,profileName:o})}),g.oncomplete=()=>l(),g.onerror=()=>u(g.error)});const c=t.files.length,x=50;let w=0;for(let l=0;l<t.files.length;l+=x){if(s?.signal?.aborted)throw new Error("abort");const u=t.files.slice(l,l+x);await new Promise((g,E)=>{const _=i.transaction(pe,"readwrite"),h=_.objectStore(pe);u.forEach(o=>{const a=(o.profileName&&s?.profileNameMap?.get(o.profileName))??o.profileName??s?.fallbackProfileName;h.put({key:o.key,siteId:o.siteId,path:o.path,blob:o.blob,size:o.size,type:o.type,profileName:a})}),_.oncomplete=()=>g(),_.onerror=()=>E(_.error)}),w+=u.length,s?.onProgress&&s.onProgress(w,c),s?.yieldControl&&await s.yieldControl()}},fs=t=>({meta:{app:"Escritorio Digital",version:cr,createdAt:new Date().toISOString()},data:t}),ps=t=>{if(!t||typeof t!="object")return!1;const s=t;return!(!s.meta||!s.data||typeof s.meta.app!="string"||typeof s.meta.version!="number"||typeof s.meta.createdAt!="string"||typeof s.data!="object")},xr=t=>{const s=new Uint8Array(t);return s.length>=4&&s[0]===80&&s[1]===75&&s[2]===3&&s[3]===4},wr=async(t,s,i,c,x)=>{const w=fs(t),l=[];await new Promise((_,h)=>{const o=new tn((a,N,P)=>{if(a){h(a);return}N&&l.push(N),P&&_()}),I=(a,N)=>{const P=new nn(a,{level:6});o.add(P),P.push(N,!0)};(async()=>{try{if(I("manifest.json",Tt(JSON.stringify(w))),s){const a=s.files.map(O=>({key:O.key,siteId:O.siteId,path:O.path,type:O.type,size:O.size,profileName:O.profileName}));I("localWeb/meta.json",Tt(JSON.stringify({sites:s.sites,files:a})));const N=s.files.length;let P=0;for(const O of s.files){if(x?.aborted){h(new Error("abort"));return}const K=await O.blob.arrayBuffer();I(`localWeb/files/${O.key}`,new Uint8Array(K)),P+=1,i&&i(P,N),c&&await c()}}o.end()}catch(a){h(a)}})()});const u=l.reduce((_,h)=>_+h.length,0),g=new Uint8Array(u);let E=0;return l.forEach(_=>{g.set(_,E),E+=_.length}),g},_r=t=>{const s=sn(new Uint8Array(t)),i=s["manifest.json"];if(!i)throw new Error("missing manifest");const c=JSON.parse(Lt(i));if(!ps(c))throw new Error("invalid payload");const x=s["localWeb/meta.json"];if(!x)return{payload:c};const w=JSON.parse(Lt(x)),l=[];return w.files.forEach(u=>{const g=s[`localWeb/files/${u.key}`];g&&l.push({...u,profileName:u.profileName,blob:new Blob([g],{type:u.type})})}),{payload:c,localWeb:{sites:w.sites??[],files:l}}},yr=async(t,s)=>{const i=await Ge(),{sites:c,files:x}=await new Promise((_,h)=>{const o=i.transaction([fe,pe],"readonly"),I=o.objectStore(fe).getAll(),a=o.objectStore(pe).getAll();o.oncomplete=()=>{_({sites:I.result??[],files:a.result??[]})},o.onerror=()=>h(o.error)}),w=Date.now(),l=c.filter(_=>_.profileName===t||!_.profileName);if(l.length===0)return;const u=new Map,g=l.map(_=>{const h=crypto.randomUUID();return u.set(_.id,h),{..._,id:h,profileName:s,createdAt:w,updatedAt:w}}),E=x.filter(_=>u.has(_.siteId)).map(_=>{const h=u.get(_.siteId);return{..._,key:`${h}::${_.path}`,siteId:h,profileName:s}});await new Promise((_,h)=>{const o=i.transaction([fe,pe],"readwrite"),I=o.objectStore(fe),a=o.objectStore(pe);l.forEach(N=>{N.profileName||I.put({...N,profileName:t})}),g.forEach(N=>I.put(N)),E.forEach(N=>{a.put({key:N.key,siteId:N.siteId,path:N.path,blob:N.blob,size:N.size,type:N.type,profileName:N.profileName})}),o.oncomplete=()=>_(),o.onerror=()=>h(o.error)})},jr=({profiles:t,setProfiles:s,activeProfileName:i,setActiveProfileName:c,onCloseSettings:x,profileOrder:w,setProfileOrder:l})=>{const{t:u}=T(),[g,E]=r.useState(""),[_,h]=r.useState("empty"),[o,I]=r.useState(null),[a,N]=r.useState(""),{theme:P}=_t(),O=["work-list","timer","file-opener","vce-community"],K="Escritorio Principal",Y=w.filter(k=>t[k]);Object.keys(t).forEach(k=>{Y.includes(k)||Y.push(k)});const ce=k=>k===K?u("settings.profiles.default_name"):k,X=async()=>{const k=g.trim();if(k&&!t[k]){const j=t[i],S=_==="clone"?{...j,theme:P}:{theme:Ze,activeWidgets:[],pinnedWidgets:O,vceFavorites:[]};if(s(W=>({...W,[k]:{...S}})),l(W=>[...W,k]),_==="clone")try{await yr(i,k)}catch(W){console.error(W)}c(k),E("")}else alert(u("settings.profiles.invalid_name_alert"))},de=k=>{if(Object.keys(t).length<=1){alert(u("settings.profiles.delete_last_alert"));return}const j=ce(k);if(window.confirm(u("settings.profiles.delete_confirm",{name:j}))){const S={...t};delete S[k],s(S),l(W=>W.filter(B=>B!==k)),i===k&&c(Object.keys(S)[0])}},Q=()=>{I(null),N("")},M=k=>{const j=a.trim();if(!j){alert(u("settings.profiles.invalid_name_alert"));return}if(j===k){Q();return}if(t[j]){alert(u("settings.profiles.invalid_name_alert"));return}s(S=>{const W={...S},B=W[k];return B?(delete W[k],W[j]=B,W):S}),l(S=>S.map(W=>W===k?j:W)),i===k&&c(j),Q()},ie=(k,j)=>{l(S=>{const W=S.filter(ee=>t[ee]),B=W.indexOf(k);if(B===-1)return S;const U=j==="up"?B-1:B+1;if(U<0||U>=W.length)return S;const J=[...W],[Z]=J.splice(B,1);return J.splice(U,0,Z),J})};return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:u("settings.profiles.save_current_title")}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:u("settings.profiles.create_mode_label")}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"profile-create-mode",value:"empty",checked:_==="empty",onChange:()=>h("empty")}),e.jsx("span",{children:u("settings.profiles.create_mode_empty")})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"profile-create-mode",value:"clone",checked:_==="clone",onChange:()=>h("clone")}),e.jsx("span",{children:u("settings.profiles.create_mode_clone")})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:g,onChange:k=>E(k.target.value),placeholder:u("settings.profiles.new_profile_placeholder"),className:"flex-grow bg-white border-2 border-gray-300 rounded p-2 focus:border-accent outline-none text-sm"}),e.jsx("button",{onClick:X,className:"font-semibold py-2 px-4 rounded-lg bg-accent text-text-dark",children:u("settings.profiles.save_button")})]})]}),e.jsx("div",{children:e.jsx("button",{onClick:()=>{x(),window.dispatchEvent(new CustomEvent("open-profile-backup",{detail:{tab:"export"}}))},className:"w-full text-left px-3 py-2 rounded-lg bg-white border border-gray-300 text-sm text-text-dark hover:bg-gray-100 transition-colors shadow-sm",children:u("backup.manage_profiles")})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:u("settings.profiles.saved_profiles_title")}),e.jsx("ul",{className:"space-y-2",children:Y.map((k,j)=>e.jsxs("li",{className:"flex items-center justify-between p-3 bg-white/50 rounded-lg",children:[o===k?e.jsx("input",{type:"text",value:a,onChange:S=>N(S.target.value),onBlur:()=>M(k),onKeyDown:S=>{S.key==="Enter"&&M(k),S.key==="Escape"&&Q()},placeholder:u("settings.profiles.rename_placeholder"),className:"flex-grow bg-white border-2 border-gray-300 rounded p-2 focus:border-accent outline-none text-sm"}):e.jsx("div",{onDoubleClick:()=>{I(k),N(k)},className:"flex-grow font-semibold cursor-text rounded px-2 py-1 hover:bg-white/60",title:u("settings.profiles.rename_hint"),children:ce(k)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ie(k,"up"),disabled:j===0,className:"p-2 rounded-lg bg-white border border-gray-200 text-gray-600 hover:bg-gray-100 disabled:opacity-40 disabled:cursor-not-allowed",title:u("settings.profiles.move_up"),"aria-label":u("settings.profiles.move_up"),children:e.jsx(Ns,{size:16})}),e.jsx("button",{onClick:()=>ie(k,"down"),disabled:j===Y.length-1,className:"p-2 rounded-lg bg-white border border-gray-200 text-gray-600 hover:bg-gray-100 disabled:opacity-40 disabled:cursor-not-allowed",title:u("settings.profiles.move_down"),"aria-label":u("settings.profiles.move_down"),children:e.jsx(Ss,{size:16})}),e.jsx("button",{onClick:()=>c(k),disabled:k===i,className:"p-2 rounded-lg bg-blue-500 text-white disabled:opacity-50",title:u(k===i?"settings.profiles.active_button":"settings.profiles.load_button"),"aria-label":u(k===i?"settings.profiles.active_button":"settings.profiles.load_button"),children:k===i?e.jsx(Is,{size:16}):e.jsx(zs,{size:16})}),e.jsx("button",{onClick:()=>de(k),className:"p-2 rounded-lg bg-red-500 text-white",title:u("settings.profiles.delete_button"),"aria-label":u("settings.profiles.delete_button"),children:e.jsx(Es,{size:16})})]})]},k))})]})]})},vr=({isOpen:t,onClose:s,initialTab:i="general",themeModalRequestId:c,pinnedWidgets:x,setPinnedWidgets:w,profiles:l,setProfiles:u,activeProfileName:g,setActiveProfileName:E,profileOrder:_,setProfileOrder:h})=>{const{t:o,i18n:I}=T(),[a,N]=r.useState("general"),[P,O]=r.useState(""),[K,Y]=et("widgets-view-mode","theme"),[ce,X]=r.useState(!1),de=r.useRef(null),{theme:Q,setTheme:M,setWallpaper:ie,resetTheme:k}=_t(),j=r.useRef(null);r.useEffect(()=>{t&&N(i)},[t,i]),r.useEffect(()=>{t||X(!1)},[t]),r.useEffect(()=>{!t||c==null||c<=0||de.current!==c&&(de.current=c,N("theme"),X(!0))},[t,c]);const S=y=>{const m=y.target.files?.[0];if(m){const V=new FileReader;V.onload=te=>{const ae=te.target?.result;ie(`url(${ae})`)},V.readAsDataURL(m)}},W=y=>{const{checked:m}=y.target;M(V=>({...V,showDateTime:m}))},B=y=>{const{checked:m}=y.target;M(V=>({...V,showSystemStats:m}))},U=y=>{const{value:m}=y.target;M({...Q,"--color-bg":m,"--wallpaper":"none"})},J=r.useCallback(y=>y.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),[]),Z=r.useMemo(()=>{const y=J(P.trim());return Object.values(Se).filter(V=>{if(!P.trim())return!0;const te=J(o(V.title)),ae=V.startTooltip?J(o(V.startTooltip)):"",Ne=(V.searchKeywords||[]).flatMap(se=>o(se).split(",")).map(se=>J(se.trim())).filter(Boolean).some(se=>se.includes(y));return te.includes(y)||ae.includes(y)||Ne}).sort((V,te)=>o(V.title).localeCompare(o(te.title)))},[J,P,o]),ee=r.useMemo(()=>cs(Z,o),[Z,o]),oe=20,Ie=y=>{w(m=>m.includes(y)?m.filter(V=>V!==y):m.length<oe?[...m,y]:(alert(o("settings.widgets.max_widgets_alert",{max:oe})),m))},Ce=y=>{const m=y.target.value;I.changeLanguage(m)},De=async()=>{if(!window.confirm(o("settings.general.reset_confirm")))return;const y=Array.from(new Set(["desktop-profiles","active-profile-name",...tt]));try{y.forEach(m=>window.localStorage.removeItem(m)),await Promise.all(tt.map(m=>hs(m))),await bs()}catch(m){console.warn("No se pudieron limpiar las preferencias locales.",m)}window.location.reload()};return e.jsxs(on,{children:[t&&e.jsx(Ft.div,{className:"fixed inset-0 bg-black/50 z-[10001] flex items-center justify-center",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:e.jsxs(Ft.div,{className:"bg-white/90 backdrop-blur-xl text-text-dark rounded-xl shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col",onClick:y=>y.stopPropagation(),initial:{scale:.7,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.7,opacity:0},transition:{type:"spring",stiffness:100,damping:10},children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:o("settings.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-black/10",children:e.jsx($e,{size:20})})]}),e.jsxs("div",{className:"flex border-b",children:[e.jsx("button",{onClick:()=>N("general"),className:`flex-1 p-3 font-semibold ${a==="general"?"bg-accent text-text-dark":"hover:bg-gray-200"}`,children:o("settings.tabs.general")}),e.jsx("button",{onClick:()=>N("profiles"),className:`flex-1 p-3 font-semibold ${a==="profiles"?"bg-accent text-text-dark":"hover:bg-gray-200"}`,children:o("settings.tabs.profiles")}),e.jsx("button",{onClick:()=>N("widgets"),className:`flex-1 p-3 font-semibold ${a==="widgets"?"bg-accent text-text-dark":"hover:bg-gray-200"}`,children:o("settings.tabs.widgets")}),e.jsx("button",{onClick:()=>N("theme"),className:`flex-1 p-3 font-semibold ${a==="theme"?"bg-accent text-text-dark":"hover:bg-gray-200"}`,children:o("settings.tabs.theme")})]}),e.jsxs("div",{className:"overflow-y-auto px-4 pb-4 pt-0",children:[a==="general"&&e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:o("settings.tabs.general")}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{htmlFor:"language-select",className:"font-medium",children:[o("settings.general.language"),":"]}),e.jsxs("select",{id:"language-select",value:I.language,onChange:Ce,className:"p-2 border rounded-lg bg-white/80 focus:ring-2 focus:ring-accent focus:outline-none",children:[e.jsx("option",{value:"es",children:"Español"}),e.jsx("option",{value:"ca",children:"Català"}),e.jsx("option",{value:"eu",children:"Euskara"}),e.jsx("option",{value:"gl",children:"Galego"}),e.jsx("option",{value:"pt",children:"Português"}),e.jsx("option",{value:"fr",children:"Français"}),e.jsx("option",{value:"it",children:"Italiano"}),e.jsx("option",{value:"de",children:"Deutsch"}),e.jsx("option",{value:"en",children:"English"})]})]}),e.jsxs("div",{className:"mt-6 p-4 border border-red-300 rounded-lg bg-red-50",children:[e.jsx("h4",{className:"font-semibold text-red-700 mb-2",children:o("settings.general.reset_title")}),e.jsx("p",{className:"text-sm text-red-700 mb-3",children:o("settings.general.reset_description")}),e.jsx("button",{onClick:De,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:o("settings.general.reset_button")})]})]}),a==="profiles"&&e.jsx("div",{className:"pt-4",children:e.jsx(jr,{profiles:l,setProfiles:u,activeProfileName:g,setActiveProfileName:E,onCloseSettings:s,profileOrder:_,setProfileOrder:h})}),a==="widgets"&&e.jsxs("div",{children:[e.jsxs("div",{className:"sticky top-0 z-10 -mx-4 px-4 pt-4 pb-4 bg-white/90 backdrop-blur border-b border-black/5 mb-4",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:o("settings.widgets.search"),value:P,onChange:y=>O(y.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg bg-white/80 focus:ring-2 focus:ring-accent focus:outline-none"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:o("settings.widgets.view_label")}),e.jsxs("div",{className:"flex rounded-lg border border-gray-200 overflow-hidden bg-white/70",children:[e.jsx("button",{type:"button",onClick:()=>Y("theme"),className:`px-3 py-1.5 text-sm font-semibold transition-colors ${K==="theme"?"bg-accent text-text-dark":"text-gray-600 hover:bg-gray-100"}`,children:o("settings.widgets.view_by_theme")}),e.jsx("button",{type:"button",onClick:()=>Y("alphabetical"),className:`px-3 py-1.5 text-sm font-semibold transition-colors ${K==="alphabetical"?"bg-accent text-text-dark":"text-gray-600 hover:bg-gray-100"}`,children:o("settings.widgets.view_alphabetical")})]})]})]}),e.jsx("p",{className:"mb-4 text-sm text-gray-600",children:o("settings.widgets.pinned_info",{count:x.length,max:oe})}),K==="alphabetical"?e.jsx("ul",{className:"space-y-2",children:Z.map(y=>e.jsxs("li",{className:"flex items-center justify-between p-3 bg-white/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-2xl",children:y.icon}),e.jsx("span",{className:"font-semibold",children:o(y.title)})]}),e.jsx("button",{onClick:()=>Ie(y.id),className:`font-semibold py-2 px-4 rounded-lg transition-colors ${x.includes(y.id)?"bg-widget-header text-text-light hover:bg-[#7b69b1]":"bg-accent text-text-dark hover:bg-[#8ec9c9]"}`,children:x.includes(y.id)?o("settings.widgets.remove"):o("settings.widgets.add")})]},y.id))}):e.jsx("div",{className:"space-y-5",children:ee.filter(y=>y.widgets.length>0).map(y=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2 uppercase tracking-wide",children:o(y.titleKey)}),e.jsx("ul",{className:"space-y-2",children:y.widgets.map(m=>e.jsxs("li",{className:"flex items-center justify-between p-3 bg-white/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-2xl",children:m.icon}),e.jsx("span",{className:"font-semibold",children:o(m.title)})]}),e.jsx("button",{onClick:()=>Ie(m.id),className:`font-semibold py-2 px-4 rounded-lg transition-colors ${x.includes(m.id)?"bg-widget-header text-text-light hover:bg-[#7b69b1]":"bg-accent text-text-dark hover:bg-[#8ec9c9]"}`,children:x.includes(m.id)?o("settings.widgets.remove"):o("settings.widgets.add")})]},m.id))})]},y.id))})]}),a==="theme"&&e.jsxs("div",{className:"pt-4",children:[e.jsxs("div",{className:"p-4 bg-white/70 border border-gray-200 rounded-lg space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:o("settings.theme.open_modal_title")}),e.jsx("p",{className:"text-sm text-gray-600",children:o("settings.theme.open_modal_help")})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-6 w-6 rounded-full border border-black/10",style:{backgroundColor:Q["--color-bg"]},"aria-hidden":"true"}),e.jsx("span",{className:"h-6 w-6 rounded-full border border-black/10",style:{backgroundColor:Q["--color-widget-bg"]},"aria-hidden":"true"}),e.jsx("span",{className:"h-6 w-6 rounded-full border border-black/10",style:{backgroundColor:Q["--color-accent"]},"aria-hidden":"true"})]}),e.jsx("button",{type:"button",onClick:()=>X(!0),className:"font-semibold py-2 px-4 rounded-lg bg-accent text-text-dark hover:bg-[#8ec9c9] transition-colors",children:o("settings.theme.open_modal_button")})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:o("settings.theme.wallpaper_title")}),e.jsx("div",{className:"mb-4 p-3 bg-white/70 border border-gray-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:o("settings.theme.solid_color_title")}),e.jsx("p",{className:"text-xs text-gray-500",children:o("settings.theme.solid_color_help")})]}),e.jsx("input",{type:"color",value:Q["--color-bg"],onChange:U,className:"theme-color-input","aria-label":o("settings.theme.solid_color_title")})]})}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4 max-h-56 overflow-y-auto pr-1",children:at.map(y=>{const m=ds(y),V=y.urls.some(te=>Q["--wallpaper"]===`url(${te})`);return e.jsx("button",{type:"button",onClick:()=>ie(m),className:`h-20 rounded-lg border transition-all ${V?"border-accent ring-2 ring-accent":"border-gray-200 hover:border-gray-400"}`,style:{backgroundImage:`url(${y.previewUrl})`,backgroundSize:"cover",backgroundPosition:"center"},"aria-label":o("settings.theme.wallpaper_title")},y.id)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>j.current?.click(),className:"flex-1 font-semibold py-2 px-4 rounded-lg bg-accent text-text-dark hover:bg-[#8ec9c9] transition-colors",children:o("settings.theme.upload_image_button")}),e.jsx("button",{onClick:()=>ie("none"),className:"flex-1 font-semibold py-2 px-4 rounded-lg bg-gray-300 text-text-dark hover:bg-gray-400 transition-colors",children:o("settings.theme.remove_wallpaper_button")})]}),e.jsx("input",{type:"file",ref:j,onChange:S,accept:"image/*",className:"hidden"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:o("settings.theme.screen_items_title")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:o("settings.theme.show_datetime_label")}),e.jsx("p",{className:"text-xs text-gray-500",children:o("settings.theme.show_datetime_help")})]}),e.jsx("input",{type:"checkbox",checked:!!(Q.showDateTime??!0),onChange:W,className:"h-5 w-5"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:o("settings.theme.show_system_stats_label")}),e.jsx("p",{className:"text-xs text-gray-500",children:o("settings.theme.show_system_stats_help")})]}),e.jsx("input",{type:"checkbox",checked:!!(Q.showSystemStats??!1),onChange:B,className:"h-5 w-5"})]})]})]}),e.jsx("button",{onClick:k,className:"w-full font-bold py-2 px-4 rounded-lg bg-red-500 text-white hover:bg-red-600 transition-colors mt-6",children:o("settings.theme.reset_theme_button")})]})]})]})},"settings-modal"),e.jsx(ir,{isOpen:ce,onClose:()=>X(!1)},"theme-settings-modal")]})},kr=({isOpen:t,onClose:s})=>{const{t:i}=T();return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[10001] flex items-center justify-center",onClick:s,children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-xl text-text-dark rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:i("credits.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-black/10",children:e.jsx($e,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto text-sm space-y-4",children:[e.jsx("p",{dangerouslySetInnerHTML:{__html:i("credits.original_project")}}),e.jsxs("p",{children:[i("credits.original_link")," ",e.jsx("a",{href:"https://mtgonzalezm.github.io/escritorio-interactivo-aula/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"https://mtgonzalezm.github.io/escritorio-interactivo-aula/"})]}),e.jsx("p",{children:e.jsxs(Ms,{i18nKey:"credits.new_version",children:["Esta nueva versión fue desarrollada en colaboración por ",e.jsx("strong",{children:"María Teresa González"}),", ",e.jsx("strong",{children:"Juan José de Haro"})," y ",e.jsx("strong",{children:"Pablo G. Guízar"}),". El repositorio de este proyecto se encuentra en:",e.jsx("a",{href:"https://github.com/escritorio-digital/escritorio",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:i("credits.repository_link_text")})]})}),e.jsx("hr",{}),e.jsx("p",{dangerouslySetInnerHTML:{__html:i("credits.vibe_community")}}),e.jsxs("ul",{className:"list-disc list-inside space-y-2",children:[e.jsxs("li",{children:[i("credits.vibe_apps_link_text")," ",e.jsx("a",{href:"https://vibe-coding-educativo.github.io/app_edu/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:i("credits.vibe_apps_repo_text")})]}),e.jsxs("li",{children:[i("credits.vibe_telegram_link_text")," ",e.jsx("a",{href:"https://t.me/vceduca",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"t.me/vceduca"})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"text-center p-4 bg-gray-100 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:i("credits.open_knowledge_adherence")}),e.jsx("a",{href:"https://conocimiento-abierto.github.io/",target:"_blank",rel:"noopener noreferrer",className:"text-lg font-bold text-blue-600 hover:underline",children:i("credits.open_knowledge_decalogue")}),e.jsx("p",{className:"mt-4",children:e.jsx("a",{href:"https://creativecommons.org/licenses/by-sa/4.0/deed.es",target:"_blank",rel:"noopener noreferrer",className:"inline-block",title:"Creative Commons Attribution-ShareAlike 4.0 International License",children:e.jsx("img",{src:"https://i.creativecommons.org/l/by-sa/4.0/88x31.png",alt:"Licencia Creative Commons BY-SA 4.0"})})})]})]})]})}):null},Cr=({isOpen:t,onClose:s})=>{const{t:i}=T();return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[10001] flex items-center justify-center",onClick:s,children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-xl text-text-dark rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:i("about.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-black/10",children:e.jsx($e,{size:20})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto text-sm space-y-5",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:i("about.app_name_label")}),e.jsx("p",{className:"font-semibold",children:i("about.app_name_value")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:i("about.version_label")}),e.jsx("p",{className:"font-semibold",children:i("about.version_value")})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold mb-2",children:i("about.history_title")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:i("about.initial_title")}),e.jsx("p",{className:"text-sm text-gray-700",children:i("about.initial_text")}),e.jsxs("p",{className:"text-sm mt-2",children:[i("about.original_app_label")," ",e.jsxs("a",{href:"https://mtgonzalezm.github.io/escritorio-interactivo-aula/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline inline-flex items-center gap-1",children:["mtgonzalezm.github.io/escritorio-interactivo-aula ",e.jsx(gt,{size:14})]})]})]}),e.jsxs("div",{className:"p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:i("about.development_title")}),e.jsx("p",{className:"text-sm text-gray-700",children:i("about.development_text")})]}),e.jsxs("div",{className:"p-3 bg-white/70 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:i("about.continuity_title")}),e.jsx("p",{className:"text-sm text-gray-700",children:i("about.continuity_text")})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold mb-2",children:i("about.community_title")}),e.jsxs("div",{className:"p-3 bg-white/70 border border-gray-200 rounded-lg space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-700",children:i("about.community_text")}),e.jsxs("p",{className:"text-sm",children:[i("about.community_repo_label")," ",e.jsxs("a",{href:"https://vibe-coding-educativo.github.io/app_edu/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline inline-flex items-center gap-1",children:["vibe-coding-educativo.github.io/app_edu ",e.jsx(gt,{size:14})]})]}),e.jsxs("p",{className:"text-sm",children:[i("about.community_telegram_label")," ",e.jsxs("a",{href:"https://t.me/vceduca",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline inline-flex items-center gap-1",children:["t.me/vceduca ",e.jsx(gt,{size:14})]})]})]})]})]})]})}):null},Kt={organization:{Icon:Hs,className:"bg-emerald-100 text-emerald-700"},time:{Icon:Vs,className:"bg-blue-100 text-blue-700"},math_science:{Icon:Bs,className:"bg-teal-100 text-teal-700"},board_writing:{Icon:Rs,className:"bg-amber-100 text-amber-700"},resources:{Icon:As,className:"bg-amber-100 text-amber-700"},interaction:{Icon:ct,className:"bg-rose-100 text-rose-700"},participation:{Icon:$s,className:"bg-indigo-100 text-indigo-700"},logic_games:{Icon:Ps,className:"bg-purple-100 text-purple-700"},gestures:{Icon:Fs,className:"bg-orange-100 text-orange-700"},community:{Icon:Ls,className:"bg-sky-100 text-sky-700"},other:{Icon:Ts,className:"bg-gray-100 text-gray-700"}},qt=20,Nr=({isOpen:t,onClose:s,onAddWidget:i,onOpenSettingsTab:c,onOpenThemeModal:x,onOpenAbout:w,onOpenCredits:l,onRemoveFavorite:u,onReorderFavorites:g,onClearFavorites:E,onAddFavorite:_,pinnedWidgets:h,anchorRect:o,anchorRef:I})=>{const{t:a,i18n:N}=T(),P=f=>f.startTooltip?a(f.startTooltip):a(f.title),O=r.useRef(null),K=r.useRef(null),Y=r.useRef(null),ce=r.useRef(null),X=r.useRef(null),[de,Q]=r.useState(""),[M,ie]=r.useState(null),[k,j]=r.useState("widgets"),[S,W]=r.useState(null),[B,U]=r.useState({isOpen:!1,x:0,y:0,widgetId:null}),[J,Z]=r.useState(!1),[ee,oe]=r.useState(null),[Ie,Ce]=r.useState(null),De=r.useRef(null),y=r.useCallback(f=>f.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),[]),m=r.useMemo(()=>Object.values(Se),[]),V=y(de.trim()),te=V.length>0,ae=r.useMemo(()=>V?m.filter(f=>{const D=y(a(f.title)),L=f.startTooltip?y(a(f.startTooltip)):"",q=(f.searchKeywords||[]).flatMap(H=>a(H).split(",")).map(H=>y(H.trim())).filter(Boolean).some(H=>H.includes(V));return D.includes(V)||L.includes(V)||q}):m,[y,V,a,m]),Ne=r.useMemo(()=>cs(ae,a),[ae,a]),se=r.useMemo(()=>h.filter(f=>Se[f]),[h]),ze=r.useMemo(()=>se.map(f=>Se[f]).filter(Boolean),[se]),xe=r.useMemo(()=>new Set(se),[se]),Ee=r.useMemo(()=>Ne.filter(f=>f.widgets.length>0),[Ne]);r.useEffect(()=>{if(!t)return;Q(""),j("widgets");const f=o?{left:Math.round(o.left),bottom:Math.round(window.innerHeight-o.top+4)}:{left:16,bottom:96};ie(f);const D=requestAnimationFrame(()=>{Y.current?.focus()});return()=>cancelAnimationFrame(D)},[o,t]),r.useEffect(()=>{if(!t)return;const f=window.setTimeout(()=>{Y.current?.focus(),Y.current?.select()},0);return()=>window.clearTimeout(f)},[t]),r.useEffect(()=>{t||(U({isOpen:!1,x:0,y:0,widgetId:null}),Z(!1))},[t]),r.useEffect(()=>{if(Ee.length===0){W(null);return}(!S||!Ee.some(f=>f.id===S))&&W(Ee[0].id)},[S,Ee]),r.useEffect(()=>{if(!t)return;const f=L=>{O.current&&O.current.contains(L.target)||I?.current&&I.current.contains(L.target)||s()},D=L=>{L.key==="Escape"&&s()};return window.addEventListener("mousedown",f),window.addEventListener("keydown",D),()=>{window.removeEventListener("mousedown",f),window.removeEventListener("keydown",D)}},[I,t,s]),r.useEffect(()=>{if(!B.isOpen)return;const f=()=>{const H=O.current,ue=ce.current;if(!H||!ue)return;const b=8,C=Math.max(b,H.clientWidth-ue.offsetWidth-b),z=Math.max(b,H.clientHeight-ue.offsetHeight-b);let A=Math.min(Math.max(B.x,b),C),R=Math.min(Math.max(B.y,b),z);(A!==B.x||R!==B.y)&&U(ne=>({...ne,x:A,y:R}))},D=H=>{O.current&&O.current.contains(H.target)&&H.target.closest('[data-favorite-menu="true"]')||U({isOpen:!1,x:0,y:0,widgetId:null})},L=H=>{H.key==="Escape"&&U({isOpen:!1,x:0,y:0,widgetId:null})},q=requestAnimationFrame(f);return window.addEventListener("mousedown",D),window.addEventListener("keydown",L),()=>{cancelAnimationFrame(q),window.removeEventListener("mousedown",D),window.removeEventListener("keydown",L)}},[B.isOpen]),r.useEffect(()=>{if(!J)return;const f=L=>{X.current&&X.current.contains(L.target)||Z(!1)},D=L=>{L.key==="Escape"&&Z(!1)};return window.addEventListener("mousedown",f),window.addEventListener("keydown",D),()=>{window.removeEventListener("mousedown",f),window.removeEventListener("keydown",D)}},[J]),r.useEffect(()=>{if(!t||!M)return;const f=O.current;if(!f)return;const D=f.getBoundingClientRect(),L=8;let q=M.left,H=M.bottom;D.left<L&&(q+=L-D.left),D.right>window.innerWidth-L&&(q-=D.right-(window.innerWidth-L)),D.top<L&&(H-=L-D.top),D.bottom>window.innerHeight-L&&(H+=D.bottom-(window.innerHeight-L)),(q!==M.left||H!==M.bottom)&&ie({left:q,bottom:H})},[t,M]);const ge=r.useCallback(()=>{if(!t||!M)return;const f=O.current?.querySelector('[data-start-menu-header="true"]'),D=O.current?.querySelector('[data-start-menu-search="true"]'),L=K.current;if(!f||!D||!L)return;const q=24,H=f.getBoundingClientRect().height,ue=D.getBoundingClientRect().height,b=Math.floor(window.innerHeight*.72),C=Math.max(0,b-H-ue-q),z=L.scrollHeight,A=Math.min(C,220),R=Math.min(C,Math.max(z,A));let ne=R;te?ne=De.current??R:De.current=R,oe(ne),Ce(H+ue+q+ne)},[t,M,te]);r.useLayoutEffect(()=>{if(!(!t||!M))return ge(),window.addEventListener("resize",ge),()=>{window.removeEventListener("resize",ge)}},[t,M,ge]),r.useEffect(()=>{if(!t)return;const f=requestAnimationFrame(ge);return()=>{cancelAnimationFrame(f)}},[t,ge]),r.useEffect(()=>{t&&ge()},[t,te,ge]);const Ae=Jt(rt(os,{activationConstraint:{distance:6}}),rt(is,{coordinateGetter:ns})),Be=f=>{const{active:D,over:L}=f;if(!L||D.id===L.id)return;const q=se.indexOf(String(D.id)),H=se.indexOf(String(L.id));if(q===-1||H===-1)return;const ue=ss(se,q,H),b=h.filter(C=>!Se[C]);g([...ue,...b])},Ue=({widgetId:f})=>{const D=Se[f],{attributes:L,listeners:q,setNodeRef:H,transform:ue,transition:b,isDragging:C}=rs({id:f});if(!D)return null;const z={transform:as.Transform.toString(ue),transition:b};return e.jsxs("button",{ref:H,style:z,onClick:()=>Te(D.id),onContextMenu:A=>{A.preventDefault(),A.stopPropagation();const R=O.current?.getBoundingClientRect(),ne=R?A.clientX-R.left:A.clientX,_e=R?A.clientY-R.top:A.clientY;U({isOpen:!0,x:ne,y:_e,widgetId:D.id})},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm min-w-0 ${C?"opacity-70":""}`,title:P(D),children:[e.jsx("span",{className:"text-2xl",children:D.icon}),e.jsx("span",{className:"flex-1 min-w-0 text-sm font-semibold text-text-dark leading-tight truncate",children:a(D.title)}),e.jsx("span",{...L,...q,onClick:A=>A.stopPropagation(),className:"text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing",title:a("start_menu.reorder_favorites"),children:e.jsx(Us,{size:16})})]})};if(!t||!M)return null;const Te=f=>{i(f),s()},we=f=>{c(f),s()},Ye=f=>{if(f.key!=="Enter")return;const D=ae[0];D&&Te(D.id)},je=S&&Ee.find(f=>f.id===S)||null,Ve=(f,D=!0)=>e.jsx("div",{className:"space-y-1",children:f.map(L=>e.jsxs("button",{onClick:()=>Te(L.id),onContextMenu:q=>{q.preventDefault(),q.stopPropagation();const H=O.current?.getBoundingClientRect(),ue=H?q.clientX-H.left:q.clientX,b=H?q.clientY-H.top:q.clientY;U({isOpen:!0,x:ue,y:b,widgetId:L.id})},className:`w-full flex items-center gap-3 px-3 py-[0.45rem] rounded-lg border transition text-left shadow-sm min-w-0 ${D&&xe.has(L.id)?"bg-amber-50 border-amber-300":"bg-white/90 hover:bg-amber-50 border-gray-200"}`,title:P(L),children:[e.jsx("span",{className:"text-2xl",children:L.icon}),e.jsx("span",{className:"flex-1 min-w-0 text-sm font-semibold text-text-dark leading-tight truncate",children:a(L.title)}),D&&xe.has(L.id)&&e.jsx(Mt,{size:14,className:"text-amber-500"})]},L.id))});return e.jsxs("div",{ref:O,className:"fixed z-[10001] w-[min(34rem,calc(100vw-1rem))] max-h-[72vh] bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl border border-gray-200 flex flex-col overflow-hidden",style:{left:M.left,bottom:M.bottom,height:Ie?`${Ie}px`:void 0},onContextMenu:f=>{f.preventDefault(),f.stopPropagation()},children:[e.jsxs("div",{"data-start-menu-header":"true",className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gradient-to-r from-white to-amber-50/70 rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:$("escritorio-digital.png"),alt:a("toolbar.start"),width:"22",height:"22"}),e.jsx("h3",{className:"text-base font-semibold text-text-dark",children:a("start_menu.title")})]}),e.jsxs("div",{className:"relative flex items-center gap-2 text-gray-600",children:[e.jsx("button",{type:"button",onClick:()=>{j("favorites")},className:`p-2 rounded-full border transition ${k==="favorites"?"bg-amber-100 border-amber-300 text-amber-700":"bg-white/80 border-gray-200 hover:bg-amber-50"}`,title:a("start_menu.favorites"),"aria-label":a("start_menu.favorites"),children:e.jsx(Mt,{size:16})}),e.jsx("button",{type:"button",onClick:()=>{j("shortcuts")},className:`p-2 rounded-full border transition ${k==="shortcuts"?"bg-amber-100 border-amber-300 text-amber-700":"bg-white/80 border-gray-200 hover:bg-amber-50"}`,title:a("context_menu.settings"),"aria-label":a("context_menu.settings"),children:e.jsx(xt,{size:16})}),e.jsx("button",{type:"button",onClick:()=>{Z(f=>!f)},className:"p-2 rounded-full border bg-white/80 border-gray-200 hover:bg-amber-50 transition",title:a("start_menu.language_label"),"aria-label":a("start_menu.language_label"),children:e.jsx(Os,{size:16})}),e.jsx("button",{type:"button",onClick:()=>{j("help")},className:`p-2 rounded-full border transition ${k==="help"?"bg-amber-100 border-amber-300 text-amber-700":"bg-white/80 border-gray-200 hover:bg-amber-50"}`,title:a("start_menu.help"),"aria-label":a("start_menu.help"),children:e.jsx(Ds,{size:16})}),J&&e.jsx("div",{ref:X,className:"absolute right-0 top-10 z-[10003] min-w-[160px] rounded-lg border border-gray-200 bg-white/95 shadow-xl p-1 text-sm text-text-dark",children:[{id:"es",label:"Español"},{id:"ca",label:"Català"},{id:"eu",label:"Euskara"},{id:"gl",label:"Galego"},{id:"pt",label:"Português"},{id:"fr",label:"Français"},{id:"it",label:"Italiano"},{id:"de",label:"Deutsch"},{id:"en",label:"English"}].map(f=>e.jsx("button",{onClick:()=>{N.changeLanguage(f.id),Z(!1)},className:`w-full text-left px-3 py-2 rounded-md hover:bg-gray-100 transition ${N.language===f.id?"bg-amber-50 text-amber-800":""}`,children:f.label},f.id))})]})]}),e.jsx("div",{"data-start-menu-search":"true",className:"px-4 py-3 border-b border-gray-200 bg-white/70",children:e.jsx("div",{className:"relative",children:e.jsx("input",{ref:Y,autoFocus:!0,type:"text",placeholder:a("settings.widgets.search"),value:de,onChange:f=>Q(f.target.value),onKeyDown:Ye,className:"w-full pl-3 pr-4 py-2 border rounded-lg bg-white/90 focus:ring-2 focus:ring-accent focus:outline-none"})})}),e.jsx("div",{className:"flex-1 overflow-hidden px-4 py-3 bg-gradient-to-b from-white to-gray-50",children:e.jsxs("div",{className:"flex items-start gap-4 h-full",children:[e.jsx("div",{ref:K,className:"w-52 shrink-0 flex flex-col gap-4 min-h-0",children:e.jsx("div",{className:"pr-1",style:{maxHeight:ee?`${ee}px`:void 0,overflowY:"auto"},children:e.jsx("div",{className:"space-y-1",children:Ee.map(f=>{const D=Kt[f.id]??Kt.other;return e.jsxs("button",{onClick:()=>{j("widgets"),W(f.id)},className:`w-full text-left px-3 py-2 rounded-lg text-[0.8125rem] font-semibold border transition flex items-center gap-2 ${S===f.id&&k==="widgets"?"bg-accent text-text-dark border-transparent":"bg-white/90 hover:bg-amber-50 border-gray-200"}`,children:[e.jsx("span",{className:`h-5 w-5 rounded-md flex items-center justify-center ${D.className}`,children:e.jsx(D.Icon,{size:12})}),e.jsx("span",{className:"leading-tight",children:a(f.titleKey)}),e.jsx("span",{className:"ml-auto text-[0.625rem] font-semibold text-gray-600",children:f.widgets.length})]},f.id)})})})}),e.jsxs("div",{className:"flex-1 overflow-y-auto pr-1 h-full",style:ee?{maxHeight:`${ee}px`}:void 0,children:[k==="favorites"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:a("start_menu.favorites")}),ze.length>0&&e.jsx("button",{className:"text-xs font-semibold text-red-600 hover:text-red-700",onClick:()=>{window.confirm(a("start_menu.clear_favorites_confirm"))&&E()},children:a("start_menu.clear_favorites")})]}),ze.length>0?e.jsx(Zt,{sensors:Ae,collisionDetection:es,onDragStart:()=>{U({isOpen:!1,x:0,y:0,widgetId:null})},onDragEnd:Be,children:e.jsx(ts,{items:se,strategy:cn,children:e.jsx("div",{className:"space-y-1",children:se.map(f=>e.jsx(Ue,{widgetId:f},f))})})}):e.jsx("p",{className:"text-sm text-gray-500",children:a("start_menu.no_results")})]}),k==="shortcuts"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:a("context_menu.settings")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>we("general"),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Ks,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("context_menu.settings")})]}),e.jsxs("button",{onClick:()=>we("profiles"),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(ct,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("context_menu.manage_profiles")})]}),e.jsxs("button",{onClick:()=>{x(),s()},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(xt,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("start_menu.theme_accessibility")})]}),e.jsxs("button",{onClick:()=>we("theme"),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Qt,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("context_menu.change_background")})]}),e.jsxs("button",{onClick:()=>we("widgets"),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Xt,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("toolbar.widgetLibrary")})]})]})]}),k==="help"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:a("start_menu.help")}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("button",{onClick:()=>{Te("program-guide")},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Yt,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("help.guide")})]}),e.jsxs("button",{onClick:()=>{w(),s()},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(qs,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("help.about")})]}),e.jsxs("button",{onClick:()=>{l(),s()},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-white/90 hover:bg-amber-50 border border-gray-200 transition text-left shadow-sm",children:[e.jsx(Gs,{size:18}),e.jsx("span",{className:"text-sm font-semibold",children:a("help.licenses")})]})]})]}),k==="widgets"&&e.jsx("div",{className:"space-y-3",children:te?ae.length>0?Ve(ae,!0):e.jsx("p",{className:"text-sm text-gray-500",children:a("start_menu.no_results")}):je?.widgets.length?Ve(je.widgets,!0):e.jsx("p",{className:"text-sm text-gray-500",children:a("start_menu.no_results")})})]})]})}),B.isOpen&&B.widgetId&&e.jsx("div",{"data-favorite-menu":"true",ref:ce,className:"absolute z-[10002] min-w-[180px] bg-white/95 backdrop-blur-md rounded-lg shadow-xl border border-gray-200 py-2 text-sm text-text-dark",style:{left:B.x,top:B.y},children:e.jsx("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{const f=B.widgetId;xe.has(f)?u(f):se.length<qt?_(f):alert(a("settings.widgets.max_widgets_alert",{max:qt})),U({isOpen:!1,x:0,y:0,widgetId:null})},children:xe.has(B.widgetId)?a("start_menu.remove_favorite"):a("start_menu.add_favorite")})})]})},Sr=({profiles:t,activeProfileName:s,setActiveProfileName:i,onManageProfiles:c,onOpenContextMenu:x,setProfiles:w,profileOrder:l})=>{const[u,g]=r.useState(!1),[E,_]=r.useState(!1),[h,o]=r.useState("export"),[I]=r.useState(!0),[a,N]=r.useState(!0),[P,O]=r.useState(!0),[K,Y]=r.useState(!1),[ce,X]=r.useState(!1),[de,Q]=r.useState(!1),[M,ie]=r.useState([]),[k,j]=r.useState("replace"),[S,W]=r.useState(""),[B,U]=r.useState(""),[J,Z]=r.useState(!1),[ee,oe]=r.useState(!1),[Ie,Ce]=r.useState(""),[De,y]=r.useState(""),{t:m}=T(),V=r.useMemo(()=>{const b=Object.keys(t),C=l.filter(z=>b.includes(z));return b.forEach(z=>{C.includes(z)||C.push(z)}),C},[t,l]),te=I&&M.length>0&&M.length<V.length,ae=(ce||de)&&M.length>0,Ne=r.useRef(null),se=r.useRef(null),ze=r.useRef(0),xe=r.useRef(null),Ee="Escritorio Principal";r.useEffect(()=>{const b=C=>{const z=C.detail;o(z?.tab??"export"),_(!0),g(!1)};return window.addEventListener("open-profile-backup",b),()=>window.removeEventListener("open-profile-backup",b)},[]);const ge=b=>b===Ee?m("settings.profiles.default_name"):b,Ae=b=>{i(b),g(!1)},Be=()=>{c(),g(!1)};r.useEffect(()=>{if(!u&&!E)return;const b=C=>{Ne.current&&(Ne.current.contains(C.target)||(g(!1),_(!1)))};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[u,E]),r.useEffect(()=>{if(!E)return;ie(C=>C.length===V.length&&C.every(z=>V.includes(z))?C:V),W(""),U(""),o("export"),j("replace");const b=tt.some(C=>!!window.localStorage.getItem(C));Y(b),N(b),ht().then(C=>{const z=C.siteCount>0;X(z),z||O(!1)}).catch(()=>{X(!1),O(!1)})},[E,V,s]),r.useEffect(()=>{E&&M.length!==0&&ht(M).then(b=>{const C=b.siteCount>0;Q(C),C||O(!1)}).catch(()=>{Q(!1),O(!1)})},[E,M,s]),r.useEffect(()=>{te&&a&&N(!1)},[te,a]),r.useEffect(()=>{ae||P&&O(!1)},[ae,P]);const Ue=b=>{ie(C=>C.includes(b)?C.filter(z=>z!==b):[...C,b])},Te=b=>{const C=new Blob([b],{type:"application/zip"}),z=URL.createObjectURL(C),A=document.createElement("a");A.href=z,A.download=`escritorio-digital-backup-${new Date().toISOString().slice(0,10)}.zip`,document.body.appendChild(A),A.click(),A.remove(),URL.revokeObjectURL(z)},we=()=>{oe(!1),Ce(""),y("")},Ye=b=>{if(!Number.isFinite(b))return"0 B";if(b<1024)return`${b} B`;const C=b/1024;if(C<1024)return`${C.toFixed(1)} KB`;const z=C/1024;return z<1024?`${z.toFixed(1)} MB`:`${(z/1024).toFixed(2)} GB`},je=async()=>{const b={};if(I&&M.length>0){const C={};M.forEach(z=>{t[z]&&(C[z]=t[z])}),b.profiles=C,b.activeProfileName=C[s]?s:M[0]}return a&&K&&!te&&(b.widgetData=await mr(tt)),fs(b)},Ve=(b,C)=>{const z={...b},A=new Map;return Object.entries(C).forEach(([R,ne])=>{let _e=R;if(z[_e]){let me=2;for(;z[`${R} (${me})`];)me+=1;_e=`${R} (${me})`}z[_e]=ne,A.set(R,_e)}),{updated:z,nameMap:A}},f=async()=>{let b=0;for(const C of tt){const z=window.localStorage.getItem(C);if(z)if(z==="__indexed_db__"){const A=await ms(C);A&&(b+=new Blob([A]).size)}else b+=new Blob([z]).size}return b},D=async()=>{let b=0;if(I&&M.length>0){const C={};M.forEach(A=>{t[A]&&(C[A]=t[A])});const z={profiles:C,activeProfileName:C[s]?s:M[0]};b+=new Blob([JSON.stringify(z)]).size}if(a&&K&&!te&&(b+=await f()),P){const C=await ht(M);C.siteCount>0&&(b+=Math.ceil(C.totalBytes*1.1))}return b};r.useEffect(()=>{if(!E)return;ze.current+=1;const b=ze.current;(async()=>{if(I&&M.length===0){U(m("backup.size_unknown")),Z(!1);return}Z(!0);try{const z=await D();if(ze.current!==b)return;U(m("backup.size_label",{size:Ye(z)}))}catch{ze.current===b&&U(m("backup.size_unknown"))}finally{ze.current===b&&Z(!1)}})()},[E,I,a,P,M,K,ce,t,s,m]);const L=async()=>{if(I&&M.length===0){W(m("backup.no_profiles"));return}W(m("backup.exporting")),_(!1),oe(!0),Ce(m("backup.progress_export_title")),y(m("backup.progress_preparing")),xe.current?.abort();const b=new AbortController;xe.current=b;try{const C=await je(),z=M.includes(s)?s:M[0],A=P?await br(M,z):void 0;let R=0,ne=0;const _e=await wr(C.data,A,(me,le)=>{const he=performance.now();he-R>200&&(y(`${me}/${le}`),R=he)},async()=>{ne+=1,ne%5===0&&await new Promise(me=>requestAnimationFrame(()=>me()))},b.signal);if(b.signal.aborted)return;Te(_e),W(m("backup.export_ready"))}catch(C){b.signal.aborted||(console.error(C),W(m("backup.invalid_file")))}finally{b.signal.aborted||we()}},q=()=>{_(!1),se.current?.click()},H=async b=>{const C=b.target.files?.[0];if(C)try{W(m("backup.importing")),oe(!0),Ce(m("backup.progress_import_title")),y(m("backup.progress_preparing")),xe.current?.abort();const z=new AbortController;xe.current=z;const A=await C.arrayBuffer();let R,ne;if(xr(A)||C.name.toLowerCase().endsWith(".zip")){const le=_r(A);R=le.payload,ne=le.localWeb}else{const le=new TextDecoder().decode(A);if(R=JSON.parse(le),!ps(R)){W(m("backup.invalid_file")),we();return}}if(!R?.data){W(m("backup.invalid_file")),we();return}if(z.signal.aborted)return;let _e,me=R.data.activeProfileName||s;if(R.data.profiles)if(k==="replace"){const le=R.data.profiles,he=Object.keys(le);if(he.length>0){w(le);const be=R.data.activeProfileName,We=be&&le[be]?be:he[0];i(We),me=We}}else w(le=>{const he=Ve(le,R.data.profiles||{});_e=he.nameMap;const be=R.data.activeProfileName;if(be){const We=he.nameMap.get(be);We?(i(We),me=We):he.updated[be]&&(i(be),me=be)}return he.updated});if(R.data.widgetData&&await hr(R.data.widgetData),R.data.localWeb||ne){if(k==="replace"&&await bs(),ne){let le=0,he=0;await pr(ne,{signal:z.signal,onProgress:(be,We)=>{const Xe=performance.now();Xe-le>200&&(y(`${be}/${We}`),le=Xe)},yieldControl:async()=>{he+=1,he%5===0&&await new Promise(be=>requestAnimationFrame(()=>be()))},profileNameMap:_e,fallbackProfileName:me})}else R.data.localWeb&&await fr(R.data.localWeb,{profileNameMap:_e,fallbackProfileName:me});window.dispatchEvent(new Event("local-web-data-changed"))}W(m("backup.import_done")),z.signal.aborted||we(),window.location.reload()}catch(z){xe.current?.signal.aborted?W(""):(console.error(z),W(m("backup.invalid_file"))),we()}finally{b.target.value=""}},ue=()=>{xe.current?.abort(),we(),W("")};return e.jsx("div",{className:"fixed bottom-4 right-4 z-[9999]",ref:Ne,onContextMenu:x,children:e.jsxs("div",{className:"relative",children:[u&&e.jsxs("div",{className:"absolute bottom-full mb-2 w-56 bg-white/80 backdrop-blur-md rounded-lg shadow-lg border border-black/10 text-sm",children:[e.jsx("ul",{className:"p-1",children:V.map(b=>e.jsx("li",{children:e.jsx("button",{onClick:()=>Ae(b),className:`w-full text-left px-3 py-2 rounded-md transition-colors ${b===s?"font-semibold bg-accent/30 text-text-dark":"hover:bg-accent hover:text-text-dark"}`,children:ge(b)})},b))}),e.jsxs("div",{className:"border-t border-black/10 p-1 space-y-1",children:[e.jsxs("button",{onClick:Be,className:"w-full text-left px-3 py-2 rounded-md hover:bg-accent hover:text-text-dark transition-colors flex items-center gap-2",children:[e.jsx(ct,{size:16}),m("settings.profiles.manage_button")]}),e.jsxs("button",{onClick:()=>{_(!0),g(!1)},className:"w-full text-left px-3 py-2 rounded-md hover:bg-accent hover:text-text-dark transition-colors flex items-center gap-2",children:[e.jsx(Ot,{size:16}),m("backup.manage_profiles")]})]})]}),e.jsxs("button",{onClick:()=>g(!u),onContextMenu:x,className:"w-56 h-12 px-4 bg-black/20 backdrop-blur-md rounded-full text-white hover:bg-black/40 transition-colors flex items-center justify-between",title:m("settings.profiles.switcher_title"),children:[e.jsx("span",{className:"font-semibold",children:ge(s)}),u?e.jsx(Ys,{size:20}):e.jsx(Xs,{size:20})]}),E&&e.jsx("div",{className:"fixed inset-0 z-[10001] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"w-full max-w-xl bg-white/90 backdrop-blur-md rounded-xl shadow-2xl border border-black/10 p-5 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"font-semibold text-lg",children:m("backup.manage_profiles")}),e.jsx("button",{onClick:()=>_(!1),className:"text-gray-600 hover:text-gray-800",children:"✕"})]}),e.jsxs("div",{className:"flex border-b border-gray-300 mb-5",children:[e.jsx("button",{onClick:()=>o("export"),className:`-mb-px px-4 py-2 text-sm font-semibold rounded-t-md border transition-colors ${h==="export"?"bg-accent text-text-dark border-accent border-b-white shadow-sm":"bg-gray-100 text-gray-600 border-transparent hover:text-text-dark"}`,children:m("backup.tab_export")}),e.jsx("button",{onClick:()=>o("import"),className:`-mb-px ml-1 px-4 py-2 text-sm font-semibold rounded-t-md border transition-colors ${h==="import"?"bg-accent text-text-dark border-accent border-b-white shadow-sm":"bg-gray-100 text-gray-600 border-transparent hover:text-text-dark"}`,children:m("backup.tab_import")})]}),h==="export"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:m("backup.choose_profiles")}),e.jsx("div",{className:"space-y-1 max-h-32 overflow-auto border border-gray-200 rounded-lg p-2 bg-white/60",children:V.map(b=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:M.includes(b),onChange:()=>Ue(b)}),e.jsx("span",{children:ge(b)})]},b))}),e.jsx("div",{className:"text-xs text-gray-500",children:m("backup.include_profiles")}),K&&e.jsxs("label",{className:`flex items-center gap-2 ${te?"opacity-50":""}`,children:[e.jsx("input",{type:"checkbox",checked:a,onChange:b=>N(b.target.checked),disabled:te}),e.jsx("span",{children:m("backup.include_widgets")})]}),e.jsxs("label",{className:`flex items-center gap-2 ${ae?"":"opacity-50"}`,children:[e.jsx("input",{type:"checkbox",checked:P,onChange:b=>O(b.target.checked),disabled:!ae}),e.jsx("span",{children:m("backup.include_local_web")})]})]}),e.jsx("div",{className:"mt-3 text-sm text-gray-700 font-semibold",children:J?m("backup.size_estimating"):B||m("backup.size_unknown")}),S&&e.jsx("div",{className:"mt-2 text-xs text-gray-600",children:S}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:L,className:"w-full py-2 rounded-md bg-accent text-text-dark font-semibold hover:bg-[#8ec9c9] transition-colors flex items-center justify-center gap-2",children:[e.jsx(Ot,{size:16}),m("backup.export_button")]})})]}),h==="import"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:m("backup.import_mode_label")}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"import-mode",value:"replace",checked:k==="replace",onChange:()=>j("replace")}),e.jsx("span",{children:m("backup.import_mode_replace")})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"import-mode",value:"merge",checked:k==="merge",onChange:()=>j("merge")}),e.jsx("span",{children:m("backup.import_mode_merge")})]})]}),S&&e.jsx("div",{className:"mt-2 text-xs text-gray-600",children:S}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:q,className:"w-full py-2 rounded-md border border-gray-200 bg-white hover:bg-gray-100 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Qs,{size:16}),m("backup.import_button")]})}),e.jsx("p",{className:"mt-3 text-[11px] text-gray-500",children:m("backup.import_note")})]})]})}),ee&&e.jsx("div",{className:"fixed inset-0 z-[10002] flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"w-full max-w-sm bg-white/95 backdrop-blur-md rounded-xl shadow-2xl border border-black/10 p-5 text-sm",children:[e.jsx("div",{className:"font-semibold text-lg mb-2",children:Ie}),e.jsx("div",{className:"text-sm text-gray-700 mb-4",children:De}),e.jsx("button",{onClick:ue,className:"w-full py-2 rounded-md border border-gray-200 bg-white hover:bg-gray-100 transition-colors font-semibold",children:m("backup.progress_cancel")})]})}),e.jsx("input",{ref:se,type:"file",accept:"application/json,application/zip,.zip",className:"hidden",onChange:H})]})})},Ir=({profiles:t,setProfiles:s,activeProfileName:i,setActiveProfileName:c,profileOrder:x,setProfileOrder:w})=>{const{t:l,i18n:u}=T(),g=t[i]||Object.values(t)[0],E=g.theme?.showDateTime??!0,_=g.theme?.showSystemStats??!1,h=r.useCallback(n=>{s(d=>{const p=d[i]||g;if(!p)return d;const v=typeof n=="function"?n(p.activeWidgets):n;return v===p.activeWidgets?d:{...d,[i]:{...p,activeWidgets:v}}})},[g,i,s]),o=r.useCallback(n=>{s(d=>{const p=d[i]||g;if(!p)return d;const v=typeof n=="function"?n(p.pinnedWidgets):n;return v===p.pinnedWidgets?d:{...d,[i]:{...p,pinnedWidgets:v}}})},[g,i,s]),I=r.useCallback(()=>{const n=!E,d={...g,theme:{...g.theme,showDateTime:n}};s(p=>({...p,[i]:d}))},[g,i,s,E]),a=r.useCallback(()=>{const n=!_,d={...g,theme:{...g.theme,showSystemStats:n}};s(p=>({...p,[i]:d}))},[g,i,s,_]),[N,P]=r.useState(100),O=r.useRef(100);r.useEffect(()=>{const n=g.activeWidgets.reduce((d,p)=>p.zIndex>d?p.zIndex:d,100);P(d=>d<n?n:d)},[g.activeWidgets]),r.useEffect(()=>{O.current=N},[N]);const[K,Y]=r.useState(null),[ce,X]=r.useState(!1),[de,Q]=r.useState(!1),[M,ie]=r.useState(!1),[k,j]=r.useState(0),S=r.useRef(null),[W,B]=r.useState(!1),[U,J]=r.useState(null),[Z,ee]=r.useState("general"),[oe,Ie]=et("toolbar-hidden",!1),[Ce,De]=r.useState(!1),[y,m]=r.useState({isOpen:!1,x:0,y:0,widgetId:null,windowInstanceId:null}),V=r.useRef(null),[te,ae]=r.useState(!1),[Ne,se]=r.useState(!!document.fullscreenElement);r.useEffect(()=>{if(g.activeWidgets.length===0){Y(null);return}if(!K||!g.activeWidgets.some(n=>n.instanceId===K)){const n=g.activeWidgets.reduce((d,p)=>d?p.zIndex>d.zIndex?p:d:p,null);Y(n?n.instanceId:null)}},[g.activeWidgets,K]),r.useEffect(()=>{const n=Object.keys(t);w(d=>{const p=d.filter(v=>n.includes(v));return n.forEach(v=>{p.includes(v)||p.push(v)}),p.length===d.length&&p.every((v,G)=>v===d[G])?d:p})},[t,w]);const ze=()=>{const d=Math.max(200,window.innerWidth-32),p=Math.max(150,window.innerHeight-32);return{margin:16,maxWidth:d,maxHeight:p}},xe=n=>{if(n.isMaximized)return n;const{margin:d,maxWidth:p,maxHeight:v}=ze(),G=(Fe,Pe)=>{if(typeof Fe=="number")return Fe;const ke=Fe.trim();if(ke.endsWith("vw")){const Je=Number.parseFloat(ke);return Number.isFinite(Je)?window.innerWidth*Je/100:Pe}if(ke.endsWith("vh")){const Je=Number.parseFloat(ke);return Number.isFinite(Je)?window.innerHeight*Je/100:Pe}const Wt=Number.parseFloat(ke);return Number.isFinite(Wt)?Wt:Pe},re=Math.min(G(n.size.width,p),p),ye=Math.min(G(n.size.height,v),v),ve=Math.max(d,window.innerWidth-re-d),Oe=Math.max(d,window.innerHeight-ye-d),Re=Math.min(Math.max(n.position.x,d),ve),qe=Math.min(Math.max(n.position.y,d),Oe);return{...n,size:{width:re,height:ye},position:{x:Re,y:qe}}},Ee=n=>{const d=Se[n];if(!d)return;const p=N+1;P(p);const{margin:v,maxWidth:G,maxHeight:re}=ze(),ye=typeof d.defaultSize.width=="number"?Math.min(d.defaultSize.width,G):d.defaultSize.width,ve=typeof d.defaultSize.height=="number"?Math.min(d.defaultSize.height,re):d.defaultSize.height,Oe=typeof ye=="number"?ye:G,Re=typeof ve=="number"?ve:re,qe=Math.max(v,window.innerWidth-Oe-v),Fe=Math.max(v,window.innerHeight-Re-v),Pe={instanceId:`${n}-${Date.now()}`,widgetId:n,position:{x:Math.max(v,Math.random()*qe),y:Math.max(v,Math.random()*Fe)},size:{width:ye,height:ve},zIndex:p};h(ke=>[...ke,Pe]),Y(Pe.instanceId)},ge=n=>h(d=>{const p=d.filter(v=>v.instanceId!==n);if(K===n){const v=p.reduce((G,re)=>G?re.zIndex>G.zIndex?re:G:re,null);Y(v?v.instanceId:null)}return p}),Ae=r.useCallback(n=>{const d=O.current+1;O.current=d,P(d),h(p=>p.map(v=>v.instanceId===n?{...v,zIndex:d}:v)),Y(n)},[h]),Be=n=>h(d=>d.map(p=>p.instanceId===n?{...p,isMinimized:!p.isMinimized}:p)),Ue=r.useCallback(n=>{const d=g.activeWidgets.find(p=>p.instanceId===n);if(d){if(d.isMinimized){const p=N+1;P(p),h(v=>v.map(G=>G.instanceId===n?{...G,isMinimized:!1,zIndex:p}:G)),Y(n);return}if(K!==n){Ae(n);return}h(p=>p.map(v=>v.instanceId===n?{...v,isMinimized:!0}:v))}},[g.activeWidgets,K,Ae,N,h,P]),Te=r.useCallback(()=>{h(n=>n.map(d=>({...d,isMinimized:!0})))},[h]),we=n=>{const d=N+1;P(d),h(p=>p.map(v=>v.instanceId===n?v.isMaximized?{...v,isMaximized:!1,position:v.previousPosition||{x:100,y:100},size:v.previousSize||{width:500,height:400},zIndex:d}:{...v,isMaximized:!0,isMinimized:!1,previousPosition:v.position,previousSize:v.size,position:{x:0,y:0},size:{width:"100vw",height:"100vh"},zIndex:d}:v))};r.useEffect(()=>{if(!y.isOpen)return;const n=v=>{V.current&&V.current.contains(v.target)||m(G=>({...G,isOpen:!1}))},d=()=>{m(v=>({...v,isOpen:!1}))},p=v=>{v.key==="Escape"&&m(G=>({...G,isOpen:!1}))};return window.addEventListener("mousedown",n),window.addEventListener("keydown",p),window.addEventListener("resize",d),()=>{window.removeEventListener("mousedown",n),window.removeEventListener("keydown",p),window.removeEventListener("resize",d)}},[y.isOpen]),r.useEffect(()=>{if(!y.isOpen)return;const d=requestAnimationFrame(()=>{const p=V.current;if(!p)return;const v=p.getBoundingClientRect(),G=8,re=Math.max(G,window.innerWidth-v.width-G),ye=Math.max(G,window.innerHeight-v.height-G),ve=Math.min(Math.max(y.x,G),re),Oe=Math.min(Math.max(y.y,G),ye);(ve!==y.x||Oe!==y.y)&&m(Re=>({...Re,x:ve,y:Oe}))});return()=>cancelAnimationFrame(d)},[y.isOpen,y.x,y.y]),r.useEffect(()=>{const n=()=>{ae(!0)};return window.addEventListener("storage-quota-exceeded",n),()=>window.removeEventListener("storage-quota-exceeded",n)},[]),r.useEffect(()=>{const n=()=>{h(d=>d.map(xe))};return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[h]),r.useEffect(()=>{h(n=>n.map(xe))},[i]),r.useEffect(()=>{const n=()=>{se(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",n),()=>document.removeEventListener("fullscreenchange",n)},[]);const Ye=async()=>{try{document.fullscreenElement?await document.exitFullscreen():await document.documentElement.requestFullscreen()}catch(n){console.warn("No se pudo cambiar a pantalla completa.",n)}},je=n=>{ee(n),X(!0),m(d=>({...d,isOpen:!1}))},Ve=()=>{ee("theme"),X(!0),j(n=>n+1)},f=n=>{J(n),B(d=>!d)},D=n=>n instanceof HTMLElement?n.isContentEditable?!0:!!n.closest('input, textarea, select, [contenteditable="true"]'):!1,L=()=>{const n=window.getSelection?.();return!!(n&&!n.isCollapsed&&n.toString().trim())},q=(n,d,p=!1)=>{!p&&D(n.target)||!p&&L()||(n.preventDefault(),m({isOpen:!0,x:n.clientX,y:n.clientY,widgetId:d??null,windowInstanceId:null}))},H=(n,d)=>{n.preventDefault();const p=g.activeWidgets.find(v=>v.instanceId===d)?.widgetId??null;m({isOpen:!0,x:n.clientX,y:n.clientY,widgetId:p,windowInstanceId:d})},ue=(n,d,p)=>{n.preventDefault(),n.stopPropagation(),m({isOpen:!0,x:n.clientX,y:n.clientY,widgetId:d,windowInstanceId:p})},b=()=>{h([]),m(n=>({...n,isOpen:!1}))},[C,z]=r.useState(new Date),[A,R]=r.useState({usage:null,quota:null}),[ne,_e]=r.useState({width:window.screen.width,height:window.screen.height}),[me,le]=r.useState({width:window.innerWidth,height:window.innerHeight}),he=r.useRef(null),[be,We]=r.useState(null),Xe=new Intl.DateTimeFormat(u.language,{year:"numeric",month:"short",day:"numeric"}).format(C),jt=new Intl.DateTimeFormat(u.language,{hour:"2-digit",minute:"2-digit"}).format(C);r.useEffect(()=>{const n=window.setInterval(()=>z(new Date),1e3);return()=>window.clearInterval(n)},[]),r.useEffect(()=>{if(!E){We(null);return}const n=()=>{const p=he.current;if(!p)return;const v=p.getBoundingClientRect();We(v.bottom)},d=window.requestAnimationFrame(n);return window.addEventListener("resize",n),()=>{window.cancelAnimationFrame(d),window.removeEventListener("resize",n)}},[E,Xe,jt,u.language]),r.useEffect(()=>{const n=async()=>{if(!navigator.storage?.estimate){R({usage:null,quota:null});return}const v=await navigator.storage.estimate();R({usage:typeof v.usage=="number"?v.usage:null,quota:typeof v.quota=="number"?v.quota:null})};n();const d=window.setInterval(n,3e4),p=()=>n();return window.addEventListener("storage-usage-changed",p),()=>{window.clearInterval(d),window.removeEventListener("storage-usage-changed",p)}},[]),r.useEffect(()=>{const n=()=>{_e({width:window.screen.width,height:window.screen.height}),le({width:window.innerWidth,height:window.innerHeight})};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]);const dt=(n,d=2)=>{if(n==null||!Number.isFinite(n))return l("system_stats.not_available");if(n<1024)return`${n} B`;const p=n/1024;if(p<1024)return`${p.toFixed(1)} KB`;const v=p/1024;return v<1024?`${v.toFixed(1)} MB`:`${(v/1024).toFixed(d)} GB`},vt=n=>n==null||!Number.isFinite(n)?null:(n/1024**3).toFixed(2),kt=g.activeWidgets.length>0,st=A.usage,Qe=A.quota,Ct=st!=null&&Qe!=null?Math.max(0,Qe-st):null,Nt=navigator,St=typeof Nt.deviceMemory=="number"?Nt.deviceMemory:null,It=typeof navigator.hardwareConcurrency=="number"?navigator.hardwareConcurrency:null,xs=vt(Qe),ws=vt(Ct),zt=st!=null&&Qe!=null,_s=zt&&xs!==ws,Le=[],Me=y.widgetId??(y.windowInstanceId?g.activeWidgets.find(n=>n.instanceId===y.windowInstanceId)?.widgetId:null),He=Me?g.pinnedWidgets.includes(Me):!1,Ke=y.windowInstanceId?g.activeWidgets.find(n=>n.instanceId===y.windowInstanceId)??null:null,Et=!!Me,ys=!!y.windowInstanceId||kt;return zt&&(Le.push({label:l("system_stats.storage_used"),value:`${dt(st,2)} / ${dt(Qe,2)}`}),_s&&Le.push({label:l("system_stats.storage_free"),value:dt(Ct,2)})),St!=null&&Le.push({label:l("system_stats.memory"),value:l("system_stats.memory_value",{value:St})}),It!=null&&Le.push({label:l("system_stats.cpu"),value:l("system_stats.cpu_value",{value:It})}),Le.push({label:l("system_stats.screen"),value:l("system_stats.screen_value",{width:ne.width,height:ne.height})}),Le.push({label:l("system_stats.window"),value:l("system_stats.window_value",{width:me.width,height:me.height})}),e.jsxs("div",{className:"w-screen h-screen overflow-hidden",onContextMenu:n=>q(n),children:[e.jsx("button",{onClick:Ye,onContextMenu:n=>q(n,void 0,!0),className:"fixed top-4 left-4 z-[2] p-2 rounded-full text-white/80 bg-black/15 backdrop-blur-sm hover:bg-black/30 hover:text-white transition-colors",title:l(Ne?"desktop.fullscreen_exit":"desktop.fullscreen_enter"),"aria-label":l(Ne?"desktop.fullscreen_exit":"desktop.fullscreen_enter"),children:Ne?e.jsx(nt,{size:18}):e.jsx(Dt,{size:18})}),E&&e.jsxs("div",{ref:he,className:"fixed top-4 right-4 z-[1] pointer-events-none select-none text-white bg-black/45 backdrop-blur-md rounded-2xl px-6 py-5 shadow-lg",children:[e.jsx("div",{className:"text-lg opacity-90",children:Xe}),e.jsx("div",{className:"text-4xl font-semibold leading-tight",children:jt})]}),_&&Le.length>0&&e.jsx("div",{className:"fixed right-4 z-[1] pointer-events-none select-none text-white bg-black/45 backdrop-blur-md rounded-2xl px-5 py-4 shadow-lg min-w-[220px]",style:{top:E&&be!=null?`${Math.round(be+5)}px`:"1rem"},children:e.jsx("div",{className:"space-y-1 text-sm",children:Le.map(n=>e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{className:"text-white/70",children:n.label}),e.jsx("span",{className:"text-white",children:n.value})]},n.label))})}),g.activeWidgets.map(n=>{const d=Se[n.widgetId];if(!d)return null;const p=d.component,v=g.pinnedWidgets.includes(n.widgetId),G=n.instanceId===K;return e.jsx(to,{id:n.instanceId,title:l(d.title),icon:d.icon,position:n.position,size:n.size,zIndex:n.zIndex,isMinimized:n.isMinimized,isMaximized:n.isMaximized,onToggleMinimize:()=>Be(n.instanceId),onToggleMaximize:()=>we(n.instanceId),onClose:()=>ge(n.instanceId),onFocus:()=>Ae(n.instanceId),onDragStop:(re,ye)=>{h(ve=>ve.map(Oe=>Oe.instanceId===n.instanceId?{...Oe,position:{x:ye.x,y:ye.y}}:Oe))},onResizeStop:(re,ye,ve,Oe,Re)=>{const qe=Number.parseFloat(ve.style.width),Fe=Number.parseFloat(ve.style.height);h(Pe=>Pe.map(ke=>ke.instanceId===n.instanceId?{...ke,size:{width:Number.isFinite(qe)?qe:ke.size.width,height:Number.isFinite(Fe)?Fe:ke.size.height},position:Re}:ke))},onOpenContextMenu:re=>ue(re,n.widgetId,n.instanceId),isPinned:v,isActive:G,onTogglePin:()=>{o(re=>re.includes(n.widgetId)?re.filter(ye=>ye!==n.widgetId):[...re,n.widgetId])},pinLabel:l("toolbar.add_widget"),unpinLabel:l("toolbar.remove_widget"),children:e.jsx(r.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:l("loading")}),children:e.jsx(p,{})})},n.instanceId)}),oe&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 h-2 z-[10000]",onMouseEnter:()=>De(!0)}),e.jsx(so,{pinnedWidgets:g.pinnedWidgets,onWidgetClick:Ee,onWidgetsClick:()=>je("widgets"),onOpenContextMenu:(n,d,p)=>q(n,d,p),onReorderPinned:n=>o(n),openWidgets:g.activeWidgets,onTaskClick:Ue,onTaskContextMenu:H,isHidden:oe,isPeeking:Ce,onMouseLeave:()=>{oe&&De(!1)},startButtonRef:S}),e.jsxs("button",{ref:S,onClick:n=>f(n.currentTarget.getBoundingClientRect()),onContextMenu:n=>q(n,void 0,!0),className:`fixed bottom-4 left-4 z-[10001] flex items-center gap-2 px-5 py-2.5 rounded-full shadow-lg border border-black/10 backdrop-blur-md transition ${W?"bg-accent text-text-dark":"bg-white/90 text-text-dark hover:bg-white"}`,title:l("toolbar.start"),"aria-label":l("toolbar.start"),children:[e.jsx("img",{src:$("escritorio-digital.png"),alt:l("toolbar.start"),width:"24",height:"24"}),e.jsx("span",{className:"text-sm font-semibold",children:l("toolbar.start")})]}),e.jsx(Nr,{isOpen:W,onClose:()=>B(!1),onAddWidget:Ee,onOpenSettingsTab:je,onOpenThemeModal:Ve,onOpenAbout:()=>ie(!0),onOpenCredits:()=>Q(!0),onRemoveFavorite:n=>o(d=>d.filter(p=>p!==n)),onReorderFavorites:n=>o(n),onClearFavorites:()=>o([]),onAddFavorite:n=>o(d=>d.includes(n)?d:[...d,n]),pinnedWidgets:g.pinnedWidgets,anchorRect:U,anchorRef:S}),e.jsx(Cr,{isOpen:M,onClose:()=>ie(!1)}),e.jsx(vr,{isOpen:ce,onClose:()=>X(!1),initialTab:Z,themeModalRequestId:k,pinnedWidgets:g.pinnedWidgets,setPinnedWidgets:o,profiles:t,setProfiles:s,activeProfileName:i,setActiveProfileName:c,profileOrder:x,setProfileOrder:w}),e.jsx(kr,{isOpen:de,onClose:()=>Q(!1)}),e.jsx(Sr,{profiles:t,activeProfileName:i,setActiveProfileName:c,setProfiles:s,onManageProfiles:()=>je("profiles"),onOpenContextMenu:n=>q(n,void 0,!0),profileOrder:x}),te&&e.jsxs("div",{className:"fixed top-4 right-4 z-[10002] max-w-sm bg-white/95 backdrop-blur-md border border-amber-200 shadow-xl rounded-lg p-4 text-sm text-text-dark",children:[e.jsx("p",{className:"font-semibold text-amber-700",children:l("storage_warning.title")}),e.jsx("p",{className:"mt-1 text-gray-700",children:l("storage_warning.body")}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 rounded-md bg-amber-500 text-white hover:bg-amber-600 transition",onClick:()=>je("general"),children:l("storage_warning.open_settings")}),e.jsx("button",{className:"px-3 py-1.5 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100 transition",onClick:()=>ae(!1),children:l("storage_warning.dismiss")})]})]}),y.isOpen&&e.jsx("div",{ref:V,className:"fixed z-[10000] min-w-[220px] bg-white/95 backdrop-blur-md rounded-lg shadow-xl border border-gray-200 py-2 text-sm text-text-dark",style:{left:y.x,top:y.y},children:y.windowInstanceId&&Ke?e.jsxs(e.Fragment,{children:[Et&&e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{Me&&(o(He?n=>n.filter(d=>d!==Me):n=>n.includes(Me)?n:[...n,Me]),m(n=>({...n,isOpen:!1,widgetId:null,windowInstanceId:null})))},children:[He?e.jsx(ft,{size:16}):e.jsx(pt,{size:16}),l(He?"toolbar.remove_widget":"toolbar.add_widget")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{Be(Ke.instanceId),m(n=>({...n,isOpen:!1,windowInstanceId:null}))},children:[e.jsx(nt,{size:16}),l("context_menu.minimize_window")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{we(Ke.instanceId),m(n=>({...n,isOpen:!1,windowInstanceId:null}))},children:[Ke.isMaximized?e.jsx(nt,{size:16}):e.jsx(Dt,{size:16}),Ke.isMaximized?l("context_menu.restore_window"):l("context_menu.maximize_window")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{ge(Ke.instanceId),m(n=>({...n,isOpen:!1,windowInstanceId:null}))},children:[e.jsx($e,{size:16}),l("context_menu.close_window")]})]}):e.jsxs(e.Fragment,{children:[Et&&e.jsx(e.Fragment,{children:e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{Me&&(o(He?n=>n.filter(d=>d!==Me):n=>n.includes(Me)?n:[...n,Me]),m(n=>({...n,isOpen:!1,widgetId:null,windowInstanceId:null})))},children:[He?e.jsx(ft,{size:16}):e.jsx(pt,{size:16}),l(He?"toolbar.remove_widget":"toolbar.add_widget")]})}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>je("widgets"),children:[e.jsx(Js,{size:16}),l("context_menu.new_widget")]}),ys&&e.jsx("div",{className:"my-1 border-t border-gray-200"}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>je("profiles"),children:[e.jsx(ct,{size:16}),l("context_menu.manage_profiles")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>je("general"),children:[e.jsx(xt,{size:16}),l("context_menu.settings")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>je("theme"),children:[e.jsx(Qt,{size:16}),l("context_menu.change_background")]}),e.jsx("div",{className:"my-1 border-t border-gray-200"}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center justify-between gap-3",onClick:()=>{Ie(!oe),m(n=>({...n,isOpen:!1}))},children:[e.jsx("span",{children:l("context_menu.show_toolbar")}),e.jsx("span",{className:`h-4 w-4 rounded border ${oe?"border-gray-400":"bg-accent border-accent"}`})]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center justify-between gap-3",onClick:()=>{I(),m(n=>({...n,isOpen:!1}))},children:[e.jsx("span",{children:l("context_menu.show_datetime")}),e.jsx("span",{className:`h-4 w-4 rounded border ${E?"bg-accent border-accent":"border-gray-400"}`})]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center justify-between gap-3",onClick:()=>{a(),m(n=>({...n,isOpen:!1}))},children:[e.jsx("span",{children:l("context_menu.show_system_stats")}),e.jsx("span",{className:`h-4 w-4 rounded border ${_?"bg-accent border-accent":"border-gray-400"}`})]}),kt&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"my-1 border-t border-gray-200"}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{Te(),m(n=>({...n,isOpen:!1}))},children:[e.jsx(nt,{size:16}),l("context_menu.minimize_windows")]}),y.windowInstanceId&&e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{ge(y.windowInstanceId),m(n=>({...n,isOpen:!1,windowInstanceId:null}))},children:[e.jsx($e,{size:16}),l("context_menu.close_window")]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:b,children:[e.jsx($e,{size:16}),l("context_menu.reset_layout")]})]})]})})]})};function Gt(){const[t,s]=et("desktop-profiles",{"Escritorio Principal":{theme:Ze,activeWidgets:[],pinnedWidgets:["work-list","timer","file-opener","vce-community"],vceFavorites:[]}}),[i,c]=et("profile-order",[]),[x,w]=et("active-profile-name","Escritorio Principal");r.useEffect(()=>{const o=I=>{const a=I.detail;if(!a||!a.profileName||!a.favorites)return;const N=a.profileName,P=a.favorites;s(O=>{const K=O[N];return K?{...O,[N]:{...K,vceFavorites:P}}:O})};return window.addEventListener("vce-favorites-update",o),()=>window.removeEventListener("vce-favorites-update",o)},[s]);const l=t[x]||Object.values(t)[0],u=l.theme||Ze,g=o=>{const I=l.theme,a=typeof o=="function"?o(I):o,N={...l,theme:a};s(P=>({...P,[x]:N}))},E=o=>{g(I=>({...I,"--wallpaper":o}))},_=()=>{g(Ze)};r.useEffect(()=>{document.body.style.backgroundImage=u["--wallpaper"],document.body.classList.toggle("high-contrast",!!u.highContrast);const o=document.documentElement;for(const[I,a]of Object.entries(u))I.startsWith("--")&&I!=="--wallpaper"&&o.style.setProperty(I,a)},[u]),r.useEffect(()=>{const o=u["--wallpaper"];if(!o)return;const I=o.toLowerCase(),a=I.startsWith("url(data:")||I.startsWith("url(http");I==="none"||a||er(o)||g(P=>({...P,"--wallpaper":gs}))},[u["--wallpaper"],g]),r.useEffect(()=>{window.dispatchEvent(new CustomEvent("active-profile-change",{detail:{name:x}}))},[x]),r.useEffect(()=>{window.dispatchEvent(new Event("profiles-updated"))},[t]);const h={theme:u,setTheme:g,setWallpaper:E,resetTheme:_,defaultTheme:Ze};return e.jsx(sr,{value:h,children:e.jsx(Ir,{profiles:t,setProfiles:s,activeProfileName:x,setActiveProfileName:w,profileOrder:i,setProfileOrder:c})})}const zr="/";it.use(rn).use(an).use(Zs).init({fallbackLng:"es",supportedLngs:["es","ca","eu","gl","pt","fr","it","de","en"],debug:!1,initImmediate:!1,ns:"translation",defaultNS:"translation",backend:{loadPath:`${zr}locales/{{lng}}/{{ns}}.json`,requestOptions:{cache:"no-cache"}},interpolation:{escapeValue:!1},detection:{order:["querystring","cookie","localStorage","navigator","htmlTag"],caches:["localStorage","cookie"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t.startsWith("ca")?"ca":t.startsWith("gl")?"gl":t.startsWith("eu")?"eu":t.startsWith("es")?"es":t.startsWith("pt")?"pt":t.startsWith("it")?"it":t.startsWith("de")?"de":t.startsWith("en")?"en":t.startsWith("fr")?"fr":t},react:{useSuspense:!1}});const Er=new Promise(t=>{const s=()=>{it.loadNamespaces(["translation"]).then(()=>t())};it.isInitialized?s():it.on("initialized",s)}),Wr=()=>{const{t}=T();return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:t("loading")})},Ut=en.createRoot(document.getElementById("root"));Er.then(()=>{Ut.render(e.jsx(bt.StrictMode,{children:e.jsx(r.Suspense,{fallback:e.jsx(Wr,{}),children:e.jsx(Gt,{})})}))}).catch(t=>{console.error("i18n init error:",t),Ut.render(e.jsx(bt.StrictMode,{children:e.jsx(Gt,{})}))});export{$ as A,mi as B,bi as C,xi as D,yi as E,vi as F,Ni as G,zi as H,Wi as I,Di as J,Li as K,Pi as L,Ri as M,Hi as N,qi as O,Ui as P,Qi as Q,Zi as R,un as a,hn as b,fn as c,xn as d,_n as e,jn as f,kn as g,Nn as h,zn as i,Wn as j,On as k,Ln as l,Pn as m,An as n,Bn as o,Hn as p,Gn as q,Xn as r,Zn as s,ti as t,et as u,ni as v,dn as w,ri as x,li as y,gi as z};
