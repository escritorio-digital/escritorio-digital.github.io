import{u as j,e as v,r as c,j as e,W as y,F as p,O as C,h as k}from"./index-CmQIKd-y.js";import{ah as T}from"./index-CmQIKd-y.js";import{r as N}from"./openDialog-H-OCpcqq.js";import{C as _,a as I}from"./chevron-right-BfHMy29C.js";const S=()=>{const{t:o}=j(),[t,w]=v("image-carousel-images",[]),[a,l]=c.useState(0),h=r=>{const s=[];r.forEach(n=>{if(!n.type.startsWith("image/"))return;const i=new Promise((f,b)=>{const m=new FileReader;m.onload=u=>f(u.target?.result),m.onerror=u=>b(u),m.readAsDataURL(n)});s.push(i)}),Promise.all(s).then(n=>{w(n),l(0)}).catch(n=>{console.error("Error loading images:",n)})},x=async()=>{const r=await N({accept:"image/*",multiple:!0});if(!r)return;if(r.source==="local"){h(r.files);return}const s=[];for(const n of r.entryIds){const i=await k(n);i?.blob&&(i.mime&&!i.mime.startsWith("image/")||s.push(new File([i.blob],i.name,{type:i.mime||i.blob.type})))}s.length>0&&h(s)},d=c.useCallback(()=>{if(t.length<=1)return;const s=a===0?t.length-1:a-1;l(s)},[a,t.length]),g=c.useCallback(()=>{if(t.length<=1)return;const s=a===t.length-1?0:a+1;l(s)},[a,t.length]);return c.useEffect(()=>{const r=s=>{if(t.length!==0)switch(s.key){case"ArrowLeft":s.preventDefault(),d();break;case"ArrowRight":s.preventDefault(),g();break}};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[t.length,d,g]),console.log("Current render state - images.length:",t.length,"currentIndex:",a),e.jsxs("div",{className:"image-carousel-widget",children:[e.jsx(y,{children:e.jsx("button",{type:"button",onClick:x,className:"image-carousel-toolbar-button",title:o("widgets.image_carousel.select_new_images"),children:e.jsx(p,{size:18})})}),t.length===0?e.jsxs("div",{className:"placeholder-view",children:[e.jsx(C,{size:64,className:"text-gray-400"}),e.jsx("p",{className:"mt-4 text-center",children:o("widgets.image_carousel.no_images")}),e.jsxs("button",{onClick:x,className:"upload-button",children:[e.jsx(p,{size:18}),o("widgets.image_carousel.select_images")]})]}):e.jsxs("div",{className:"carousel-view",children:[e.jsxs("div",{className:"carousel-image-container",children:[e.jsx("img",{src:t[a],alt:o("widgets.image_carousel.slide_alt",{number:a+1})}),e.jsxs("div",{style:{position:"absolute",top:"10px",left:"10px",background:"rgba(0,0,0,0.7)",color:"white",padding:"5px",borderRadius:"3px"},children:[a+1," / ",t.length,t.length===1&&e.jsx("div",{style:{fontSize:"12px",marginTop:"3px"},children:o("widgets.image_carousel.more_images_hint")})]})]}),t.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"carousel-arrow left-arrow",onClick:d,children:e.jsx(_,{size:32})}),e.jsx("button",{className:"carousel-arrow right-arrow",onClick:g,children:e.jsx(I,{size:32})})]}),t.length>1&&e.jsx("div",{className:"slide-indicators",children:t.map((r,s)=>e.jsx("div",{className:`indicator-dot ${a===s?"active":""}`,onClick:()=>l(s)},s))})]})]})};export{S as ImageCarouselWidget,T as widgetConfig};
