import{c as V,u as ie,r as n,j as t,W as oe,aM as I,aN as re}from"./index-rdPxbIB-.js";import{aO as be}from"./index-rdPxbIB-.js";import{P as ne}from"./papaparse.min-PZUSyfgP.js";import{C as ae}from"./chevron-down-BsRBaJyj.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],le=V("panel-left-close",ce);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]],ve=V("panel-left-open",de),ue="https://docs.google.com/spreadsheets/d/e/2PACX-1vSj_hltRI4Q0QolINWJVcKxCMMjfpdiCkKzSdgp9d8RlGTdUU1UIKvaj-TBSkq0JQGneDhfUkSQuFzy/pub?output=csv",me="https://vibe-coding-educativo.github.io/",G="active-profile-name",D="active-profile-change",q="profiles-updated",he="Escritorio Principal",ge=new Set(["google.com","www.google.com","g.co","goo.gl","goo.gle","forms.gle","docs.google.com","drive.google.com","sites.google.com","gemini.google.com","app.goo.gl","ai.studio","www.ai.studio","aistudio.google.com","eaciweb.net","www.eaciweb.net","ja.cat","www.ja.cat","edumind.es","www.edumind.es","claude.ai","www.claude.ai","withgoogle.com","googleusercontent.com","googleapis.com"]),y=()=>{const s=window.localStorage.getItem(G);if(!s)return he;try{const c=JSON.parse(s);return typeof c=="string"&&c.trim()?c:s}catch{return s}},P=s=>{const c=window.localStorage.getItem("desktop-profiles");if(!c)return[];try{return JSON.parse(c)?.[s]?.vceFavorites??[]}catch{return[]}},xe=()=>{const{t:s}=ie(),[c,F]=n.useState([]),[E,K]=n.useState(""),[p,B]=n.useState(""),[x,$]=n.useState(""),[a,T]=n.useState(null),[Q,R]=n.useState(new Set),[u,U]=n.useState(!0),[f,M]=n.useState(!1),[J,j]=n.useState(!1),[w,H]=n.useState(!1),C=n.useRef(null),[m,O]=n.useState(()=>y()),[h,_]=n.useState(()=>P(y()));n.useEffect(()=>{let e=!0;return(async()=>{U(!0),M(!1);try{const i=await fetch(ue,{cache:"no-store"});if(!i.ok)throw new Error("CSV fetch failed");const l=await i.text(),r=ne.parse(l,{header:!0,skipEmptyLines:!0}),g="¿QUIERES ELIMINAR UN REGISTRO?\\nMarca la casilla y escribe más abajo la URL que tiene tu aplicación. En el resto de campos, escribe cualquier cosa y envía el formulario.\\nIMPORTANTE: Si solo quieres rectificar un registro, no marques esta casilla, haz lo que se  indica a continuación",N=d=>(d||"").split(",").map(A=>A.trim()).filter(Boolean),se=(r.data||[]).map(d=>({title:(d["Título de la aplicación"]||"").trim(),author:(d["Tu nombre (Autor/a de la aplicación)"]||"").trim(),url:(d["Enlace (URL) a la aplicación"]||"").trim(),levels:N(d["Nivel o niveles educativos"]),areas:N(d["Área o áreas de conocimiento"]),description:(d["Descripción breve"]||"").trim(),deleteFlag:(d[g]||"").trim()})).filter(d=>d.title&&d.url&&!d.deleteFlag).map(({deleteFlag:d,...A})=>A);e&&F(se)}catch{e&&M(!0)}finally{e&&U(!1)}})(),()=>{e=!1}},[]),n.useEffect(()=>{const e=l=>{const r=l.detail;O(r?.name||y())},o=l=>{l.key===G&&O(y())},i=()=>{_(P(m))};return window.addEventListener(D,e),window.addEventListener("storage",o),window.addEventListener(q,i),()=>{window.removeEventListener(D,e),window.removeEventListener("storage",o),window.removeEventListener(q,i)}},[m]),n.useEffect(()=>{_(P(m))},[m]);const Y=n.useMemo(()=>{const e=new Set;return c.forEach(o=>o.levels.forEach(i=>e.add(i))),Array.from(e).sort((o,i)=>o.localeCompare(i))},[c]),X=n.useMemo(()=>{const e=new Set;return c.forEach(o=>o.areas.forEach(i=>e.add(i))),Array.from(e).sort((o,i)=>o.localeCompare(i))},[c]),k=n.useMemo(()=>{const e=E.trim().toLowerCase();return[...c].reverse().filter(i=>p&&!i.levels.includes(p)||x&&!i.areas.includes(x)?!1:e?i.title.toLowerCase().includes(e)||i.author.toLowerCase().includes(e)||i.description.toLowerCase().includes(e):!0)},[c,E,p,x]),Z=e=>{try{const{hostname:o}=new URL(e),i=o.toLowerCase();return ge.has(i)||i.endsWith(".google.com")||i.endsWith(".googleusercontent.com")||i.endsWith(".googleapis.com")||i.endsWith(".withgoogle.com")||i.endsWith(".ai.studio")||i.endsWith(".eaciweb.net")||i.endsWith(".ja.cat")||i.endsWith(".edumind.es")||i.endsWith(".claude.ai")}catch{return!1}},v=n.useMemo(()=>new Set(h),[h]),S=n.useMemo(()=>{const e=new Map(c.map(o=>[o.url,o]));return h.map(o=>e.get(o)).filter(o=>!!o)},[c,h]),ee=n.useMemo(()=>k.filter(e=>!v.has(e.url)),[k,v]);n.useEffect(()=>{a&&!c.some(e=>e.url===a.url)&&T(null)},[a,c]),n.useEffect(()=>{j(!1)},[a?.url]);const L=e=>{_(o=>{const i=o.includes(e)?o.filter(l=>l!==e):[...o,e];return window.dispatchEvent(new CustomEvent("vce-favorites-update",{detail:{profileName:m,favorites:i}})),i})},W=(e,o)=>{_(i=>{const l=i.indexOf(e);if(l===-1)return i;const r=o==="up"?l-1:l+1;if(r<0||r>=i.length)return i;const g=[...i],[N]=g.splice(l,1);return g.splice(r,0,N),window.dispatchEvent(new CustomEvent("vce-favorites-update",{detail:{profileName:m,favorites:g}})),g})},z=e=>{R(o=>{const i=new Set(o);return i.has(e)?i.delete(e):i.add(e),i})},b=e=>{T(e),R(new Set)},te=()=>{if(j(!1),!!C.current)try{const e=C.current.contentWindow?.location.href;(!e||e==="about:blank")&&j(!0)}catch{}};return t.jsxs("div",{className:"vce-widget",children:[t.jsx(oe,{children:t.jsxs("div",{className:"vce-toolbar",children:[t.jsxs("div",{className:"vce-header",children:[t.jsxs("div",{children:[t.jsx("div",{className:"vce-title",children:s("widgets.vce.title")}),t.jsx("div",{className:"vce-subtitle",children:s("widgets.vce.subtitle")})]}),t.jsxs("div",{className:"vce-actions",children:[t.jsx("button",{type:"button",className:"vce-toggle-list",onClick:()=>H(e=>!e),title:s(w?"widgets.vce.expand_list":"widgets.vce.collapse_list"),"aria-label":s(w?"widgets.vce.expand_list":"widgets.vce.collapse_list"),children:w?t.jsx(ve,{size:16}):t.jsx(le,{size:16})}),t.jsx("button",{type:"button",className:"vce-open",onClick:()=>window.open(me,"_blank","noopener,noreferrer"),children:s("widgets.vce.community_link")}),t.jsx("button",{type:"button",className:"vce-open",onClick:()=>{a&&window.open(a.url,"_blank","noopener,noreferrer")},disabled:!a,children:s("widgets.vce.open_new_tab")}),a&&t.jsx("button",{type:"button",className:"vce-fav-toggle",onClick:()=>L(a.url),title:v.has(a.url)?s("widgets.vce.remove_favorite"):s("widgets.vce.add_favorite"),"aria-label":v.has(a.url)?s("widgets.vce.remove_favorite"):s("widgets.vce.add_favorite"),children:t.jsx(I,{size:16,fill:v.has(a.url)?"currentColor":"none"})})]})]}),t.jsxs("div",{className:"vce-filters",children:[t.jsx("input",{type:"text",className:"vce-search",value:E,onChange:e=>K(e.target.value),placeholder:s("widgets.vce.search_placeholder")}),t.jsxs("select",{className:"vce-select",value:p,onChange:e=>B(e.target.value),children:[t.jsx("option",{value:"",children:s("widgets.vce.filter_level_all")}),Y.map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsxs("select",{className:"vce-select",value:x,onChange:e=>$(e.target.value),children:[t.jsx("option",{value:"",children:s("widgets.vce.filter_area_all")}),X.map(e=>t.jsx("option",{value:e,children:e},e))]})]})]})}),t.jsxs("div",{className:`vce-body${w?" is-collapsed":""}`,children:[t.jsxs("div",{className:`vce-list${w?" is-collapsed":""}`,children:[u&&t.jsx("div",{className:"vce-empty",children:s("widgets.vce.loading")}),f&&t.jsx("div",{className:"vce-empty",children:s("widgets.vce.load_error")}),!u&&!f&&k.length===0&&S.length===0&&t.jsx("div",{className:"vce-empty",children:s("widgets.vce.no_results")}),!u&&!f&&S.length>0&&t.jsx("div",{className:"vce-section",children:t.jsx("div",{className:"vce-section-title",children:s("widgets.vce.favorites_title")})}),!u&&!f&&S.map(e=>{const o=h.indexOf(e.url),i=o<=0,l=o===h.length-1;return t.jsx("div",{className:`vce-item vce-item-favorite${a?.url===e.url?" vce-item-active":""}`,onClick:()=>b(e),role:"button",tabIndex:0,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),b(e))},children:t.jsxs("div",{className:"vce-item-header",children:[t.jsx("div",{className:"vce-item-title",children:e.title}),t.jsxs("div",{className:"vce-fav-actions",children:[t.jsx("button",{type:"button",className:"vce-fav-reorder",disabled:i,onClick:r=>{r.stopPropagation(),W(e.url,"up")},title:s("widgets.vce.move_up"),"aria-label":s("widgets.vce.move_up"),children:t.jsx(re,{size:14})}),t.jsx("button",{type:"button",className:"vce-fav-reorder",disabled:l,onClick:r=>{r.stopPropagation(),W(e.url,"down")},title:s("widgets.vce.move_down"),"aria-label":s("widgets.vce.move_down"),children:t.jsx(ae,{size:14})}),t.jsx("button",{type:"button",className:"vce-fav-toggle",onClick:r=>{r.stopPropagation(),L(e.url)},title:v.has(e.url)?s("widgets.vce.remove_favorite"):s("widgets.vce.add_favorite"),"aria-label":v.has(e.url)?s("widgets.vce.remove_favorite"):s("widgets.vce.add_favorite"),children:t.jsx(I,{size:16,fill:v.has(e.url)?"currentColor":"none"})})]})]})},e.url)}),!u&&!f&&ee.map(e=>{const o=Q.has(e.url),i=!!e.description,l=i&&e.description.length>100&&!o;return t.jsxs("div",{className:`vce-item${a?.url===e.url?" vce-item-active":""}`,onClick:()=>b(e),role:"button",tabIndex:0,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),b(e))},children:[t.jsxs("div",{className:"vce-item-header",children:[t.jsx("div",{className:"vce-item-title",children:e.title}),t.jsx("button",{type:"button",className:"vce-fav-toggle",onClick:r=>{r.stopPropagation(),L(e.url)},title:v.has(e.url)?s("widgets.vce.remove_favorite"):s("widgets.vce.add_favorite"),"aria-label":v.has(e.url)?s("widgets.vce.remove_favorite"):s("widgets.vce.add_favorite"),children:t.jsx(I,{size:16,fill:"none"})})]}),t.jsx("div",{className:"vce-item-author",children:e.author}),t.jsxs("div",{className:"vce-item-desc",children:[!i&&s("widgets.vce.no_description"),i&&l&&t.jsxs(t.Fragment,{children:[`${e.description.slice(0,100)} `,t.jsx("button",{type:"button",className:"vce-item-more",onClick:r=>{r.stopPropagation(),z(e.url)},children:s("widgets.vce.more")})]}),i&&!l&&t.jsxs(t.Fragment,{children:[e.description," ",e.description.length>100&&t.jsx("button",{type:"button",className:"vce-item-more",onClick:r=>{r.stopPropagation(),z(e.url)},children:s("widgets.vce.less")})]})]})]},e.url)})]}),t.jsx("div",{className:"vce-preview",children:a?J||Z(a.url)?t.jsxs("div",{className:"vce-empty",children:[t.jsx("div",{children:s("widgets.vce.iframe_blocked")}),t.jsx("button",{type:"button",className:"vce-open vce-open-inline",onClick:()=>window.open(a.url,"_blank","noopener,noreferrer"),children:s("widgets.vce.open_new_tab")})]}):t.jsx("iframe",{ref:C,title:a.title,src:a.url,className:"vce-iframe",loading:"lazy",onLoad:te,onError:()=>{j(!0)}},a.url):t.jsx("div",{className:"vce-empty",children:u?s("widgets.vce.loading"):t.jsxs("div",{className:"vce-intro",children:[t.jsx("div",{className:"vce-intro-title",children:s("widgets.vce.intro_title")}),t.jsxs("div",{className:"vce-intro-links",children:[t.jsx("a",{href:"https://t.me/vceduca",target:"_blank",rel:"noopener noreferrer",children:s("widgets.vce.intro_group_link")}),t.jsx("a",{href:"https://vibe-coding-educativo.github.io/",target:"_blank",rel:"noopener noreferrer",children:s("widgets.vce.intro_info_link")})]}),t.jsx("div",{className:"vce-intro-title",children:s("widgets.vce.intro_how_title")}),t.jsxs("ol",{className:"vce-intro-list",children:[t.jsx("li",{children:s("widgets.vce.intro_step1")}),t.jsx("li",{children:s("widgets.vce.intro_step2")}),t.jsx("li",{children:s("widgets.vce.intro_step3")}),t.jsx("li",{children:s("widgets.vce.intro_step4")}),t.jsx("li",{children:s("widgets.vce.intro_step5")})]})]})})})]})]})};export{xe as VceCommunityWidget,be as widgetConfig};
