import{c as b,u as B,r as i,j as e,W as O,I as Y}from"./index-C5_U1qcH.js";import{o as ie}from"./index-C5_U1qcH.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["rect",{width:"12",height:"12",x:"2",y:"10",rx:"2",ry:"2",key:"6agr2n"}],["path",{d:"m17.92 14 3.5-3.5a2.24 2.24 0 0 0 0-3l-5-4.92a2.24 2.24 0 0 0-3 0L10 6",key:"1o487t"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"M10 14h.01",key:"ssrbsk"}],["path",{d:"M15 6h.01",key:"cblpky"}],["path",{d:"M18 9h.01",key:"2061c0"}]],J=b("dices",G);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],Q=b("volume-2",K);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],Z=b("volume-x",U),te=()=>{const{t:r}=B(),[d,$]=i.useState(2),[m,A]=i.useState(6),[F,x]=i.useState([]),[_,M]=i.useState(0),[o,k]=i.useState(!1),[N,C]=i.useState(1500),[g,E]=i.useState(()=>{try{return localStorage.getItem("dice-sound-muted")==="true"}catch{return!1}}),c=i.useRef(null),z=i.useRef(null),[p,T]=i.useState(null),l=i.useRef(null);i.useEffect(()=>{c.current=new Audio("/sounds/dice-142528.mp3")},[]),i.useEffect(()=>{const t=z.current;if(!t)return;const n=()=>{const a=getComputedStyle(t),w=(parseFloat(a.paddingLeft)||0)+(parseFloat(a.paddingRight)||0),u=(parseFloat(a.paddingTop)||0)+(parseFloat(a.paddingBottom)||0),h=t.clientWidth-w,R=t.clientHeight-u;if(h<=0||R<=0)return;const S=16;let v=0;for(let f=1;f<=d;f+=1){const I=Math.ceil(d/f),P=(h-S*(f-1))/f,X=(R-S*(I-1))/I,D=Math.min(P,X);D>v&&(v=D)}const j=Math.max(56,Math.min(200,Math.floor(v))),H=Math.max(8,Math.floor(j*.18)),V=Math.max(18,Math.floor(j*.42));T({size:j,dot:H,flat:V})};n();const s=new ResizeObserver(n);return s.observe(t),()=>s.disconnect()},[d]),i.useEffect(()=>()=>{l.current&&(window.clearInterval(l.current),l.current=null)},[]);const y=()=>Math.floor(Math.random()*m)+1,q=()=>{if(o||!c.current)return;k(!0);let t=1500;c.current&&Number.isFinite(c.current.duration)&&c.current.duration>0&&(t=Math.round(c.current.duration*1e3)),C(t),g||(c.current.currentTime=0,c.current.play().catch(s=>{console.error("Error al reproducir el audio:",s)}));const n=Array.from({length:d},(s,a)=>({id:a,value:y(),isRolling:!0}));x(n),M(0),setTimeout(()=>{l.current&&(window.clearInterval(l.current),l.current=null);let s=0;const a=Array.from({length:d},(w,u)=>{const h=y();return s+=h,{id:u,value:h,isRolling:!1}});x(a),M(s),k(!1)},t),m!==6&&(l.current&&window.clearInterval(l.current),l.current=window.setInterval(()=>{x(s=>s.map(a=>({...a,value:y(),isRolling:!0})))},90))},L=t=>{if(o)return;const n=parseInt(t.target.value,10);n>0&&n<=10&&$(n)},W=({value:t,isRolling:n})=>{const s=a=>e.jsx("div",{className:`face face-${a}`,children:Array.from({length:a}).map((w,u)=>e.jsx("span",{className:"dot"},u))});return m!==6?e.jsx("div",{className:"die-flat",children:e.jsx("span",{children:t})}):e.jsx("div",{className:"die-scene",children:e.jsxs("div",{className:`die-3d ${n?"rolling":`show-${t}`}`,children:[s(1),s(2),s(3),s(4),s(5),s(6)]})})};return e.jsxs("div",{className:"dice-widget",children:[e.jsxs(O,{children:[e.jsxs("div",{className:"dice-toolbar-group",children:[e.jsxs("div",{className:"dice-selector",children:[e.jsx("label",{htmlFor:"num-dice-input",children:r("widgets.dice.num_dice_short")}),e.jsx("input",{id:"num-dice-input",type:"number",value:d,onChange:L,min:"1",max:"10",disabled:o})]}),e.jsxs("div",{className:"dice-selector",children:[e.jsx("label",{htmlFor:"num-faces-input",children:r("widgets.dice.num_faces_short")}),e.jsx("select",{id:"num-faces-input",value:m,onChange:t=>{if(o)return;const n=parseInt(t.target.value,10);n>=2&&n<=20&&A(n)},disabled:o,children:Array.from({length:19},(t,n)=>{const s=n+2;return e.jsx("option",{value:s,children:s},s)})})]})]}),e.jsxs("button",{type:"button",className:"dice-toolbar-action",onClick:q,disabled:o,title:r(o?"widgets.dice.rolling":"widgets.dice.roll_dice"),"aria-label":r(o?"widgets.dice.rolling":"widgets.dice.roll_dice"),children:[e.jsx(J,{size:16}),e.jsx("span",{children:r(o?"widgets.dice.rolling":"widgets.dice.roll_dice")})]}),e.jsx("button",{type:"button",className:"dice-toolbar-button",onClick:()=>{E(t=>{const n=!t;try{localStorage.setItem("dice-sound-muted",n?"true":"false")}catch{}return n})},title:r(g?"widgets.dice.sound_on":"widgets.dice.sound_off"),"aria-label":r(g?"widgets.dice.sound_on":"widgets.dice.sound_off"),children:g?e.jsx(Z,{size:16}):e.jsx(Q,{size:16})})]}),e.jsx("div",{ref:z,className:"dice-container",style:p?{"--die-size":`${p.size}px`,"--dot-size":`${p.dot}px`,"--flat-font-size":`${p.flat}px`,"--roll-duration":`${N}ms`}:{"--roll-duration":`${N}ms`},children:F.map(t=>e.jsx(W,{value:t.value,isRolling:t.isRolling},t.id))}),e.jsxs("div",{className:`total ${!o&&_>0?"":"total--hidden"}`,children:[r("widgets.dice.total")," ",e.jsx("span",{children:_})]}),e.jsx("a",{href:"https://pixabay.com/users/u_qpfzpydtro-29496424/?utm_source=link-attribution&utm_medium=referral",target:"_blank",rel:"noopener noreferrer",className:"attribution-button",title:"Sound Effect by u_qpfzpydtro from Pixabay",onClick:t=>t.stopPropagation(),children:e.jsx(Y,{size:12})})]})};export{te as DiceWidget,ie as widgetConfig};
