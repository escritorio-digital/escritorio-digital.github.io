import{u as b,a as v,r as c,j as e,p as y,a0 as p,g as C}from"./index-C8VyKYax.js";import{a1 as R}from"./index-C8VyKYax.js";import{r as k}from"./openDialog-H-OCpcqq.js";import{C as N,a as _}from"./chevron-right-sDMLDfrN.js";const F=()=>{const{t:o}=b(),[t,w]=v("image-carousel-images",[]),[r,l]=c.useState(0),h=a=>{const s=[];a.forEach(n=>{if(!n.type.startsWith("image/"))return;const i=new Promise((f,j)=>{const m=new FileReader;m.onload=u=>f(u.target?.result),m.onerror=u=>j(u),m.readAsDataURL(n)});s.push(i)}),Promise.all(s).then(n=>{w(n),l(0)}).catch(n=>{console.error("Error loading images:",n)})},x=async()=>{const a=await k({accept:"image/*",multiple:!0});if(!a)return;if(a.source==="local"){h(a.files);return}const s=[];for(const n of a.entryIds){const i=await C(n);i?.blob&&(i.mime&&!i.mime.startsWith("image/")||s.push(new File([i.blob],i.name,{type:i.mime||i.blob.type})))}s.length>0&&h(s)},g=c.useCallback(()=>{if(t.length<=1)return;const s=r===0?t.length-1:r-1;l(s)},[r,t.length]),d=c.useCallback(()=>{if(t.length<=1)return;const s=r===t.length-1?0:r+1;l(s)},[r,t.length]);return c.useEffect(()=>{const a=s=>{if(t.length!==0)switch(s.key){case"ArrowLeft":s.preventDefault(),g();break;case"ArrowRight":s.preventDefault(),d();break}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[t.length,g,d]),console.log("Current render state - images.length:",t.length,"currentIndex:",r),e.jsx("div",{className:"image-carousel-widget",children:t.length===0?e.jsxs("div",{className:"placeholder-view",children:[e.jsx(y,{size:64,className:"text-gray-400"}),e.jsx("p",{className:"mt-4 text-center",children:o("widgets.image_carousel.no_images")}),e.jsxs("button",{onClick:x,className:"upload-button",children:[e.jsx(p,{size:18}),o("widgets.image_carousel.select_images")]})]}):e.jsxs("div",{className:"carousel-view",children:[e.jsxs("div",{className:"carousel-image-container",children:[e.jsx("img",{src:t[r],alt:o("widgets.image_carousel.slide_alt",{number:r+1})}),e.jsxs("div",{style:{position:"absolute",top:"10px",left:"10px",background:"rgba(0,0,0,0.7)",color:"white",padding:"5px",borderRadius:"3px"},children:[r+1," / ",t.length,t.length===1&&e.jsx("div",{style:{fontSize:"12px",marginTop:"3px"},children:o("widgets.image_carousel.more_images_hint")})]})]}),t.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"carousel-arrow left-arrow",onClick:g,children:e.jsx(N,{size:32})}),e.jsx("button",{className:"carousel-arrow right-arrow",onClick:d,children:e.jsx(_,{size:32})})]}),t.length>1&&e.jsx("div",{className:"slide-indicators",children:t.map((a,s)=>e.jsx("div",{className:`indicator-dot ${r===s?"active":""}`,onClick:()=>l(s)},s))}),e.jsx("button",{onClick:x,className:"change-images-button",title:o("widgets.image_carousel.select_new_images"),children:e.jsx(p,{size:16})})]})})};export{F as ImageCarouselWidget,R as widgetConfig};
