import{c as _,u as k,r as u,j as l,b as M,g as N}from"./index-DVJj0eXH.js";import{ai as R}from"./index-DVJj0eXH.js";import{r as P}from"./openDialog-H-OCpcqq.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],$=_("shuffle",C),S=(a,i)=>{let p=0;const e=a.filter(c=>c!==i*i-1);for(let c=0;c<e.length-1;c++)for(let d=c+1;d<e.length;d++)e[c]>e[d]&&p++;if(i%2===1)return p%2===0;{const c=i-Math.floor(a.indexOf(i*i-1)/i);return(p+c)%2!==0}},A=()=>{const{t:a}=k(),[i,p]=u.useState(null),[e,c]=u.useState(3),[d,f]=u.useState([]),[h,m]=u.useState(!1),g=()=>{const s=e*e,o=Array.from({length:s},(n,r)=>r);let t;do t=[...o].sort(()=>Math.random()-.5);while(!S(t,e)||t.every((n,r)=>n===r));f(t),m(!1)};u.useEffect(()=>{i&&g()},[i,e]),u.useEffect(()=>{if(d.length===0)return;const s=d.every((o,t)=>o===t);m(s)},[d]);const z=s=>{const o=new FileReader;o.onload=t=>{p(t.target?.result)},o.readAsDataURL(s)},b=async()=>{const s=await P({accept:"image/*"});if(!s)return;if(s.source==="local"){const[r]=s.files;r&&z(r);return}const[o]=s.entryIds;if(!o)return;const t=await N(o);if(!t?.blob)return;const n=new File([t.blob],t.name,{type:t.mime||t.blob.type});z(n)},w=s=>{if(h)return;const o=d.indexOf(e*e-1);if(((n,r)=>{const y=Math.floor(n/e),v=n%e,x=Math.floor(r/e),j=r%e;return y===x&&Math.abs(v-j)===1||v===j&&Math.abs(y-x)===1})(s,o)){const n=[...d];[n[s],n[o]]=[n[o],n[s]],f(n)}};return i?l.jsxs("div",{className:"sliding-puzzle-widget",children:[l.jsxs("div",{className:"puzzle-board",style:{gridTemplateColumns:`repeat(${e}, 1fr)`},children:[d.map((s,o)=>{const t=s===e*e-1,n=s%e,r=Math.floor(s/e);return l.jsx("div",{className:`puzzle-piece ${t?"empty":""}`,onClick:()=>w(o),children:!t&&l.jsx("div",{className:"piece-image",style:{backgroundImage:`url(${i})`,backgroundSize:`${e*100}% ${e*100}%`,backgroundPosition:`${n*100/(e-1)}% ${r*100/(e-1)}%`}})},o)}),h&&l.jsx("div",{className:"solved-overlay",children:a("widgets.sliding_puzzle.solved_overlay")})]}),l.jsxs("div",{className:"puzzle-controls",children:[l.jsxs("label",{children:[a("widgets.sliding_puzzle.complexity_label"),l.jsxs("select",{value:e,onChange:s=>c(Number(s.target.value)),children:[l.jsx("option",{value:3,children:a("widgets.sliding_puzzle.difficulty.easy")}),l.jsx("option",{value:4,children:a("widgets.sliding_puzzle.difficulty.normal")}),l.jsx("option",{value:5,children:a("widgets.sliding_puzzle.difficulty.hard")})]})]}),l.jsxs("button",{onClick:g,children:[l.jsx($,{size:16})," ",a("widgets.sliding_puzzle.shuffle_button")]})]})]}):l.jsxs("div",{className:"puzzle-placeholder",children:[l.jsx(M,{size:48}),l.jsx("p",{children:a("widgets.sliding_puzzle.upload_prompt")}),l.jsx("button",{className:"puzzle-upload-button",onClick:b,children:a("widgets.sliding_puzzle.upload_prompt")})]})};export{A as SlidingPuzzleWidget,R as widgetConfig};
