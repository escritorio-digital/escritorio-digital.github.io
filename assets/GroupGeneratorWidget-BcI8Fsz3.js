import{u as X,r as i,j as e,b as Y,M as $}from"./index-BgqH8RSj.js";import{z as oe}from"./index-BgqH8RSj.js";import{E as Z}from"./expand-BDyu8Vqv.js";const se=()=>{const{t:o}=X(),[w,C]=i.useState(`Ana
Beatriz
Carlos
Daniela
Esteban
Fernanda
Gael
Hilda
IvÃ¡n
Julia`),[b,N]=i.useState("byCount"),[p,U]=i.useState(3),[l,z]=i.useState([]),[c,j]=i.useState(!1),[W,_]=i.useState(!1),M=i.useRef(null),S=i.useRef(null),R=i.useRef(null),k=i.useRef(null),G=i.useRef({titleSize:0,textSize:0,minCardWidth:0,containerHeight:0});i.useEffect(()=>{if(!c)return;const t=S.current,s=R.current,n=k.current;if(!t||!s||!n)return;let r=0;const a=()=>{if(!t||!s||!n)return;const h=getComputedStyle(t),V=parseFloat(h.paddingTop)||0,q=parseFloat(h.paddingBottom)||0,D=parseFloat(h.rowGap||h.gap)||0,m=Math.max(120,t.clientHeight-s.offsetHeight-V-q-D);n.style.height=`${m}px`;const H=n.clientWidth,J=Math.max(1,l.length),K=Math.min(J,Math.max(1,Math.floor(H/320))),x=Math.max(240,Math.floor(H/K)-16),T=16,Q=Math.min(40,Math.max(20,Math.floor(m/5)));let E=T,L=Q,d=T;for(let P=0;P<12;P+=1){const u=Math.floor((E+L)/2);t.style.setProperty("--group-text-size",`${u}px`),t.style.setProperty("--group-title-size",`${Math.round(u*1.2)}px`),t.style.setProperty("--group-card-min",`${x}px`),n.scrollHeight<=n.clientHeight?(d=u,E=u+1):L=u-1}const v=Math.round(d*1.2),f=G.current;(f.textSize!==d||f.titleSize!==v||f.minCardWidth!==x||f.containerHeight!==m)&&(G.current={textSize:d,titleSize:v,minCardWidth:x,containerHeight:m},t.style.setProperty("--group-text-size",`${d}px`),t.style.setProperty("--group-title-size",`${v}px`),t.style.setProperty("--group-card-min",`${x}px`))},g=()=>{cancelAnimationFrame(r),r=requestAnimationFrame(a)};g();const y=new ResizeObserver(g);return y.observe(t),y.observe(n),()=>{cancelAnimationFrame(r),y.disconnect()}},[c,l]);const A=t=>{const s=t.target.files?.[0];if(s){const n=new FileReader;n.onload=r=>{const a=r.target?.result;C(a)},n.readAsText(s)}},I=()=>{const t=w.split(`
`).map(r=>r.trim()).filter(r=>r);if(t.length===0||p<=0){z([]);return}const s=[...t].sort(()=>Math.random()-.5),n=[];if(b==="byCount"){const r=Math.max(1,Math.min(p,t.length));for(let a=0;a<r;a++)n.push([]);s.forEach((a,g)=>{n[g%r].push(a)})}else{const r=Math.max(1,p);for(let a=0;a<s.length;a+=r)n.push(s.slice(a,a+r))}z(n)},F=()=>l.map((t,s)=>{const n=o("widgets.group_generator.group_title",{number:s+1}),r=t.map(a=>`- ${a}`);return[n,...r].join(`
`)}).join(`

`),B=async()=>{if(l.length===0)return;const t=F();try{if(navigator.clipboard?.writeText)await navigator.clipboard.writeText(t);else{const s=document.createElement("textarea");s.value=t,s.style.position="fixed",s.style.left="-9999px",document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s)}_(!0),window.setTimeout(()=>_(!1),1500)}catch{_(!1)}},O=()=>{if(l.length===0)return;const t=F(),s=new Blob([t],{type:"text/plain;charset=utf-8"}),n=URL.createObjectURL(s),r=document.createElement("a");r.href=n,r.download="grupos.txt",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)};return e.jsxs("div",{className:"group-generator-widget",children:[e.jsxs("div",{className:"input-panel",children:[e.jsx("label",{className:"panel-label",children:o("widgets.group_generator.student_list_label")}),e.jsx("textarea",{value:w,onChange:t=>C(t.target.value),placeholder:o("widgets.group_generator.placeholder")}),e.jsxs("button",{onClick:()=>M.current?.click(),className:"upload-button",children:[e.jsx(Y,{size:16})," ",o("widgets.group_generator.load_from_file")]}),e.jsx("input",{type:"file",ref:M,onChange:A,accept:".txt",className:"hidden"})]}),e.jsxs("div",{className:"controls-panel",children:[e.jsxs("div",{className:"mode-selection",children:[e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"mode",checked:b==="byCount",onChange:()=>N("byCount")}),o("widgets.group_generator.number_of_groups")]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"mode",checked:b==="bySize",onChange:()=>N("bySize")}),o("widgets.group_generator.students_per_group")]})]}),e.jsx("input",{type:"number",value:p,onChange:t=>U(Math.max(1,parseInt(t.target.value)||1)),className:"group-value-input",min:"1"}),e.jsx("button",{onClick:I,className:"generate-button",children:o("widgets.group_generator.generate_groups")})]}),e.jsxs("div",{className:"output-panel",children:[e.jsxs("div",{className:"output-header",children:[e.jsx("label",{className:"panel-label",children:o("widgets.group_generator.generated_groups_label")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"expand-button",onClick:B,disabled:l.length===0,title:o("widgets.group_generator.copy_groups"),children:e.jsx("span",{children:o(W?"widgets.group_generator.copied":"widgets.group_generator.copy_groups")})}),e.jsx("button",{className:"expand-button",onClick:O,disabled:l.length===0,title:o("widgets.group_generator.download_groups"),children:e.jsx("span",{children:o("widgets.group_generator.download_groups")})}),e.jsxs("button",{className:"expand-button",onClick:()=>j(!c),disabled:l.length===0,children:[c?e.jsx($,{size:16}):e.jsx(Z,{size:16}),e.jsx("span",{children:o(c?"widgets.group_generator.close_large_view":"widgets.group_generator.view_large")})]})]})]}),e.jsx("div",{className:"groups-container",children:l.length>0?l.map((t,s)=>e.jsxs("div",{className:"group-card",children:[e.jsx("h4",{className:"group-title",children:o("widgets.group_generator.group_title",{number:s+1})}),e.jsx("ul",{children:t.map(n=>e.jsx("li",{children:n},n))})]},s)):e.jsx("p",{className:"no-groups-message",children:o("widgets.group_generator.no_groups_message")})})]}),c&&e.jsx("div",{className:"groups-overlay",onClick:()=>j(!1),children:e.jsxs("div",{className:"groups-overlay-content",ref:S,onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"groups-overlay-header",ref:R,children:[e.jsx("h3",{children:o("widgets.group_generator.generated_groups_label")}),e.jsxs("button",{className:"expand-button",onClick:()=>j(!1),children:[e.jsx($,{size:16}),e.jsx("span",{children:o("widgets.group_generator.close_large_view")})]})]}),e.jsx("div",{className:"groups-container groups-container-large",ref:k,children:l.length>0?l.map((t,s)=>e.jsxs("div",{className:"group-card group-card-large",children:[e.jsx("h4",{className:"group-title",children:o("widgets.group_generator.group_title",{number:s+1})}),e.jsx("ul",{children:t.map(n=>e.jsx("li",{children:n},n))})]},s)):e.jsx("p",{className:"no-groups-message",children:o("widgets.group_generator.no_groups_message")})})]})})]})};export{se as GroupGeneratorWidget,oe as widgetConfig};
