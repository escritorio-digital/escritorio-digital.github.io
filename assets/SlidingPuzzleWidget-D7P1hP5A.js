import{c as k,u as N,r as u,j as s,ac as w,h as M}from"./index-BcFiV_N-.js";import{ay as R}from"./index-BcFiV_N-.js";import{r as P}from"./openDialog-H-OCpcqq.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],$=k("shuffle",C),S=(o,a)=>{let p=0;const e=o.filter(c=>c!==a*a-1);for(let c=0;c<e.length-1;c++)for(let d=c+1;d<e.length;d++)e[c]>e[d]&&p++;if(a%2===1)return p%2===0;{const c=a-Math.floor(o.indexOf(a*a-1)/a);return(p+c)%2!==0}},A=()=>{const{t:o}=N(),[a,p]=u.useState(null),[e,c]=u.useState(3),[d,f]=u.useState([]),[h,m]=u.useState(!1),g=()=>{const t=e*e,n=Array.from({length:t},(i,r)=>r);let l;do l=[...n].sort(()=>Math.random()-.5);while(!S(l,e)||l.every((i,r)=>i===r));f(l),m(!1)};u.useEffect(()=>{a&&g()},[a,e]),u.useEffect(()=>{if(d.length===0)return;const t=d.every((n,l)=>n===l);m(t)},[d]);const z=t=>{const n=new FileReader;n.onload=l=>{p(l.target?.result)},n.readAsDataURL(t)},b=async()=>{const t=await P({accept:"image/*"});if(!t)return;if(t.source==="local"){const[r]=t.files;r&&z(r);return}const[n]=t.entryIds;if(!n)return;const l=await M(n);if(!l?.blob)return;const i=new File([l.blob],l.name,{type:l.mime||l.blob.type});z(i)},_=t=>{if(h)return;const n=d.indexOf(e*e-1);if(((i,r)=>{const y=Math.floor(i/e),x=i%e,j=Math.floor(r/e),v=r%e;return y===j&&Math.abs(x-v)===1||x===v&&Math.abs(y-j)===1})(t,n)){const i=[...d];[i[t],i[n]]=[i[n],i[t]],f(i)}};return a?s.jsxs("div",{className:"sliding-puzzle-widget",children:[s.jsxs("div",{className:"puzzle-board",style:{gridTemplateColumns:`repeat(${e}, 1fr)`},children:[d.map((t,n)=>{const l=t===e*e-1,i=t%e,r=Math.floor(t/e);return s.jsx("div",{className:`puzzle-piece ${l?"empty":""}`,onClick:()=>_(n),children:!l&&s.jsx("div",{className:"piece-image",style:{backgroundImage:`url(${a})`,backgroundSize:`${e*100}% ${e*100}%`,backgroundPosition:`${i*100/(e-1)}% ${r*100/(e-1)}%`}})},n)}),h&&s.jsx("div",{className:"solved-overlay",children:o("widgets.sliding_puzzle.solved_overlay")})]}),s.jsxs("div",{className:"puzzle-controls",children:[s.jsxs("label",{children:[o("widgets.sliding_puzzle.complexity_label"),s.jsxs("select",{value:e,onChange:t=>c(Number(t.target.value)),children:[s.jsx("option",{value:3,children:o("widgets.sliding_puzzle.difficulty.easy")}),s.jsx("option",{value:4,children:o("widgets.sliding_puzzle.difficulty.normal")}),s.jsx("option",{value:5,children:o("widgets.sliding_puzzle.difficulty.hard")})]})]}),s.jsxs("button",{onClick:g,children:[s.jsx($,{size:16})," ",o("widgets.sliding_puzzle.shuffle_button")]})]})]}):s.jsx("div",{className:"sliding-puzzle-widget puzzle-empty",children:s.jsxs("div",{className:"puzzle-placeholder",children:[s.jsx("div",{className:"puzzle-placeholder-icon",children:s.jsx(w,{size:56})}),s.jsx("h3",{children:o("widgets.sliding_puzzle.upload_prompt")}),s.jsx("p",{children:o("widgets.sliding_puzzle.upload_rule")}),s.jsxs("button",{className:"puzzle-upload-button",onClick:b,children:[s.jsx(w,{size:18}),o("widgets.sliding_puzzle.upload_button")]})]})})};export{A as SlidingPuzzleWidget,R as widgetConfig};
