import{c as J,u as ve,r as o,j as t,W as me,aM as M,aN as ge}from"./index-C5_U1qcH.js";import{P as he}from"./papaparse.min-Bzv96o4j.js";import{C as K}from"./chevron-down-C-qZeyZU.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],pe=J("panel-left-close",fe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]],xe=J("panel-left-open",we),R=["Español","Català","Galego","Euskara","English","Português","Français","Deutsch","Italiano"],je="https://docs.google.com/spreadsheets/d/e/2PACX-1vSj_hltRI4Q0QolINWJVcKxCMMjfpdiCkKzSdgp9d8RlGTdUU1UIKvaj-TBSkq0JQGneDhfUkSQuFzy/pub?output=csv",be="https://vibe-coding-educativo.github.io/",H="active-profile-name",B="active-profile-change",Q="profiles-updated",Ne="Escritorio Principal",_e=new Set(["google.com","www.google.com","g.co","goo.gl","goo.gle","forms.gle","docs.google.com","drive.google.com","sites.google.com","gemini.google.com","app.goo.gl","ai.studio","www.ai.studio","aistudio.google.com","eaciweb.net","www.eaciweb.net","ja.cat","www.ja.cat","edumind.es","www.edumind.es","claude.ai","www.claude.ai","withgoogle.com","googleusercontent.com","googleapis.com"]),S=()=>{const s=window.localStorage.getItem(H);if(!s)return Ne;try{const l=JSON.parse(s);return typeof l=="string"&&l.trim()?l:s}catch{return s}},T=s=>{const l=window.localStorage.getItem("desktop-profiles");if(!l)return[];try{return JSON.parse(l)?.[s]?.vceFavorites??[]}catch{return[]}},Ce=()=>{const{t:s}=ve(),[l,O]=o.useState([]),[L,Y]=o.useState(""),[N,X]=o.useState(""),[_,Z]=o.useState(""),[v,ee]=o.useState(()=>new Set),[E,U]=o.useState(!1),[c,z]=o.useState(null),[te,W]=o.useState(new Set),[g,D]=o.useState(!0),[p,G]=o.useState(!1),[se,y]=o.useState(!1),[w,ie]=o.useState(!1),A=o.useRef(null),I=o.useRef(null),[h,q]=o.useState(()=>S()),[f,k]=o.useState(()=>T(S()));o.useEffect(()=>{let e=!0;return(async()=>{D(!0),G(!1);try{const i=await fetch(je,{cache:"no-store"});if(!i.ok)throw new Error("CSV fetch failed");const r=await i.text(),a=he.parse(r,{header:!0,skipEmptyLines:!0}),m="¿QUIERES ELIMINAR UN REGISTRO?\\nMarca la casilla y escribe más abajo la URL que tiene tu aplicación. En el resto de campos, escribe cualquier cosa y envía el formulario.\\nIMPORTANTE: Si solo quieres rectificar un registro, no marques esta casilla, haz lo que se  indica a continuación",j=d=>(d||"").replaceAll(";",",").split(",").map(b=>b.trim()).filter(Boolean),de=(a.data||[]).map(d=>{const b={title:(d["Título de la aplicación"]||"").trim(),author:(d["Tu nombre (Autor/a de la aplicación)"]||"").trim(),url:(d["Enlace (URL) a la aplicación"]||"").trim(),levels:j(d["Nivel o niveles educativos"]),areas:j(d["Área o áreas de conocimiento"]),languages:j(d["Idiomas de la aplicación"]),description:(d["Descripción breve"]||"").trim()},ue=(d[m]||"").trim();return{app:b,deleteFlag:ue}}).filter(({app:d,deleteFlag:b})=>d.title&&d.url&&!b).map(({app:d})=>d);e&&O(de)}catch{e&&G(!0)}finally{e&&D(!1)}})(),()=>{e=!1}},[]),o.useEffect(()=>{const e=r=>{const a=r.detail;q(a?.name||S())},n=r=>{r.key===H&&q(S())},i=()=>{k(T(h))};return window.addEventListener(B,e),window.addEventListener("storage",n),window.addEventListener(Q,i),()=>{window.removeEventListener(B,e),window.removeEventListener("storage",n),window.removeEventListener(Q,i)}},[h]),o.useEffect(()=>{k(T(h))},[h]);const ne=o.useMemo(()=>{const e=new Set;return l.forEach(n=>n.levels.forEach(i=>e.add(i))),Array.from(e).sort((n,i)=>n.localeCompare(i))},[l]),ae=o.useMemo(()=>{const e=new Set;return l.forEach(n=>n.areas.forEach(i=>e.add(i))),Array.from(e).sort((n,i)=>n.localeCompare(i))},[l]);o.useEffect(()=>{if(!E)return;const e=n=>{I.current&&(I.current.contains(n.target)||U(!1))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[E]);const x=o.useMemo(()=>{const e=L.trim().toLowerCase(),n=v.size===0||v.size===R.length;return[...l].reverse().filter(r=>N&&!r.levels.includes(N)||_&&!r.areas.includes(_)||!n&&!r.languages.some(m=>v.has(m))?!1:e?r.title.toLowerCase().includes(e)||r.author.toLowerCase().includes(e)||r.description.toLowerCase().includes(e):!0)},[l,L,N,_,v]),oe=e=>{try{const{hostname:n}=new URL(e),i=n.toLowerCase();return _e.has(i)||i.endsWith(".google.com")||i.endsWith(".googleusercontent.com")||i.endsWith(".googleapis.com")||i.endsWith(".withgoogle.com")||i.endsWith(".ai.studio")||i.endsWith(".eaciweb.net")||i.endsWith(".ja.cat")||i.endsWith(".edumind.es")||i.endsWith(".claude.ai")}catch{return!1}},u=o.useMemo(()=>new Set(f),[f]),P=o.useMemo(()=>{const e=new Map(x.map(n=>[n.url,n]));return f.map(n=>e.get(n)).filter(n=>!!n)},[x,f]),re=o.useMemo(()=>x.filter(e=>!u.has(e.url)),[x,u]);o.useEffect(()=>{c&&!l.some(e=>e.url===c.url)&&z(null)},[c,l]),o.useEffect(()=>{y(!1)},[c?.url]);const F=e=>{k(n=>{const i=n.includes(e)?n.filter(r=>r!==e):[...n,e];return window.dispatchEvent(new CustomEvent("vce-favorites-update",{detail:{profileName:h,favorites:i}})),i})},V=(e,n)=>{k(i=>{const r=i.indexOf(e);if(r===-1)return i;const a=n==="up"?r-1:r+1;if(a<0||a>=i.length)return i;const m=[...i],[j]=m.splice(r,1);return m.splice(a,0,j),window.dispatchEvent(new CustomEvent("vce-favorites-update",{detail:{profileName:h,favorites:m}})),m})},$=e=>{W(n=>{const i=new Set(n);return i.has(e)?i.delete(e):i.add(e),i})},C=e=>{z(e),W(new Set)},ce=()=>{if(y(!1),!!A.current)try{const e=A.current.contentWindow?.location.href;(!e||e==="about:blank")&&y(!0)}catch{}},le=e=>{ee(n=>{const i=new Set(n);return i.has(e)?i.delete(e):i.add(e),i})};return t.jsxs("div",{className:"vce-widget",children:[t.jsx(me,{children:t.jsxs("div",{className:"vce-toolbar",children:[t.jsxs("div",{className:"vce-header",children:[t.jsxs("div",{children:[t.jsx("div",{className:"vce-title",children:s("widgets.vce.title")}),t.jsx("div",{className:"vce-subtitle",children:s("widgets.vce.subtitle")})]}),t.jsxs("div",{className:"vce-actions",children:[t.jsx("button",{type:"button",className:"vce-toggle-list",onClick:()=>ie(e=>!e),title:s(w?"widgets.vce.expand_list":"widgets.vce.collapse_list"),"aria-label":s(w?"widgets.vce.expand_list":"widgets.vce.collapse_list"),children:w?t.jsx(xe,{size:16}):t.jsx(pe,{size:16})}),t.jsx("button",{type:"button",className:"vce-open",onClick:()=>window.open(be,"_blank","noopener,noreferrer"),children:s("widgets.vce.community_link")}),t.jsx("button",{type:"button",className:"vce-open",onClick:()=>{c&&window.open(c.url,"_blank","noopener,noreferrer")},disabled:!c,children:s("widgets.vce.open_new_tab")}),c&&t.jsx("button",{type:"button",className:"vce-fav-toggle",onClick:()=>F(c.url),title:u.has(c.url)?s("widgets.vce.remove_favorite"):s("widgets.vce.add_favorite"),"aria-label":u.has(c.url)?s("widgets.vce.remove_favorite"):s("widgets.vce.add_favorite"),children:t.jsx(M,{size:16,fill:u.has(c.url)?"currentColor":"none"})})]})]}),t.jsxs("div",{className:"vce-filters",children:[t.jsx("input",{type:"text",className:"vce-search",value:L,onChange:e=>Y(e.target.value),placeholder:s("widgets.vce.search_placeholder")}),t.jsxs("select",{className:"vce-select",value:N,onChange:e=>X(e.target.value),children:[t.jsx("option",{value:"",children:s("widgets.vce.filter_level_all")}),ne.map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsxs("select",{className:"vce-select",value:_,onChange:e=>Z(e.target.value),children:[t.jsx("option",{value:"",children:s("widgets.vce.filter_area_all")}),ae.map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsxs("div",{className:"vce-language-filter",ref:I,children:[t.jsxs("button",{type:"button",className:"vce-select vce-language-button",onClick:()=>U(e=>!e),"aria-haspopup":"listbox","aria-expanded":E,children:[v.size===0||v.size===R.length?s("widgets.vce.filter_languages_all"):`${s("widgets.vce.filter_languages")} (${v.size})`,t.jsx("span",{className:"vce-language-button-icon","aria-hidden":"true",children:t.jsx(K,{size:16})})]}),E&&t.jsx("div",{className:"vce-language-menu",role:"listbox","aria-multiselectable":"true",children:R.map(e=>t.jsxs("label",{className:"vce-language-option",children:[t.jsx("input",{type:"checkbox",checked:v.size>0&&v.has(e),onChange:()=>le(e)}),t.jsx("span",{children:e})]},e))})]})]})]})}),t.jsxs("div",{className:`vce-body${w?" is-collapsed":""}`,children:[t.jsxs("div",{className:`vce-list${w?" is-collapsed":""}`,children:[g&&t.jsx("div",{className:"vce-empty",children:s("widgets.vce.loading")}),p&&t.jsx("div",{className:"vce-empty",children:s("widgets.vce.load_error")}),!g&&!p&&x.length===0&&P.length===0&&t.jsx("div",{className:"vce-empty",children:s("widgets.vce.no_results")}),!g&&!p&&P.length>0&&t.jsx("div",{className:"vce-section",children:t.jsx("div",{className:"vce-section-title",children:s("widgets.vce.favorites_title")})}),!g&&!p&&P.map(e=>{const n=f.indexOf(e.url),i=n<=0,r=n===f.length-1;return t.jsx("div",{className:`vce-item vce-item-favorite${c?.url===e.url?" vce-item-active":""}`,onClick:()=>C(e),role:"button",tabIndex:0,onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),C(e))},children:t.jsxs("div",{className:"vce-item-header",children:[t.jsx("div",{className:"vce-item-title",children:e.title}),t.jsxs("div",{className:"vce-fav-actions",children:[t.jsx("button",{type:"button",className:"vce-fav-reorder",disabled:i,onClick:a=>{a.stopPropagation(),V(e.url,"up")},title:s("widgets.vce.move_up"),"aria-label":s("widgets.vce.move_up"),children:t.jsx(ge,{size:14})}),t.jsx("button",{type:"button",className:"vce-fav-reorder",disabled:r,onClick:a=>{a.stopPropagation(),V(e.url,"down")},title:s("widgets.vce.move_down"),"aria-label":s("widgets.vce.move_down"),children:t.jsx(K,{size:14})}),t.jsx("button",{type:"button",className:"vce-fav-toggle",onClick:a=>{a.stopPropagation(),F(e.url)},title:u.has(e.url)?s("widgets.vce.remove_favorite"):s("widgets.vce.add_favorite"),"aria-label":u.has(e.url)?s("widgets.vce.remove_favorite"):s("widgets.vce.add_favorite"),children:t.jsx(M,{size:16,fill:u.has(e.url)?"currentColor":"none"})})]})]})},e.url)}),!g&&!p&&re.map(e=>{const n=te.has(e.url),i=!!e.description,r=i&&e.description.length>100&&!n;return t.jsxs("div",{className:`vce-item${c?.url===e.url?" vce-item-active":""}`,onClick:()=>C(e),role:"button",tabIndex:0,onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),C(e))},children:[t.jsxs("div",{className:"vce-item-header",children:[t.jsx("div",{className:"vce-item-title",children:e.title}),t.jsx("button",{type:"button",className:"vce-fav-toggle",onClick:a=>{a.stopPropagation(),F(e.url)},title:u.has(e.url)?s("widgets.vce.remove_favorite"):s("widgets.vce.add_favorite"),"aria-label":u.has(e.url)?s("widgets.vce.remove_favorite"):s("widgets.vce.add_favorite"),children:t.jsx(M,{size:16,fill:"none"})})]}),t.jsx("div",{className:"vce-item-author",children:e.author}),t.jsxs("div",{className:"vce-item-desc",children:[!i&&s("widgets.vce.no_description"),i&&r&&t.jsxs(t.Fragment,{children:[`${e.description.slice(0,100)} `,t.jsx("button",{type:"button",className:"vce-item-more",onClick:a=>{a.stopPropagation(),$(e.url)},children:s("widgets.vce.more")})]}),i&&!r&&t.jsxs(t.Fragment,{children:[e.description," ",e.description.length>100&&t.jsx("button",{type:"button",className:"vce-item-more",onClick:a=>{a.stopPropagation(),$(e.url)},children:s("widgets.vce.less")})]})]})]},e.url)})]}),t.jsx("div",{className:"vce-preview",children:c?se||oe(c.url)?t.jsxs("div",{className:"vce-empty",children:[t.jsx("div",{children:s("widgets.vce.iframe_blocked")}),t.jsx("button",{type:"button",className:"vce-open vce-open-inline",onClick:()=>window.open(c.url,"_blank","noopener,noreferrer"),children:s("widgets.vce.open_new_tab")})]}):t.jsx("iframe",{ref:A,title:c.title,src:c.url,className:"vce-iframe",loading:"lazy",onLoad:ce,onError:()=>{y(!0)}},c.url):t.jsx("div",{className:"vce-empty",children:g?s("widgets.vce.loading"):t.jsxs("div",{className:"vce-intro",children:[t.jsx("div",{className:"vce-intro-title",children:s("widgets.vce.intro_title")}),t.jsxs("div",{className:"vce-intro-links",children:[t.jsx("a",{href:"https://t.me/vceduca",target:"_blank",rel:"noopener noreferrer",children:s("widgets.vce.intro_group_link")}),t.jsx("a",{href:"https://vibe-coding-educativo.github.io/",target:"_blank",rel:"noopener noreferrer",children:s("widgets.vce.intro_info_link")})]}),t.jsx("div",{className:"vce-intro-title",children:s("widgets.vce.intro_how_title")}),t.jsxs("ol",{className:"vce-intro-list",children:[t.jsx("li",{children:s("widgets.vce.intro_step1")}),t.jsx("li",{children:s("widgets.vce.intro_step2")}),t.jsx("li",{children:s("widgets.vce.intro_step3")}),t.jsx("li",{children:s("widgets.vce.intro_step4")}),t.jsx("li",{children:s("widgets.vce.intro_step5")})]})]})})})]})]})};export{Ce as VceCommunityWidget};
