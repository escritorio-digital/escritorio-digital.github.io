import{u as w,r as l,g as x,s as S,j as e,a as v}from"./index-CmQIKd-y.js";import{d as M}from"./index-CmQIKd-y.js";const j=t=>{const s=Math.max(0,Math.floor(t/1e3)),d=Math.floor(s/3600),m=Math.floor(s%3600/60),o=s%60;return d>0?`${String(d).padStart(2,"0")}:${String(m).padStart(2,"0")}:${String(o).padStart(2,"0")}`:`${String(m).padStart(2,"0")}:${String(o).padStart(2,"0")}`},b=()=>{const{t}=w(),[s,d]=l.useState(()=>x()),[m,o]=l.useState(Date.now());l.useEffect(()=>S(d),[]),l.useEffect(()=>{const a=window.setInterval(()=>o(Date.now()),1e3);return()=>window.clearInterval(a)},[]);const p=l.useMemo(()=>s.filter(a=>!a.triggered).sort((a,i)=>a.targetTime-i.targetTime),[s]),c=p.slice(0,4),y=c.length===1,u=Math.max(0,p.length-c.length),r=l.useMemo(()=>s.filter(a=>a.triggered),[s]),h=l.useMemo(()=>{if(r.length===0)return null;if(r.length===1){const a=r[0].label||t("widgets.alarm.default_label");return t("widgets.alarm_display.alert_single",{label:a})}return t("widgets.alarm_display.alert_multi",{count:r.length})},[r,t]),f=(a,i)=>{v(g=>g.map(n=>n.id===a?{...n,label:i}:n))};return e.jsxs("div",{className:"alarm-display-widget",children:[e.jsx("div",{className:"alarm-display-header",children:t("widgets.alarm_display.title")}),h&&e.jsxs("div",{className:"alarm-display-alert",children:[e.jsx("div",{className:"alarm-display-alert-title",children:t("widgets.alarm_display.alert_title")}),e.jsx("div",{className:"alarm-display-alert-message",children:h})]}),c.length===0?e.jsx("div",{className:"alarm-display-empty",children:t("widgets.alarm_display.none")}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`alarm-display-grid${y?" is-single":""}`,children:c.map(a=>{const i=a.label||t("widgets.alarm.default_label"),g=a.targetTime-m;return e.jsxs("div",{className:"alarm-display-card",children:[e.jsx("div",{className:"alarm-display-time",children:j(g)}),e.jsx("input",{className:"alarm-display-label-input",value:i,onChange:n=>f(a.id,n.target.value),placeholder:t("widgets.alarm.default_label")})]},a.id)})}),u>0&&e.jsx("div",{className:"alarm-display-more",children:t("widgets.alarm_display.more_count",{count:u})})]})]})};export{b as AlarmDisplayWidget,M as widgetConfig};
